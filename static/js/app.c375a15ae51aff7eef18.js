webpackJsonp([1],{"/FTq":function(e,t){},"/LVn":function(e,t){},"/iGr":function(e,t){},0:function(e,t){},"066F":function(e,t){},"0FKq":function(e,t){},"1/F+":function(e,t){},"1q2Z":function(e,t){},"2UST":function(e,t){},"4QX0":function(e,t){},"9Qjz":function(e,t){},AnAC:function(e,t){},GA9S:function(e,t){},"Gz/H":function(e,t){},IsVt:function(e,t){},J9Kn:function(e,t){},K6xb:function(e,t){},K7Nq:function(e,t){},LYJy:function(e,t){},LpXL:function(e,t){},"MOo/":function(e,t){},NGFP:function(e,t){},NHnr:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("7+uW"),r={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[this.isRouterAlive?t("router-view"):this._e()],1)},staticRenderFns:[]};var i=s("VU/8")({name:"App",provide:function(){return{reload:this.reload}},data:function(){return{isRouterAlive:!0}},methods:{reload:function(){var e=this;this.isRouterAlive=!1,this.$nextTick(function(){e.isRouterAlive=!0})}}},r,!1,function(e){s("jV+u")},null,null).exports,o=s("/ocq"),n=new a.default,l={name:"Home",data:function(){var e=this;return{logining:!1,loginTableVisible:!1,registerTableVisible:!1,ruleForm:{account:"",password:""},rules:{account:[{required:!0,message:"请输入账号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},registering:!1,ruleForm1:{email:"",name:"",gender:"男",auth:"学生",number:"",password:"",repassword:"",validCode:"",imgUrl:""},genderOptions:[{value:"男",label:"男"},{value:"女",label:"女"}],authOptions:[{value:"学生",label:"学生"},{value:"老师",label:"老师"}],rules1:{email:[{required:!0,validator:function(e,t,s){t.indexOf("@"),t.indexOf(".");return t?/^[a-zA-Z0-9_-]+@([a-zA-Z0-9]+\.)+(com|cn|net|org)$/.test(t)?s():s(new Error("邮箱格式错误")):s(new Error("请输入电子邮箱"))},trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"}],number:[{required:!0,message:"请输入学号",trigger:"blur"}],gender:[{required:!0,message:"请选择性别",trigger:"blur"}],auth:[{required:!0,message:"请选择身份",trigger:"blur"}],password:[{required:!0,validator:function(e,t,s){return t?/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z_]{6,16}$/.test(t)?s():s(new Error("包含字母和数字，且不小于6位")):s(new Error("请输入密码"))},trigger:"blur"}],repassword:[{required:!0,validator:function(t,s,a){return s?s!==e.ruleForm1.password?a(new Error("两次输入的密码不一致")):/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z_]{6,16}$/.test(s)?void a():a(new Error("包含大写字母和数字，且不小于6位")):a(new Error("请再次输入密码以确认"))},trigger:"blur"}],validCode:[{required:!1,message:"请输入验证码",trigger:"blur"}]},validity:{email:!1,name:!1,gender:!1,auth:!1,number:!1,password:!1,repassword:!1,imgUrl:!1}}},methods:{getUser:function(){return localStorage.getItem("username")},handleLogin:function(e){var t=this;this.$refs.ruleForm.validate(function(e){var s=t;e&&(s.logining=!0,s.$http.post("http://10.60.38.173:8765/auth",{username:t.ruleForm.account,password:t.ruleForm.password},{emulateJSON:!1}).then(function(e){localStorage.setItem("token",e.data.data.token.token),localStorage.setItem("username",e.data.data.mail),localStorage.setItem("userID",e.data.data.userID),localStorage.setItem("name",e.data.data.name),localStorage.setItem("workID",e.data.data.workID),s.logining=!1,s.$notify({title:"登录成功",message:"页面即将跳转",type:"success",duration:2e3}),t.loginTableVisible=!1,setTimeout(function(){location.reload()},2e3)},function(e){console.log("登录失败：",e),s.logining=!1,s.$notify.error({title:"登录失败",message:"用户名密码不匹配或网络错误",duration:2e3})}))})},handleRegister:function(e){var t=this;this.$refs.ruleForm1.validate(function(e){var s=t;e&&(s.registering=!0,s.$http.post("http://10.60.38.173:8765/register",{mail:t.ruleForm1.email,password:t.ruleForm1.password,name:t.ruleForm1.name,workID:t.ruleForm1.number,role:t.ruleForm1.auth,gender:t.ruleForm1.gender}).then(function(e){s.registering=!1,s.$notify({title:"注册成功",message:"进入登录页面",type:"success",duration:2e3}),t.showLogin()},function(e){console.log("注册失败：",e),s.registering=!1,s.$notify.error({title:"注册失败",message:"网络错误",duration:2e3})}))})},showRegister:function(){this.loginTableVisible=!1,this.registerTableVisible=!0},showLogin:function(){this.registerTableVisible=!1,this.loginTableVisible=!0},getData:function(e){this.loginTableVisible=e}},created:function(){var e=this;n.$on("loginVisible",function(t){return e.getData(t)})}},c={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"banner"},[s("div",[s("div",{staticClass:"banner-text"},[s("div",{staticClass:"callbacks_container",attrs:{id:"top"}},[s("div",{staticStyle:{display:"inline-block"}},[s("h6",[e._v("中国领先的在线教育平台")]),e._v(" "),s("h3",[e._v("课程教与学管理评价平台")]),e._v(" "),e.getUser()?s("div",[s("el-button",{on:{click:function(t){return e.$router.push("/student")}}},[e._v("学生主页")]),e._v(" "),s("el-button",{staticStyle:{"margin-left":"10px"},on:{click:function(t){return e.$router.push("/teacher")}}},[e._v("教师主页")]),e._v(" "),s("el-button",{staticStyle:{"margin-left":"10px"},on:{click:function(t){return e.$router.push("/adminManage")}}},[e._v("管理员主页")])],1):s("div",[s("el-button",{on:{click:function(t){e.loginTableVisible=!0}}},[e._v("JOIN US!")])],1)])])])])]),e._v(" "),s("el-dialog",{attrs:{visible:e.loginTableVisible,width:"500px",center:!0},on:{"update:visible":function(t){e.loginTableVisible=t}}},[s("div",{staticStyle:{padding:"10px 70px 10px 70px"}},[s("h2",[e._v("LOGIN")]),e._v(" "),s("el-form",{ref:"ruleForm",staticStyle:{"margin-top":"25px"},attrs:{model:e.ruleForm,rules:e.rules,"label-position":"left","label-width":"0px"}},[s("el-form-item",{attrs:{prop:"account"}},[s("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"账号"},model:{value:e.ruleForm.account,callback:function(t){e.$set(e.ruleForm,"account",t)},expression:"ruleForm.account"}})],1),e._v(" "),s("el-form-item",{attrs:{prop:"checkPass"}},[s("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"密码"},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1),e._v(" "),s("div",{staticStyle:{width:"100%"},attrs:{align:"center"}},[s("el-button",{staticClass:"form-button",attrs:{type:"primary",loading:e.logining},on:{click:e.handleLogin}},[e._v("登录")])],1),e._v(" "),s("div",{staticStyle:{width:"100%"},attrs:{align:"center"}},[s("el-button",{staticClass:"form-text-button",attrs:{type:"text"},on:{click:e.showRegister}},[e._v("注册账号")])],1)],1)],1)]),e._v(" "),s("el-dialog",{attrs:{visible:e.registerTableVisible,width:"900px",center:!0},on:{"update:visible":function(t){e.registerTableVisible=t}}},[s("div",{staticStyle:{padding:"10px 70px 10px 70px"}},[s("h2",[e._v("REGISTER")]),e._v(" "),s("el-form",{ref:"ruleForm1",staticStyle:{margin:"50px auto"},attrs:{model:e.ruleForm1,rules:e.rules1,"status-icon":"","label-position":"left","label-width":"80px"}},[s("el-row",{attrs:{gutter:30}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{prop:"email",label:"邮箱"}},[s("el-input",{attrs:{type:"text"},model:{value:e.ruleForm1.email,callback:function(t){e.$set(e.ruleForm1,"email",t)},expression:"ruleForm1.email"}},[s("el-button",{attrs:{slot:"append"},slot:"append"},[e._v("发送验证码")])],1)],1),e._v(" "),s("el-form-item",{attrs:{prop:"validCode",label:"验证码"}},[s("el-input",{attrs:{type:"text"},model:{value:e.ruleForm1.validCode,callback:function(t){e.$set(e.ruleForm1,"validCode",t)},expression:"ruleForm1.validCode"}})],1),e._v(" "),s("el-form-item",{attrs:{prop:"name",label:"姓名"}},[s("el-input",{attrs:{type:"text"},model:{value:e.ruleForm1.name,callback:function(t){e.$set(e.ruleForm1,"name",t)},expression:"ruleForm1.name"}})],1),e._v(" "),s("el-form-item",{attrs:{prop:"number",label:"学工号"}},[s("el-input",{attrs:{type:"text"},model:{value:e.ruleForm1.number,callback:function(t){e.$set(e.ruleForm1,"number",t)},expression:"ruleForm1.number"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{prop:"gender",label:"性别"}},[s("el-select",{staticStyle:{width:"100%"},model:{value:e.ruleForm1.gender,callback:function(t){e.$set(e.ruleForm1,"gender",t)},expression:"ruleForm1.gender"}},e._l(e.genderOptions,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-form-item",{attrs:{prop:"auth",label:"身份"}},[s("el-select",{staticStyle:{width:"100%"},model:{value:e.ruleForm1.auth,callback:function(t){e.$set(e.ruleForm1,"auth",t)},expression:"ruleForm1.auth"}},e._l(e.authOptions,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-form-item",{attrs:{prop:"password",label:"密码"}},[s("el-input",{attrs:{type:"password"},model:{value:e.ruleForm1.password,callback:function(t){e.$set(e.ruleForm1,"password",t)},expression:"ruleForm1.password"}})],1),e._v(" "),s("el-form-item",{attrs:{prop:"repassword",label:"确认密码"}},[s("el-input",{attrs:{type:"password"},model:{value:e.ruleForm1.repassword,callback:function(t){e.$set(e.ruleForm1,"repassword",t)},expression:"ruleForm1.repassword"}})],1)],1)],1),e._v(" "),s("div",{attrs:{align:"center"}},[s("el-button",{staticClass:"form-button",staticStyle:{width:"40%"},attrs:{type:"primary",loading:e.registering},on:{click:e.handleRegister}},[e._v("注册")])],1)],1)],1)])],1)},staticRenderFns:[]};var h=s("VU/8")(l,c,!1,function(e){s("nyz3")},"data-v-2617d63a",null).exports,u=s("mtWM"),d=s.n(u),p={data:function(){return{sysName:"教与学",sysUserName:"",isLogin:!1,loginVisible:!1,form:{name:"",region:"",date1:"",date2:"",delivery:!1,type:[],resource:"",desc:""}}},methods:{logout:function(){var e=this;this.$confirm("确认退出吗?","提示",{}).then(function(){localStorage.removeItem("username"),localStorage.removeItem("token"),localStorage.removeItem("userID"),localStorage.removeItem("name"),localStorage.removeItem("workID"),location.reload(),e.isLogin=!1}).catch(function(){}),this.isLogin=!1},showLogin:function(){this.loginVisible=!0,n.$emit("loginVisible",this.loginVisible)}},mounted:function(){var e=localStorage.getItem("username");e&&(this.isLogin=!0,this.sysUserName=e)}},m={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-row",{staticClass:"container",staticStyle:{"background-color":"#292929"}},[s("el-col",{staticClass:"header",attrs:{span:24}},[s("el-col",{staticClass:"logo logo-width",attrs:{span:10}},[s("div",[s("div",{staticStyle:{display:"inline-block"}},[s("i",{staticClass:"fa fa-leanpub",staticStyle:{"margin-right":"10px"},attrs:{"aria-hidden":"true"}}),s("span",{staticStyle:{"letter-spacing":"3px","font-weight":"bold"}},[e._v("教与学")])]),e._v(" "),s("div",{staticStyle:{color:"#fff",display:"inline-block"}},[s("div",{staticClass:"subhead",staticStyle:{top:"-6px"}},[e._v("专业在线教育平台")]),e._v(" "),s("div",{staticClass:"subhead",staticStyle:{top:"8px"}},[e._v("TEACH AND LEARN")])])])]),e._v(" "),s("el-col",{staticClass:"userinfo",attrs:{span:4}},[s("div",{directives:[{name:"show",rawName:"v-show",value:!e.isLogin,expression:"!isLogin"}]},[s("el-button",{staticStyle:{color:"#fff"},attrs:{type:"text"},on:{click:e.showLogin}},[e._v("LOGIN")])],1),e._v(" "),s("el-dropdown",{directives:[{name:"show",rawName:"v-show",value:e.isLogin,expression:"isLogin"}],attrs:{trigger:"hover"}},[s("span",{staticClass:"el-dropdown-link userinfo-inner"},[e._v(e._s(e.sysUserName))]),e._v(" "),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",[e._v("设置")]),e._v(" "),s("el-dropdown-item",{attrs:{divided:""},nativeOn:{click:function(t){return e.logout(t)}}},[e._v("退出登录")])],1)],1)],1)],1),e._v(" "),s("el-col",{staticClass:"main",attrs:{span:24}},[s("section",{staticClass:"content-container"},[s("div",{staticClass:"grid-content bg-purple-light"},[s("el-col",{staticClass:"content-wrapper",attrs:{span:24}},[s("transition",{attrs:{name:"fade",mode:"out-in"}},[s("router-view")],1)],1)],1)])])],1)},staticRenderFns:[]};var g=s("VU/8")(p,m,!1,function(e){s("O0U6")},"data-v-235a4109",null).exports,f={name:"sCourseManage",data:function(){return{noCourse:!0,code:"",isPlus:!1,isConfirm:!1,courseConfirm:{courseInfo:{courseID:-1,courseName:"",teacherName:""},courseClass:{id:-1,courseID:-1,classNum:-1,classCode:"",currentExerciseChapter:-1}},chapterNameList:[],items:[]}},created:function(){var e=this;this.$axios.get("http://10.60.38.173:8765/getStuCourseList",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{studentID:localStorage.getItem("userid")}}).then(function(t){1==t.data.state&&(0!=t.data.data.length&&(e.noCourse=!1,e.items=t.data.data));console.log(t,"resp"),console.log(t.data,"courselist"),console.log(e.items,"items")}).catch(function(e){console.log(e)})},methods:{toAnalysis:function(){this.$router.push({path:"/student/studentAnalysis"})},submit:function(){var e=this;this.$axios.get("http://10.60.38.173:8765/getCourseByCode",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{courseCode:this.code}}).then(function(t){console.log(t.data),e.courseConfirm=t.data.data}).catch(function(e){console.log(e)}),this.isConfirm=!0},confirm:function(){var e=this;this.isPlus=!1,this.isConfirm=!1,this.$axios.get("http://10.60.38.173:8765/joinCourse",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{studentID:1,courseClassID:this.courseConfirm.courseClass.id}}).then(function(t){e.items.push(e.courseConfirm),console.log(t),e.$message(t.message)}).catch(function(e){console.log(e)}),this.code=""},courseDetail:function(e,t){this.$router.push({path:"/student/courseDetail",query:{courseID:e,classID:t}})},homework:function(e){this.$router.push({path:"/student/chapterDetail",query:{chapterID:e}})}}},v={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticStyle:{height:"778px"}},[s("el-col",{attrs:{span:20,offset:2}},[s("el-row",{attrs:{gutter:40}},[s("el-col",{staticStyle:{"margin-top":"10px"},attrs:{span:2}},[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.isPlus=!0}}},[e._v("添加课程")])],1),e._v(" "),s("el-col",{staticStyle:{"margin-top":"10px"},attrs:{span:2}},[s("el-button",{attrs:{type:"success",size:"mini"},on:{click:e.toAnalysis}},[e._v("课程分析")])],1)],1),e._v(" "),s("el-row",{directives:[{name:"show",rawName:"v-show",value:e.noCourse,expression:"noCourse"}],staticStyle:{"font-size":"18px","letter-spacing":"5px"}},[s("el-row",{staticStyle:{padding:"30px"}},[e._v("还没有课？")]),e._v(" "),s("el-row",[e._v("\n        点击上方的\n        "),s("span",{staticStyle:{color:"darkcyan","font-weight":"bold"}},[e._v("添加课程")]),e._v("，输入专属\n        "),s("span",{staticStyle:{color:"darkcyan","font-weight":"bold"}},[e._v("邀请码")]),e._v("加入课程吧！\n      ")])],1),e._v(" "),s("el-row",{attrs:{gutter:40}},[s("el-col",{attrs:{span:22,offset:1}},e._l(e.items,function(t,a){return s("el-col",{key:a,attrs:{span:8}},[s("el-card",{staticStyle:{margin:"20px 0"},attrs:{"body-style":{padding:0}}},[s("el-row",{staticClass:"top"},[s("p",{attrs:{id:"name"},on:{click:function(s){return e.courseDetail(t.courseInfo.courseID,t.courseClass.id)}}},[e._v(e._s(t.courseInfo.courseName))]),e._v(" "),s("el-col",{staticStyle:{"margin-top":"10px"},attrs:{span:5,offset:18}},[s("span",{attrs:{id:"teacher"}},[e._v("老师："+e._s(t.courseInfo.teacherName))])])],1),e._v(" "),s("el-row",{staticStyle:{height:"90px"}},[s("el-row",[s("el-col",{staticStyle:{"text-align":"left"},attrs:{span:16,offset:1}},[s("p",{staticStyle:{"font-size":"13px",color:"#000"}},[e._v("近期作业")]),e._v(" "),s("p",{attrs:{id:"newest"},on:{click:function(s){return e.homework(t.courseClass.currentExerciseChapter)}}},[e._v("第 "+e._s(t.courseClass.currentExerciseChapter)+" 章课后习题")])])],1),e._v(" "),s("el-row",[s("el-row",{staticStyle:{"font-size":"12px","text-align":"right"}},[s("el-col",{attrs:{span:10,offset:13}},[e._v("邀请码："+e._s(t.courseClass.classCode))])],1)],1)],1)],1)],1)}),1)],1),e._v(" "),s("el-dialog",{attrs:{visible:e.isPlus,title:"添加课程",width:"30%",center:""},on:{"update:visible":function(t){e.isPlus=t}}},[s("el-form",[s("el-form-item",{attrs:{label:"邀请码","label-width":"70px"}},[s("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入邀请码"},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}})],1)],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"mini"},on:{click:function(t){e.isPlus=!1}}},[e._v("取消")]),e._v(" "),s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.submit}},[e._v("确认")])],1)],1),e._v(" "),s("el-dialog",{attrs:{visible:e.isConfirm,title:"课程信息确认",width:"30%",center:""},on:{"update:visible":function(t){e.isConfirm=t}}},[s("div",{staticStyle:{"text-align":"center"}},[s("p",[e._v("课程："+e._s(e.courseConfirm.courseInfo.courseName))]),e._v(" "),s("p",[e._v("教师："+e._s(e.courseConfirm.courseInfo.teacherName))]),e._v(" "),s("p",[e._v("邀请码："+e._s(e.courseConfirm.courseClass.classCode))])]),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"mini"},on:{click:function(t){e.isConfirm=!1}}},[e._v("返回")]),e._v(" "),s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.confirm}},[e._v("确认")])],1)])],1)],1)},staticRenderFns:[]};var x=s("VU/8")(f,v,!1,function(e){s("K7Nq")},"data-v-b7e1de60",null).exports,b=s("BO1k"),y=s.n(b),w=s("woOf"),I=s.n(w),_=s("ifoU"),C=s.n(_),D=s("NYxO");a.default.use(D.a);var S=new D.a.Store({state:{data:[{name:"start",x:250,y:50}],links:[],catalog:[],score:[]},mutations:{setCatalog:function(e,t){e.catalog=t},setScore:function(e,t){e.score=t,console.log("TCL: setScore -> score",t)}}}),N=0,k={name:"sCourseDetail",data:function(){return{courseID:1,classID:1,isNotice:!1,isLesson:!0,isGraph:!0,notice:"Java是一门面向对象编程语言.",rate:20,lesson:null,showButton:!0,dataIndex:0,graphTree:[],data:[{name:"start",x:200,y:0}],links:[],tree:[],defaultProps:{children:"subCatalog",label:"contentName"}}},created:function(){console.log(this.courseID,"courseid");var e=this.$route.query.courseID;this.courseID=e;var t=this.$route.query.classID;this.classID=t,console.log(this.courseID,"courseid"),N=0,this.getChapterGraph(),this.getNotice(),this.getLesson(),this.getScore()},mounted:function(){},methods:{getScore:function(){this.$axios.get("http://10.60.38.173:8765/getCourseScoreAndComment",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{courseID:this.courseID,studentID:localStorage.getItem("userid")}}).then(function(e){console.log(e.data),1==e.data.state&&(console.log(e.data,"score"),S.commit("setScore",e.data.data))}).catch(function(e){console.log(e)})},getNotice:function(){var e=this;this.$axios.get("http://10.60.38.173:8765/getNoticeByCouID",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{courseID:this.courseID}}).then(function(t){console.log(t.data,"notice data"),1==t.data.state&&(e.notice=t.data.data.courseNotice)}).catch(function(e){console.log(e)})},getLesson:function(){var e=this;this.$axios.get("http://10.60.38.173:8765/getCourseCatalog",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{courseID:this.courseID}}).then(function(t){1==t.data.state&&(e.tree=t.data.data,S.commit("setCatalog",e.tree))}).catch(function(e){console.log(e)})},showNotice:function(){0==this.isNotice&&(this.isNotice=!0,this.isLesson=!1)},showLesson:function(){0==this.isLesson&&(this.isNotice=!1,this.isLesson=!0)},changeLesson:function(){1==this.isGraph?this.isGraph=!1:this.isGraph=!0},handleNodeClick:function(e){console.log(e,"node-object"),0!=e.parentID&&this.$router.push({path:"chapterDetail/point",query:{chapterID:e.id,courseIDs:this.courseID}})},renderContent:function(e,t){var s=this,a=t.node,r=t.data;t.store;if(0==r.parentID){var i=N+=1;return e("span",{style:"flex: 1; display: flex; align-items: center; justify-content: space-between; font-size: 14px; padding-right: 8px;"},[e("span",[e("span",[a.label])]),e("span",[e("el-button",{style:"font-size: 12px;color:#000;",attrs:{size:"mini",round:!0},on:{click:function(){return s.pre(r,i)}}},["课前摸底"]),e("el-button",{style:"font-size: 12px;",attrs:{size:"mini",type:"info",round:!0},on:{click:function(){return s.rev(r,i)}}},["课后作业"])])])}return e("span",{style:"flex: 1; display: flex; align-items: center; justify-content: space-between; font-size: 14px; padding-right: 8px;"},[e("span",[e("span",[a.label])])])},pre:function(e,t){this.$router.push({path:"chapterDetail/preExercise",query:{spreid:e.id,courseIDs:this.courseID,index:t-1}})},rev:function(e,t){this.$router.push({path:"chapterDetail/revExercise",query:{srevid:e.id,courseIDs:this.courseID,index:t-1}})},courseBack:function(){this.$router.push({path:"/student/courseManagement",query:{courseClassID:this.classID}})},feedback:function(){this.$router.push({path:"/student/feedback",query:{courseClassID:this.classID}})},getChapterGraph:function(){var e=this;console.log(this.courseID,"getgraph-courseid"),this.$axios.get("http://10.60.38.173:8765/getChapterRelationByCourseID",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{courseID:this.courseID}}).then(function(t){console.log(t.data),1==t.data.state&&(console.log(t.data,"chapter-tree"),e.graphTree=t.data.data,e.init())}).catch(function(e){console.log(e)})},init:function(){var e=this.graphTree.map(function(e){return[e.chapterNode.contentName,{level:0,subChapter:e.subChapterNodes.map(function(e){return e.contentName})}]});console.log("TCL: init -> nodes",this.graphTree,e);for(var t=function(t){var s=e[t][1];s.subChapter.length&&s.subChapter.forEach(function(t){var a=e.findIndex(function(e){return e[0]===t});e[a]=[e[a][0],I()({},e[a][1],{level:e[a][1].level>s.level?e[a][1].level:s.level+1})]})},s=0;s<e.length;s++)t(s);var a=new C.a;e.forEach(function(e){a.set(e[1].level,[])}),e.forEach(function(e){a.set(e[1].level,a.get(e[1].level).concat([e[0]]))});var r=[],i=0,o=function(e){m=e[1].length,i=1900/m,e[1].forEach(function(t,s){var a={name:t,x:Math.round(i+3800/m*s),y:350*(parseInt(e[0])+1)};r.push(a)})},n=!0,l=!1,c=void 0;try{for(var h,u=y()(a.entries());!(n=(h=u.next()).done);n=!0){o(h.value)}}catch(e){l=!0,c=e}finally{try{!n&&u.return&&u.return()}finally{if(l)throw c}}r.push({name:"start",x:1900,y:0}),this.data=r,console.log("TCL: set -> data",r);for(var d=this.graphTree.length,p=0;p<d;p++){var m=this.graphTree[p].preChapterNodes.length,g=this.graphTree[p].chapterNode.contentName;if(0==m){var f={target:g,source:"start",label:{normal:{show:!1}}};this.links.push(f)}else for(var v=0;v<m;v++){f={target:g,source:this.graphTree[p].preChapterNodes[v].contentName,label:{normal:{show:!1}}};this.links.push(f)}}this.draw()},draw:function(){var e=this.$refs.graph,t=this.$echarts.init(e),s={tooltip:{},animationDurationUpdate:1500,animationEasingUpdate:"quinticInOut",toolbox:{feature:{saveAsImage:{show:!0}}},series:[{type:"graph",layout:"none",top:30,symbolSize:25,roam:!0,itemStyle:{normal:{color:"#ec7814",label:{show:!0,fontSize:12,formatter:function(e){return-1!=e.name.indexOf("、")?e.name.split("、").join("\n"):e.name.split(" ").join("\n")}}}},edgeSymbol:["circle","arrow"],edgeSymbolSize:[4,10],edgeLabel:{normal:{textStyle:{fontSize:10,fontColor:"#000"}}},data:this.data,links:this.links,lineStyle:{normal:{opacity:.9,width:1,curveness:0}}}]};t.setOption(s);var a=this,r=0;t.on("click",function(e){if(r++,"edge"==e.dataType){a.dataIndex=e.dataIndex;var i=a.links[a.dataIndex].label.normal.show;a.links[a.dataIndex].label.normal.show=0==i,t.setOption(s)}else"node"==e.dataType&&(r%2==1?a.myChart.dispatchAction({type:"focusNodeAdjacency",dataIndex:e.dataIndex}):r%2==0&&a.myChart.dispatchAction({type:"unfocusNodeAdjacency",seriesIndex:e.seriesIndex}))}),document.oncontextmenu=function(){return!1},a.myChart=t}}},O={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-row",{staticClass:"courseBack"},[s("el-row",{staticStyle:{"line-height":"50px"}},[s("el-col",{attrs:{span:2}},[s("i",{staticClass:"el-icon-back",on:{click:e.courseBack}})])],1),e._v(" "),s("el-row",[s("div",{staticStyle:{"line-height":"150px"}},[e._v("JAVA")])]),e._v(" "),s("el-row",[s("el-col",{attrs:{span:2,offset:22}},[s("el-button",{staticStyle:{color:"#fff"},attrs:{type:"text"},on:{click:e.feedback}},[e._v("教学反馈")])],1)],1)],1),e._v(" "),s("el-row",[s("div",{staticClass:"tabs"},[s("el-col",{attrs:{span:4,offset:8}},[s("div",{staticClass:"tabBack",class:{clickDiv:e.isNotice},on:{click:e.showNotice}},[s("el-button",{staticClass:"tab",class:{clickButton:e.isNotice},attrs:{type:"text"}},[e._v("公告")])],1)]),e._v(" "),s("el-col",{attrs:{span:4}},[s("div",{staticClass:"tabBack",class:{clickDiv:e.isLesson},on:{click:e.showLesson}},[s("el-button",{staticClass:"tab",class:{clickButton:e.isLesson},attrs:{type:"text"}},[e._v("课程及练习")])],1)])],1)]),e._v(" "),s("el-row",[s("div",[s("div",{directives:[{name:"show",rawName:"v-show",value:e.isNotice,expression:"isNotice"}],staticStyle:{padding:"150px 0",height:"100px"}},[s("el-col",{attrs:{span:10,offset:7}},[s("div",{staticClass:"notice"},[e._v(e._s(e.notice))])])],1),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isLesson,expression:"isLesson"}]},[s("el-col",{staticStyle:{"margin-bottom":"40px","margin-top":"80px"},attrs:{span:12,offset:6}},[s("div",{staticStyle:{"padding-bottom":"20px"}},[s("el-col",{attrs:{span:3}},[s("el-button",{attrs:{type:"success",size:"small"},on:{click:e.changeLesson}},[1==e.isGraph?s("span",[e._v("查看章节目录")]):s("span",[e._v("查看关系图")])])],1)],1),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:1==e.isGraph,expression:"isGraph==true"}]},[s("div",{ref:"graph",staticStyle:{height:"800px",border:"1px solid #ddd","margin-bottom":"20px","margin-top":"40px"}})]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:0==e.isGraph,expression:"isGraph==false"}],staticStyle:{"margin-top":"40px"}},[s("el-tree",{attrs:{data:e.tree,props:e.defaultProps,"default-expand-all":"","expand-on-click-node":!1,"render-content":e.renderContent},on:{"node-click":e.handleNodeClick}})],1)])],1)])])],1)},staticRenderFns:[]};var $=s("VU/8")(k,O,!1,function(e){s("XU3J"),s("nfQf")},"data-v-081fecc3",null).exports,A={name:"sChapterDetail",data:function(){return{catalog:[],chapterData:[],courseID:0,updateChapterVisible:!1,tree:[],typeOptions:[],menuLoading:!1}},methods:{goBack:function(){this.$router.push({path:"/student/courseDetail",query:{courseID:this.courseID}})},handleChapterClose:function(){for(var e=0;e<this.chapterData.length;e++)this.chapterData[e].disabled=!1},getCatalog:function(){var e=this;this.menuLoading=!0;var t=this.$route.query.courseIDs;this.courseID=t,this.$axios.get("http://10.60.38.173:8765/getCourseCatalog",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{courseID:this.courseID}}).then(function(t){e.tree=t.data.data,e.menuLoading=!1,console.log(t.data,"resp.data"),console.log(e.courseID,"courseID")}).catch(function(e){console.log(e)})},pre:function(e,t){t>S.state.score.length?this.$router.push({path:"preExercise",query:{spreid:e,courseIDs:this.courseID,index:t}}):this.$router.push({path:"scoredPre",query:{spreid:e,courseIDs:this.courseID,index:t}})},rev:function(e,t){t>S.state.score.length?this.$router.push({path:"revExercise",query:{srevid:e,courseIDs:this.courseID,index:t}}):this.$router.push({path:"scoredRev",query:{srevid:e,courseIDs:this.courseID,index:t}})}},watch:{$route:function(e,t){console.log("有变化了")}},created:function(){this.getCatalog()}},z={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-container",[s("el-aside",{staticStyle:{width:"340px"}},[s("el-menu",{directives:[{name:"loading",rawName:"v-loading",value:e.menuLoading,expression:"menuLoading"}],staticStyle:{height:"778px"},attrs:{"default-active":"0-0","unique-opened":"","background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[s("el-menu-item",[s("span",[s("el-button",{attrs:{type:"text"},on:{click:e.goBack}},[s("i",{staticClass:"el-icon-back",staticStyle:{"margin-right":"6px",color:"#fff"}}),s("span",{staticStyle:{color:"#fff"}},[e._v("返 回")])])],1)]),e._v(" "),e._l(e.tree,function(t,a){return s("el-submenu",{key:a,attrs:{index:a.toString()}},[s("template",{slot:"title"},[s("span",{staticStyle:{color:"#ddd"}},[e._v(e._s(t.contentName))])]),e._v(" "),s("div",[e._l(t.subCatalog,function(t,r){return s("div",{key:10*a+r},[s("el-row",{staticClass:"vertical-middle"},[s("el-col",[s("router-link",{staticClass:"router-link-active",attrs:{to:{name:"point",query:{chapterID:t.id,name:t.contentName}}}},[s("el-menu-item",{attrs:{index:a.toString()+r}},[s("span",[e._v(e._s(t.contentName))])])],1)],1)],1)],1)}),e._v(" "),s("el-menu-item",{attrs:{index:a.toString()+"pre"},on:{click:function(s){return e.pre(t.id,a)}}},[e._v("课前摸底")]),e._v(" "),s("el-menu-item",{attrs:{index:a.toString()+"rev"},on:{click:function(s){return e.rev(t.id,a)}}},[e._v("课后作业")])],2)],2)})],2)],1),e._v(" "),s("el-main",[s("router-view",{staticClass:"router-view"})],1)],1)},staticRenderFns:[]};var T=s("VU/8")(A,z,!1,function(e){s("1/F+")},"data-v-5d38a95c",null).exports,F={name:"tChapterDetail",data:function(){return{catalog:[],chapterData:[],courseID:0,updateChapterVisible:!1,tree:[],typeOptions:[],menuLoading:!1}},methods:{goBack:function(){this.$router.push({path:"/teacher/courseDetail",query:{courseID:this.courseID}})},handleChapterClose:function(){for(var e=0;e<this.chapterData.length;e++)this.chapterData[e].disabled=!1},getCatalog:function(){var e=this;this.menuLoading=!0;var t=this.$route.query.courseIDt;this.courseID=t,this.$axios.get("http://10.60.38.173:8765/getCourseCatalog",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{courseID:this.courseID}}).then(function(t){e.tree=t.data.data,e.menuLoading=!1,console.log(t.data,"resp.data"),console.log(e.courseID,"courseID")}).catch(function(e){console.log(e)})}},watch:{$route:function(e,t){console.log("有变化了")}},created:function(){this.getCatalog()}},L={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-container",[s("el-aside",{staticStyle:{width:"340px"}},[s("el-menu",{directives:[{name:"loading",rawName:"v-loading",value:e.menuLoading,expression:"menuLoading"}],staticStyle:{height:"720px"},attrs:{"default-active":"0-0","unique-opened":"","background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[s("el-menu-item",[s("span",[s("el-button",{attrs:{type:"text"},on:{click:e.goBack}},[s("i",{staticClass:"el-icon-back",staticStyle:{color:"#fff"},attrs:{"aria-setsize":"100px"}}),s("span",{staticStyle:{color:"#fff"}},[e._v("返 回")])])],1)]),e._v(" "),e._l(e.tree,function(t,a){return s("el-submenu",{key:a,attrs:{index:a.toString()}},[s("template",{slot:"title"},[s("span",{staticStyle:{color:"#ddd"}},[e._v(e._s("第 "+(a+1)+" 章"))]),s("span",[e._v("  "+e._s(t.contentName))])]),e._v(" "),s("div",[e._l(t.subCatalog,function(t,r){return s("div",{key:10*a+r},[s("el-row",{staticClass:"vertical-middle"},[s("el-col",[s("router-link",{staticClass:"router-link-active",attrs:{to:{name:"tpoint",query:{chapterIDt:t.id,name:t.contentName}}}},[s("el-menu-item",{attrs:{index:a.toString()+r}},[s("span",{staticStyle:{color:"#ddd"}},[e._v(e._s(a+1+"."+(r+1)))]),e._v(" "),s("span",[e._v(e._s(t.contentName))])])],1)],1)],1)],1)}),e._v(" "),s("router-link",{staticClass:"router-link-active",attrs:{to:{name:"tpreExercise",query:{tpreid:t.id}}}},[s("el-menu-item",{attrs:{index:a.toString()+"pre"}},[e._v("课前摸底")])],1),e._v(" "),s("router-link",{staticClass:"router-link-active",attrs:{to:{name:"trevExercise",query:{trevid:t.id,index:a}}}},[s("el-menu-item",{attrs:{index:a.toString()+"rev"}},[e._v("课后作业")])],1)],2)],2)})],2)],1),e._v(" "),s("el-main",[s("router-view",{staticClass:"router-view"})],1)],1)},staticRenderFns:[]};var j=s("VU/8")(F,L,!1,function(e){s("hvyg")},"data-v-c9100ac2",null).exports,B=s("pFYg"),E=s.n(B),P={name:"studentAnalysis",data:function(){return{studentID:localStorage.getItem("workID"),studentName:localStorage.getItem("name"),userID:2,courseIndex:0,courseID:0,classID:0,currentName:"暂无学习记录",activeNames:["1"],xyOptions:[{value:0,label:"学习成绩",xName:"章节",yName:"成绩"},{value:1,label:"成绩分布",xName:"分数段",yName:"人数"}],cOptions:[{value:0,label:"学生",disabled:!1,limit:4},{value:1,label:"性别",disabled:!1,limit:1},{value:2,label:"班级平均分",disabled:!1,limit:4}],gradeOptions:[{value:0,label:"平均成绩"},{value:1,label:"课前成绩"},{value:2,label:"课后成绩"},{value:3,label:"课前-课后成绩",disabled:!1}],gradeAttribute:0,xy:0,comparison:0,xData:[],courseOptions:[],chapterSettings:0,chapterOptions:[],studentInfo:[],gradeClass:[83,84,85],gradeEnumList:[60,70,80,90],amountList:[[8,17,29,18],[7,19,22,24],[12,16,31,13]],colors:["#0997F7","#92DD22","#FFFF33","#FFAAEE"],seriesData:[],colorOptions:[],legendData:[],drawCount:0,drawLoading:!1}},methods:{goBack:function(){if(window.history.length<=1)return this.$router.push({path:"/"}),!1;this.$router.go(-1)},getProcess:function(){var e=this;this.$http.get("http://10.60.38.173:8765/getCurrentProgress?courseClassID="+this.classID+"&studentID="+this.userID,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200===t.status){var s=JSON.parse(t.bodyText);1===s.state&&(e.currentName=s.data.contentName)}else e.$message({type:"error",message:"加载失败!"})},function(t){e.$message({type:"error",message:"加载失败!"})})},getChapterOptions:function(){var e=this;this.chapterOptions=[],this.$http.get("http://10.60.38.173:8765/getCourseCatalog?courseID="+this.courseID,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200===t.status){for(var s=JSON.parse(t.bodyText),a=0;a<s.data.length;)e.chapterOptions.push({value:a,label:s.data[a].contentName,id:s.data[a].id}),a++;e.getStudentInfo(e.userID)}else e.$message({type:"error",message:"加载失败!"})},function(t){e.$message({type:"error",message:"加载失败!"})})},getCourses:function(){var e=this;this.$http.get("http://10.60.38.173:8765/getStuCourseList?studentID="+this.userID,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200===t.status){var s=JSON.parse(t.bodyText);if(1===s.state){var a=0;for(e.courseID=s.data[a].courseInfo.courseID,e.classID=s.data[a].courseClass.id;a<s.data.length;)e.courseOptions.push({value:a,label:s.data[a].courseInfo.courseName,courseID:s.data[a].courseInfo.courseID,classID:s.data[a].courseClass.id}),a++;e.getChapterOptions(),e.getProcess()}}else e.$message({type:"error",message:"加载失败!"})},function(t){e.$message({type:"error",message:"加载失败!"})})},getStudentInfo:function(e){var t=this;this.studentInfo=[],this.xData=[],this.$http.get("http://10.60.38.173:8765/getCourseScoreAndComment?courseID="+this.courseID+"&studentID="+e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200===e.status){for(var s=JSON.parse(e.bodyText),a=0;a<s.data.length;){var r=(Number(s.data[a].studentChapter.totalScore_1)+Number(s.data[a].studentChapter.totalScore_2))/2;t.studentInfo.push({id:s.data[a].studentChapter.id,scorePre:s.data[a].studentChapter.totalScore_1,scoreRev:s.data[a].studentChapter.totalScore_2,scoreAvg:r,comments:s.data[a].studentChapter.comment,rate:Number(s.data[a].studentChapter.rate),chapter:s.data[a].chapterName,chapterID:s.data[a].studentChapter.chapterID}),t.xData.push(s.data[a].chapterName),a++}t.getStudentData(t.userID,0)}else t.$message({type:"error",message:"加载失败!"})},function(e){t.$message({type:"error",message:"加载失败!"})})},getStudentData:function(e,t){var s=this;this.$http.get("http://10.60.38.173:8765/getCourseScoreAndComment?courseID="+this.courseID+"&studentID="+e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200===e.status){for(var a=JSON.parse(e.bodyText),r=0;r<a.data.length;){var i=(Number(a.data[r].studentChapter.totalScore_1)+Number(a.data[r].studentChapter.totalScore_2))/2;if(0===s.xy&&3!==s.gradeAttribute)switch(s.gradeAttribute){case 0:s.seriesData[t].data.push(i);break;case 1:s.seriesData[t].data.push(a.data[r].studentChapter.totalScore_1);break;case 2:s.seriesData[t].data.push(a.data[r].studentChapter.totalScore_2)}0===s.xy&&3===s.gradeAttribute&&(s.seriesData[0].data.push(a.data[r].studentChapter.totalScore_1),s.seriesData[1].data.push(a.data[r].studentChapter.totalScore_2)),r++}s.drawChart()}else s.drawLoading=!1,s.$message({type:"error",message:"加载失败!"})},function(e){s.drawLoading=!1,s.$message({type:"error",message:"加载失败!"})})},handleComparison:function(){switch(this.xy){case 0:this.comparison=0,this.xData=new Array,this.gradeAttribute=0,this.cOptions[0].disabled=!1,this.gradeOptions[3].disabled=!1,this.getCharts();break;case 1:this.comparison=1,this.xData=new Array,this.gradeAttribute=0,this.gradeOptions[3].disabled=!0,this.cOptions[0].disabled=!0,this.chapterSettings=0,this.getCharts()}},getGenderAndClassData:function(e,t){var s=this;this.$http.get("http://10.60.38.173:8765/getCourseScoreAndCommentByGender?courseID="+this.courseID+"&chapterID="+e+"&getDetail=0&courseClassID="+this.classID,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200===e.status){var a=JSON.parse(e.bodyText);if(1===s.comparison)switch(s.gradeAttribute){case 0:var r=Number(a.data[0].scoreInfo.boyAverage1)+Number(a.data[0].scoreInfo.boyAverage2)/2,i=Number(a.data[0].scoreInfo.girlAverage1)+Number(a.data[0].scoreInfo.girlAverage2)/2;s.seriesData[0].data[t]=r.toFixed(2),s.seriesData[1].data[t]=i.toFixed(2);break;case 1:s.seriesData[0].data[t]=a.data[0].scoreInfo.boyAverage1.toFixed(2),s.seriesData[1].data[t]=a.data[0].scoreInfo.girlAverage1.toFixed(2);break;case 2:s.seriesData[0].data[t]=a.data[0].scoreInfo.boyAverage2.toFixed(2),s.seriesData[1].data[t]=a.data[0].scoreInfo.girlAverage2.toFixed(2)}if(2===s.comparison)switch(s.gradeAttribute){case 0:var o=Number(a.data[0].scoreInfo.totalAverage1+a.data[0].scoreInfo.totalAverage2)/2;s.seriesData[1].data[t]=o.toFixed(2);break;case 1:var n=a.data[0].scoreInfo.totalAverage1;s.seriesData[1].data[t]=n.toFixed(2);break;case 2:var l=a.data[0].scoreInfo.totalAverage2;s.seriesData[1].data[t]=l.toFixed(2)}s.drawChart()}else s.drawLoading=!1,s.$message({type:"error",message:"加载失败!"})},function(e){s.drawLoading=!1,s.$message({type:"error",message:"加载失败!"})})},getScoreDistributeData:function(e){var t=this;this.$http.get("http://10.60.38.173:8765/getCourseScoreAndCommentByGender?courseID="+this.courseID+"&chapterID="+e+"&getDetail=0&courseClassID="+this.classID,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200===e.status){var s=JSON.parse(e.bodyText);if(1===t.comparison)switch(t.gradeAttribute){case 0:t.seriesData[0].data=s.data[0].scoreInfo.boyScoreAvgDistribute,t.seriesData[1].data=s.data[0].scoreInfo.girlScoreAvgDistribute;break;case 1:t.seriesData[1].data=s.data[0].scoreInfo.girlScoreDistribute1,t.seriesData[0].data=s.data[0].scoreInfo.boyScoreDistribute1;break;case 2:t.seriesData[1].data=s.data[0].scoreInfo.girlScoreDistribute2,t.seriesData[0].data=s.data[0].scoreInfo.boyScoreDistribute2}if(2===t.comparison)switch(t.gradeAttribute){case 0:t.seriesData[0].data=s.data[0].scoreInfo.totalScoreAvgDistribute;break;case 1:t.seriesData[0].data=s.data[0].scoreInfo.totalScoreDistribute1;break;case 2:t.seriesData[0].data=s.data[0].scoreInfo.totalScoreDistribute2;break;case 3:t.seriesData.push({}),t.seriesData[0].name="班级课后",t.seriesData[1]={name:"班级课前",type:"bar",barGap:0,data:new Array},t.colorOptions.push(t.colors[1]),t.legendData[0]="班级课前",t.legendData.push("班级课后"),t.seriesData[0].data=s.data[0].scoreInfo.totalScoreDistribute1,t.seriesData[1].data=s.data[0].scoreInfo.totalScoreDistribute2}t.drawChart()}else t.drawLoading=!1,t.$message({type:"error",message:"加载失败!"})},function(e){t.drawLoading=!1,t.$message({type:"error",message:"加载失败!"})})},handleGradeAttribute:function(){0!==this.comparison&&1!==this.xy?this.gradeOptions[3].disabled=!0:this.gradeOptions[3].disabled=!1},handleCourse:function(e){this.xy=0,this.gradeAttribute=0,this.comparison=0,this.classID=this.courseOptions[e].classID,this.courseID=this.courseOptions[e].courseID,this.getChapterOptions(),this.getProcess(),this.seriesData=[{name:this.studentName,type:"bar",barGap:0,data:new Array}],this.colorOptions=[this.colors[0]],this.legendData=[this.studentName]},getCharts:function(){switch(this.xData=[],this.seriesData=new Array,this.colorOptions=new Array,this.legendData=new Array,this.drawCount=0,this.drawLoading=!0,this.xy){case 0:for(var e=0;e<this.studentInfo.length;e++)this.xData.push(this.studentInfo[e].chapter);switch(this.comparison){case 0:3!==this.gradeAttribute?(this.seriesData.push({name:this.studentName,type:"bar",barGap:0,data:new Array}),this.colorOptions.push(this.colors[0]),this.legendData.push(this.studentName.toString()),this.getStudentData(this.userID,0)):(this.seriesData=new Array(2),this.seriesData[0]={name:"课前成绩",type:"bar",barGap:0,data:[]},this.seriesData[1]={name:"课后成绩",type:"bar",barGap:0,data:[]},this.colorOptions.push(this.colors[0]),this.colorOptions.push(this.colors[1]),this.legendData.push("课前成绩"),this.legendData.push("课后成绩"),this.getStudentData(this.userID,0));break;case 1:this.seriesData=new Array(2),this.seriesData[0]={name:"男生",type:"bar",barGap:0,data:new Array},this.seriesData[1]={name:"女生",type:"bar",barGap:0,data:new Array},this.colorOptions.push(this.colors[0]),this.colorOptions.push(this.colors[3]),this.legendData.push("男生"),this.legendData.push("女生");for(var t=0;t<this.studentInfo.length;t++)this.seriesData[0].data.push(0),this.seriesData[1].data.push(0),this.getGenderAndClassData(this.studentInfo[t].chapterID,t);break;case 2:this.seriesData=new Array(2),this.seriesData[0]={name:this.studentName,type:"bar",barGap:0,data:new Array},this.seriesData[1]={name:"班级平均",type:"bar",barGap:0,data:new Array},this.colorOptions.push(this.colors[0]),this.legendData.push(this.studentName.toString()),this.getStudentData(this.userID,0);for(var s=0;s<this.studentInfo.length;s++)this.seriesData[1].data.push(0),this.getGenderAndClassData(this.studentInfo[s].chapterID,s);this.colorOptions.push(this.colors[2]),this.legendData.push("班级平均")}break;case 1:switch(this.xData=["60以下","60-70","70-80","80-90","90-100"],this.comparison){case 1:this.seriesData=new Array(2),this.seriesData[0]={name:"男生",type:"bar",barGap:0,data:new Array},this.seriesData[1]={name:"女生",type:"bar",barGap:0,data:new Array},this.colorOptions.push(this.colors[0]),this.colorOptions.push(this.colors[3]),this.legendData.push("男生"),this.legendData.push("女生"),this.getScoreDistributeData(this.chapterOptions[this.chapterSettings].id);break;case 2:this.seriesData=new Array(1),this.seriesData[0]={name:"班级",type:"bar",barGap:0,data:new Array},this.colorOptions.push(this.colors[0]),this.legendData.push("班级"),this.getScoreDistributeData(this.chapterOptions[this.chapterSettings].id)}}},drawChart:function(){var e=this.$echarts.init(document.getElementById("myChart"));e.clear(),this.drawCount++,console.log(this.drawCount),e.setOption({color:this.colorOptions,tooltip:{trigger:"axis",axisPointer:{type:"cross"}},legend:{data:this.legendData},dataZoom:[{type:"inside",filterMode:"filter",xAxisIndex:[0],startValue:0,endValue:7,orient:"horizontal",minValueSpan:5}],toolbox:{show:!0,orient:"vertical",right:"20px",top:"center",itemGap:20,feature:{mark:{show:!0},magicType:{show:!0,type:["line","bar","stack","tiled"]},restore:{show:!0},saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:this.xyOptions[this.xy].xName,axisTick:{show:!1},data:this.xData}],yAxis:[{name:this.xyOptions[this.xy].yName,type:"value"}],series:this.seriesData}),this.drawLoading=!1},objDeepCopy:function(e){var t=e instanceof Array?[]:{};for(var s in e)e.hasOwnProperty(s)&&(t[s]="object"===E()(e[s])?this.objDeepCopy(e[s]):e[s]);return t}},created:function(){this.getCourses(),this.seriesData.push({name:this.studentName,type:"bar",barGap:0,data:new Array}),this.colorOptions.push(this.colors[0]),this.legendData.push(this.studentName)}},R={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-container",[s("el-main",{staticClass:"background"},[s("el-row",{staticStyle:{margin:"0 auto",width:"90%","max-height":"685px"},attrs:{gutter:10,type:"flex",justify:"center"}},[s("el-col",{attrs:{span:2,align:"right"}},[s("div",[s("el-button",{staticStyle:{"box-shadow":"0 0 8px 1px #dbdbdb"},attrs:{circle:""},on:{click:e.goBack}},[s("i",{staticClass:"el-icon-back"})])],1)]),e._v(" "),s("el-col",{attrs:{span:6,align:"right"}},[s("el-card",{staticClass:"info-card",attrs:{"body-style":{padding:"0"}}},[s("div",{staticClass:"cardbody"},[s("div",{staticClass:"info",attrs:{align:"start"}},[s("div",[s("span",[e._v(e._s(e.studentID))]),e._v(" "),s("span",[e._v(e._s(e.studentName))])]),e._v(" "),s("el-row",{staticStyle:{"margin-top":"3px"}},[s("div",{staticStyle:{"padding-left":"11px","font-size":"12px",color:"#8e8e8e"}},[e._v("最近学习到 ["+e._s(e.currentName)+"]")])])],1),e._v(" "),s("div",{staticStyle:{padding:"10px 20px 10px 20px"},attrs:{align:"start"}},[s("el-tag",{staticStyle:{"margin-top":"5px"},attrs:{type:"danger",size:"small"}},[e._v("学科")]),e._v(" "),s("el-tag",{staticStyle:{"margin-top":"5px"},attrs:{type:"warning",size:"small"}},[e._v("语言")]),e._v(" "),s("el-tag",{staticStyle:{"margin-top":"5px"},attrs:{type:"success",size:"small"}},[e._v("专业")]),e._v(" "),s("el-tag",{staticStyle:{"margin-top":"5px"},attrs:{type:"info",size:"small"}},[e._v("薄弱")])],1)])]),e._v(" "),s("el-card",{staticClass:"select-card",attrs:{"body-style":{padding:"0"}}},[s("div",{staticClass:"cardbody",attrs:{align:"center"}},[s("div",{staticStyle:{width:"64%"},attrs:{align:"start"}},[s("el-row",{staticClass:"select-title"},[e._v("分析内容")]),e._v(" "),s("el-row",[s("el-select",{attrs:{size:"small"},on:{change:e.handleComparison},model:{value:e.xy,callback:function(t){e.xy=t},expression:"xy"}},e._l(e.xyOptions,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-row",[s("el-select",{staticClass:"select",attrs:{size:"small"},model:{value:e.gradeAttribute,callback:function(t){e.gradeAttribute=t},expression:"gradeAttribute"}},e._l(e.gradeOptions,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value,disabled:e.disabled}})}),1)],1),e._v(" "),3!==e.gradeAttribute?s("el-row",{staticClass:"select-title"},[e._v("对比组")]):e._e(),e._v(" "),3!==e.gradeAttribute?s("el-row",[s("el-select",{attrs:{size:"small"},on:{change:e.handleGradeAttribute},model:{value:e.comparison,callback:function(t){e.comparison=t},expression:"comparison"}},e._l(e.cOptions,function(e){return s("el-option",{key:e.value,attrs:{disabled:e.disabled,label:e.label,value:e.value}})}),1)],1):e._e(),e._v(" "),1===e.xy?s("el-row",[s("el-row",{staticClass:"select-title"},[e._v("选择章节")]),e._v(" "),s("el-row",[s("el-row",[s("el-select",{attrs:{size:"small",filterable:""},model:{value:e.chapterSettings,callback:function(t){e.chapterSettings=t},expression:"chapterSettings"}},e._l(e.chapterOptions,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1):e._e(),e._v(" "),s("el-row",{staticClass:"select"},[s("el-button",{staticClass:"select-button",attrs:{type:"primary",size:"small",loading:e.drawLoading},on:{click:e.getCharts}},[e._v("确定")])],1)],1)])])],1),e._v(" "),s("el-col",{attrs:{span:16}},[s("el-card",{staticClass:"content-card",attrs:{"body-style":{padding:"0"}}},[s("div",{staticClass:"cardbody"},[s("el-scrollbar",{attrs:{"wrap-style":"height: 650px; margin-top: 5px",native:!1}},[s("div",[s("el-collapse",{staticClass:"collapse",model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[s("el-collapse-item",{attrs:{title:"成绩分析",name:"1"}},[s("el-row",{staticStyle:{padding:"10px 20px 0 50px"},attrs:{type:"flex",justify:"start"}},[s("el-select",{attrs:{size:"small"},on:{change:e.handleCourse},model:{value:e.courseIndex,callback:function(t){e.courseIndex=t},expression:"courseIndex"}},e._l(e.courseOptions,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-row",[s("div",{staticClass:"my-chart",attrs:{id:"myChart"}})])],1),e._v(" "),s("el-collapse-item",{attrs:{title:"学习情况",name:"2"}},e._l(e.studentInfo,function(t){return s("div",{key:t.id,staticClass:"response",attrs:{align:"start"}},[s("el-row",[s("div",{staticClass:"title"},[e._v(e._s(t.chapter))])]),e._v(" "),s("el-row",{attrs:{gutter:10}},[s("el-col",{attrs:{span:6}},[s("span",{staticClass:"grade"},[e._v("课前成绩："+e._s(t.scorePre))])]),e._v(" "),s("el-col",{attrs:{span:6}},[s("span",{staticClass:"grade"},[e._v("课后成绩："+e._s(t.scoreRev))])]),e._v(" "),s("el-col",{attrs:{span:6}},[s("span",{staticClass:"grade"},[e._v("平均成绩："+e._s(t.scoreAvg))])])],1),e._v(" "),s("el-row",[s("div",[s("el-rate",{staticClass:"rate",attrs:{disabled:"","show-score":"","text-color":"#ff9900","score-template":"{value}"},model:{value:t.rate,callback:function(s){e.$set(t,"rate",s)},expression:"item.rate"}})],1)]),e._v(" "),s("el-row",{staticStyle:{"margin-top":"13px"}},[s("div",{staticClass:"text"},[e._v(e._s(t.comments))])])],1)}),0)],1)],1)])],1)])],1)],1)],1)],1)},staticRenderFns:[]};var q=s("VU/8")(P,R,!1,function(e){s("SAtU")},"data-v-7ceb500b",null).exports,V={name:"tCourseGraph",data:function(){return{screenWidth:{width:window.screen.width},dataIndex:0,list:[],data:[],links:[]}},created:function(){var e=this;this.$axios.get("http://10.60.38.173:8765/getAllCoursesRelation",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){console.log(t.data),e.list=t.data.data,e.set()}).catch(function(e){console.log(e)})},mounted:function(){this.draw()},methods:{set:function(){for(var e=this.list.map(function(e){return[e.courseName.courseName,{level:0,subCourses:e.subCoursesName.map(function(e){return e.courseName})}]}),t=function(t){var s=e[t][1];s.subCourses.length&&s.subCourses.forEach(function(t){var a=e.findIndex(function(e){return e[0]===t});e[a]=[e[a][0],I()({},e[a][1],{level:e[a][1].level>s.level?e[a][1].level:s.level+1})]})},s=0;s<e.length;s++)t(s);var a=new C.a;e.forEach(function(e){a.set(e[1].level,[])}),e.forEach(function(e){a.set(e[1].level,a.get(e[1].level).concat([e[0]]))});var r=[],i=0,o=function(e){console.log("TCL: set -> item",e[0]),m=e[1].length,i=1700/m,e[1].forEach(function(t,s){var a={name:t,x:Math.round(i+3400/e[1].length*s),y:340*(parseInt(e[0])+1)};r.push(a)})},n=!0,l=!1,c=void 0;try{for(var h,u=y()(a.entries());!(n=(h=u.next()).done);n=!0){o(h.value)}}catch(e){l=!0,c=e}finally{try{!n&&u.return&&u.return()}finally{if(l)throw c}}r.push({name:"start",x:1700,y:0}),this.data=r,console.log("TCL: set -> data",r);for(var d=this.list.length,p=0;p<d;p++){var m=this.list[p].preCoursesName.length,g=this.list[p].courseName.courseName;if(0==m){var f={target:g,source:"start",label:{normal:{show:!1}}};this.links.push(f)}else for(var v=0;v<m;v++){f={target:g,source:this.list[p].preCoursesName[v].courseName,label:{normal:{show:!1}}};this.links.push(f)}}this.draw()},initGraph:function(){var e=this.$refs.graph;return this.$echarts.init(e)},draw:function(){var e=this.$refs.graph,t=this.$echarts.init(e),s={title:{text:"课程关系图"},tooltip:{},animationDurationUpdate:1500,animationEasingUpdate:"quinticInOut",toolbox:{feature:{saveAsImage:{show:!0}}},series:[{type:"graph",layout:"none",top:30,symbolSize:30,roam:!0,label:{normal:{show:!0}},edgeSymbol:["circle","arrow"],edgeSymbolSize:[4,10],edgeLabel:{normal:{textStyle:{fontSize:10,fontColor:"#000"}}},data:this.data,links:this.links,itemStyle:{normal:{color:"#ec7814"}},lineStyle:{normal:{opacity:.9,width:2,curveness:0}}}]};t.setOption(s);var a=this,r=0;t.on("click",function(e){r++,"edge"==e.dataType?(a.dataIndex=e.dataIndex,store.commit("edgeStyle",a.dataIndex),t.setOption(s)):"node"==e.dataType&&(r%2==1?a.graph.dispatchAction({type:"focusNodeAdjacency",dataIndex:e.dataIndex}):r%2==0&&a.graph.dispatchAction({type:"unfocusNodeAdjacency",seriesIndex:e.seriesIndex}))}),document.oncontextmenu=function(){return!1},a.graph=t}}},G={render:function(){var e=this.$createElement,t=this._self._c||e;return t("el-container",[t("el-col",[t("div",{ref:"graph",staticStyle:{height:"600px"}})])],1)},staticRenderFns:[]};var M={name:"tCourseManage",components:{graph:s("VU/8")(V,G,!1,function(e){s("Pi71")},"data-v-a470a454",null).exports},data:function(){return{noCourse:!0,code:"",isPlus:!1,isConfirm:!1,items:[]}},created:function(){var e=this;this.$axios.get("http://10.60.38.173:8765/getCoursesByTeacherID",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{teacherID:203}}).then(function(t){1==t.data.state&&(e.items=t.data.data,0!=e.items.length&&(e.noCourse=!1));e.items=t.data.data,console.log(t.data,"resp.data")}).catch(function(e){console.log(e)})},methods:{couAnalysis:function(){this.$router.push({path:"/teacher/courseAnalysis",query:{teacherID:203}})},courseDetail:function(e,t){this.$router.push({path:"/teacher/courseDetail",query:{courseID:e,classID:t}})},homework:function(e){this.$router.push({path:"/teacher/chapterDetail",query:{chapterID:e}})}}},J={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticStyle:{height:"778px"}},[s("el-col",{attrs:{span:20,offset:2}},[s("el-row",[s("el-col",{staticStyle:{"margin-top":"30px"},attrs:{span:2,offset:2}},[s("el-button",{attrs:{size:"mini",type:"success"},on:{click:e.couAnalysis}},[e._v("课程分析")])],1),e._v(" "),s("el-col",{attrs:{span:16}},[s("el-card",{staticStyle:{"margin-top":"10px",height:"600px","text-align":"center"},attrs:{"body-style":"{padding:'0px'}",shadow:"never"}},[s("graph")],1)],1)],1),e._v(" "),s("el-row",{directives:[{name:"show",rawName:"v-show",value:e.noCourse,expression:"noCourse"}],staticStyle:{"font-size":"18px","letter-spacing":"5px"}},[s("el-row",{staticStyle:{padding:"30px"}},[e._v("还没有课？")]),e._v(" "),s("el-row",[e._v("请联系"),s("span",{staticStyle:{color:"darkcyan","font-weight":"bold"}},[e._v("学院管理员")]),e._v("为您开课吧\n      ")])],1),e._v(" "),s("el-row",{attrs:{gutter:40}},[s("el-col",{attrs:{span:22,offset:1}},e._l(e.items,function(t,a){return s("el-col",{key:a,attrs:{span:8}},[s("el-card",{staticStyle:{margin:"20px 0"},attrs:{"body-style":{padding:0}}},[s("el-row",{staticClass:"top"},[s("p",{attrs:{id:"name"},on:{click:function(s){return e.courseDetail(t.courseInfo.courseID,t.courseClass.id)}}},[e._v(e._s(t.courseInfo.courseName+"("+t.courseClass.classNum+")"))]),e._v(" "),s("el-row",[s("el-col",{staticStyle:{"margin-top":"0px"},attrs:{span:5,offset:18}},[s("span",{staticStyle:{"font-size":"10px",color:"rgb(238, 235, 235)"}},[e._v("老师："+e._s(t.courseInfo.teacherName))])])],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:5,offset:18}},[s("span",{staticStyle:{"font-size":"10px",color:"rgb(238, 235, 235)"}},[e._v("ID："+e._s(t.courseInfo.teacherID))])])],1)],1),e._v(" "),s("el-row",{staticStyle:{height:"90px"}},[s("el-row",[s("el-col",{staticStyle:{"text-align":"left"},attrs:{span:16,offset:1}},[s("p",{staticStyle:{"font-size":"13px",color:"#000"}},[e._v("近期作业")]),e._v(" "),s("p",{attrs:{id:"newest"},on:{click:function(s){return e.homework(t.courseClass.currentExerciseChapter)}}},[e._v("第 "+e._s(t.courseClass.currentExerciseChapter)+" 章课后习题")])])],1),e._v(" "),s("el-row",[s("el-row",{staticStyle:{"font-size":"12px","text-align":"right"}},[s("el-col",{attrs:{span:10,offset:13}},[e._v("邀请码："+e._s(t.courseClass.classCode))])],1)],1)],1)],1)],1)}),1)],1)],1)],1)},staticRenderFns:[]};var Y=s("VU/8")(M,J,!1,function(e){s("MOo/"),s("K6xb")},"data-v-d0ad9a44",null).exports,U=0,H=0,Z={name:"tCourseDetail",data:function(){return{number:0,courseID:1,classID:1,isNotice:!1,isLesson:!0,isGrade:!1,isGraph:!0,notice:"Java是一门面向对象编程语言.",textarea:"添加/修改课程介绍",rate:20,lesson:null,data:[{name:"start",x:250,y:0}],links:[],defaultProps:{children:"subCatalog",label:"contentName"},graphTree:[],tree:[]}},created:function(){this.getParams(),console.log(this.courseID);var e=this.$route.query.courseID;this.courseID=e,console.log(this.courseID),this.getChapterGraph(),this.getNotice(),this.getLesson()},methods:{getChapterGraph:function(){var e=this;this.$axios.get("http://10.60.38.173:8765/getChapterRelationByCourseID",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{courseID:this.courseID}}).then(function(t){console.log(t.data),1==t.data.state&&(e.graphTree=t.data.data,console.log(e.graphTree,"graphtree-teacher"),e.init())}).catch(function(e){console.log(e)})},getParams:function(){var e=this.$route.query.courseID;this.courseID=e,this.classID=this.$route.query.classID,this.getNotice()},getNotice:function(){var e=this;axios.get("http://10.60.38.173:8765/getNoticeByCouID",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{courseID:this.courseID}}).then(function(t){1==t.data.state&&(e.textarea=t.data.data.courseNotice)}).catch(function(e){console.log(e)})},changeNotice:function(){var e=this,t=new URLSearchParams;t.append("courseID",this.courseID),t.append("courseNotice",this.textarea),this.$axios.post("http://10.60.38.173:8765/addCourseNotice",t,{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){console.log("notice success",t.data),1==t.data.state?e.$message("修改成功"):e.$message(t.data.message)}).catch(function(e){console.log(e)})},getLesson:function(){var e=this;this.$axios.get("http://10.60.38.173:8765/getCourseCatalog",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{courseID:this.courseID}}).then(function(t){1==t.data.state&&(e.tree=t.data.data,console.log(e.tree,"lesson-tree")),console.log(e.courseID)}).catch(function(e){console.log(e)})},changeLesson:function(){1==this.isGraph?this.isGraph=!1:this.isGraph=!0},getGrade:function(){0==this.isGrade&&(this.isNotice=!1,this.isLesson=!1,this.isGrade=!0)},showNotice:function(){0==this.isNotice&&(this.isNotice=!0,this.isLesson=!1,this.isGrade=!1)},showLesson:function(){0==this.isLesson&&(this.isNotice=!1,this.isLesson=!0,this.isGrade=!1)},gradeItem:function(e){var t=new Date,s=this.tree[e].exerciseDeadline_2;if(new Date(s)<t)return!0},grade:function(e,t){this.$router.push({path:"/teacher/mark",name:"exerciseMark",query:{chapterID:e,classID:this.classID,name:t}})},handleNodeClick:function(e){0==e.subCatalog.length&&this.$router.push({path:"chapterDetail/point",query:{chapterIDt:e.id,courseIDt:this.courseID}})},editChapter:function(){this.$router.push({path:"/teacher/chapterEdit",query:{id:this.courseID,classID:this.classID}})},courseBack:function(){this.$router.push({path:"/teacher/courseManagement"})},init:function(){var e=this.graphTree.map(function(e){return[e.chapterNode.contentName,{level:0,subChapter:e.subChapterNodes.map(function(e){return e.contentName})}]});console.log("TCL: init -> nodes",this.graphTree,e);for(var t=function(t){var s=e[t][1];s.subChapter.length&&s.subChapter.forEach(function(t){var a=e.findIndex(function(e){return e[0]===t});e[a]=[e[a][0],I()({},e[a][1],{level:e[a][1].level>s.level?e[a][1].level:s.level+1})]})},s=0;s<e.length;s++)t(s);var a=new C.a;e.forEach(function(e){a.set(e[1].level,[])}),e.forEach(function(e){a.set(e[1].level,a.get(e[1].level).concat([e[0]]))});var r=[],i=0,o=function(e){m=e[1].length,i=1800/m,e[1].forEach(function(t,s){var a={name:t,x:Math.round(i+3600/m*s),y:350*(parseInt(e[0])+1)};r.push(a)})},n=!0,l=!1,c=void 0;try{for(var h,u=y()(a.entries());!(n=(h=u.next()).done);n=!0){o(h.value)}}catch(e){l=!0,c=e}finally{try{!n&&u.return&&u.return()}finally{if(l)throw c}}r.push({name:"start",x:1800,y:0}),this.data=r,console.log("TCL: set -> data",r);for(var d=this.graphTree.length,p=0;p<d;p++){var m=this.graphTree[p].preChapterNodes.length,g=this.graphTree[p].chapterNode.contentName;if(0==m){var f={target:g,source:"start",label:{normal:{show:!1}}};this.links.push(f)}else for(var v=0;v<m;v++){f={target:g,source:this.graphTree[p].preChapterNodes[v].contentName,label:{normal:{show:!1}}};this.links.push(f)}}this.draw()},draw:function(){var e=this.$refs.graph,t=this.$echarts.init(e),s={tooltip:{},animationDurationUpdate:1500,animationEasingUpdate:"quinticInOut",toolbox:{feature:{saveAsImage:{show:!0}}},series:[{type:"graph",layout:"none",top:30,symbolSize:20,color:"#ec7814",roam:!0,itemStyle:{normal:{color:"#ec7814",label:{show:!0,fontSize:12,formatter:function(e){return-1!=e.name.indexOf("、")?e.name.split("、").join("\n"):e.name.split(" ").join("\n")}}}},edgeSymbol:["circle","arrow"],edgeSymbolSize:[4,10],edgeLabel:{normal:{textStyle:{fontSize:10,fontColor:"#000"}}},data:this.data,links:this.links,lineStyle:{normal:{opacity:.9,width:1,curveness:0}}}]};t.setOption(s);var a=this,r=0;t.on("click",function(e){if(r++,"edge"==e.dataType){a.dataIndex=e.dataIndex;var i=a.links[a.dataIndex].label.normal.show;a.links[a.dataIndex].label.normal.show=0==i,t.setOption(s)}else"node"==e.dataType&&(r%2==1?a.myChart.dispatchAction({type:"focusNodeAdjacency",dataIndex:e.dataIndex}):r%2==0&&a.myChart.dispatchAction({type:"unfocusNodeAdjacency",seriesIndex:e.seriesIndex}))}),document.oncontextmenu=function(){return!1},a.myChart=t},renderContent:function(e,t){var s=this,a=t.node,r=t.data;t.store;return 0==r.parentID?(H=0,e("span",{style:"flex: 1; display: flex; align-items: center; justify-content: space-between; font-size: 14px; padding-right: 8px;"},[e("span",[e("span",{style:"color:#000;font-size:15px"},["第 "+(U+=1)+" 章 "," "]),e("span",[a.label])]),e("span",[e("el-button",{style:"font-size: 12px;color:#000;",attrs:{size:"mini",round:!0},on:{click:function(){return s.pre(r)}}},["课前摸底"]),e("el-button",{style:"font-size: 12px;",attrs:{size:"mini",type:"info",round:!0},on:{click:function(){return s.rev(a,r)}}},["课后作业"])])])):e("span",{style:"flex: 1; display: flex; align-items: center; justify-content: space-between; font-size: 14px; padding-right: 8px;"},[e("span",[e("span",[U+"."+(H+=1)," "]),e("span",[a.label])])])},pre:function(e){console.log(e,"pre"),this.$router.push({path:"chapterDetail/preExercise",query:{tpreid:e.id,courseIDt:this.courseID}})},rev:function(e,t){console.log(e,t,"rev"),this.$router.push({path:"chapterDetail/revExercise",query:{trevid:t.id,courseIDt:this.courseID}})},stuDetail:function(){this.$router.push({path:"/teacher/studentList",query:{classID:this.classID,courseID:this.courseID}})}}},W={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-row",{staticClass:"courseBack"},[s("el-row",{staticStyle:{"line-height":"50px"}},[s("el-col",{attrs:{span:2}},[s("i",{staticClass:"el-icon-back",on:{click:e.courseBack}})])],1),e._v(" "),s("el-row",[s("div",{staticStyle:{"line-height":"150px"}},[e._v("JAVA")])]),e._v(" "),s("el-row",[s("el-col",{attrs:{span:1,offset:21}},[s("el-button",{attrs:{type:"text"},on:{click:e.stuDetail}},[e._v("学生")])],1)],1)],1),e._v(" "),s("el-row",[s("div",{staticClass:"tabs"},[s("el-col",{attrs:{span:4,offset:6}},[s("div",{staticClass:"tabBack",class:{clickDiv:e.isNotice},on:{click:e.showNotice}},[s("el-button",{staticClass:"tab",class:{clickButton:e.isNotice},attrs:{type:"text"},on:{click:e.getNotice}},[e._v("公告")])],1)]),e._v(" "),s("el-col",{attrs:{span:4}},[s("div",{staticClass:"tabBack",class:{clickDiv:e.isLesson},on:{click:e.showLesson}},[s("el-button",{staticClass:"tab",class:{clickButton:e.isLesson},attrs:{type:"text"}},[e._v("课程及练习")])],1)]),e._v(" "),s("el-col",{attrs:{span:4}},[s("div",{staticClass:"tabBack",class:{clickDiv:e.isGrade},on:{click:e.getGrade}},[s("el-button",{staticClass:"tab",class:{clickButton:e.isGrade},attrs:{type:"text"}},[e._v("评分")])],1)])],1)]),e._v(" "),s("el-row",[s("div",[s("div",{directives:[{name:"show",rawName:"v-show",value:e.isNotice,expression:"isNotice"}],staticClass:"noticeBack"},[s("el-col",{attrs:{span:10,offset:7}},[s("div",{staticClass:"notice"},[e._v(e._s(e.textarea))]),e._v(" "),s("el-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入课程介绍"},model:{value:e.textarea,callback:function(t){e.textarea=t},expression:"textarea"}}),e._v(" "),s("el-row",{staticStyle:{"padding-top":"20px"}},[s("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.changeNotice}},[e._v("确 认")])],1)],1)],1),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isLesson,expression:"isLesson"}],staticClass:"noticeBack"},[s("el-row",[s("el-col",{staticStyle:{"margin-top":"-130px"},attrs:{span:2,offset:16}},[s("el-button",{attrs:{type:"text"},on:{click:e.changeLesson}},[e._v("切换")]),e._v(" "),s("el-button",{attrs:{type:"text"},on:{click:e.editChapter}},[e._v("编辑章节")])],1)],1),e._v(" "),s("el-row",[s("el-col",{staticStyle:{"margin-top":"-80px","margin-bottom":"40px"},attrs:{span:12,offset:6}},[s("div",{directives:[{name:"show",rawName:"v-show",value:1==e.isGraph,expression:"isGraph==true"}]},[s("div",{ref:"graph",staticStyle:{height:"300px",border:"1px solid #ddd","margin-bottom":"20px"}})]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:0==e.isGraph,expression:"isGraph==false"}]},[s("el-tree",{attrs:{data:e.tree,props:e.defaultProps,"default-expand-all":"","expand-on-click-node":!1,"render-content":e.renderContent},on:{"node-click":e.handleNodeClick}})],1)])],1)],1),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isGrade,expression:"isGrade"}],staticClass:"gradeBack"},e._l(e.tree,function(t,a){return s("el-col",{key:a,attrs:{span:10,offset:7}},[e.gradeItem(a)?s("div",[s("el-row",{staticStyle:{"padding-bottom":"20px"}},[s("el-card",{staticClass:"grade",attrs:{shadow:"hover"}},[s("p",{staticStyle:{"margin-bottom":"0px"}},[e._v(e._s(t.contentName+"（"+t.exerciseDeadline_2+"）"))]),e._v(" "),s("el-button",{attrs:{type:"text"},on:{click:function(s){return e.grade(t.id,t.exerciseTitle)}}},[e._v("点击进入评分")])],1)],1)],1):e._e()])}),1)])])],1)},staticRenderFns:[]};var X=s("VU/8")(Z,W,!1,function(e){s("2UST"),s("LpXL")},"data-v-c60c9e16",null).exports,K={name:"chapterCatalog",data:function(){return{courseID:0,teacherID:202,classID:0,catalog:[{chapterName:"章节一",predecessor:[],points:[{name:"知识点1",edit:!1},{name:"知识点2",edit:!1},{name:"知识点3",edit:!1}]}],chapterData:[],updateChapterVisible:!1,importChapterVisible:!1,chapterForm:{},chapterRules:{order:[{required:!0,message:"请输入章节号",trigger:"blur"}],name:[{required:!0,message:"请输入章节名",trigger:"blur"}]},importData:[],importSettings:"暂无数据",newPoint:{},reloadCatalog:!1,submitLoading:!1,importLoading:!1,menuLoading:!1}},methods:{goBack:function(){if(window.history.length<=1)return this.$router.push({path:"/"}),!1;this.$router.push({path:"/teacher/courseDetail",query:{courseID:this.courseID,classID:this.classID}})},getCatalog:function(e){var t=this;this.catalog=[],this.chapterData=[],this.menuLoading=!0,this.$http.get("http://10.60.38.173:8765/getCourseCatalog?courseID="+this.courseID,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(s){if(200===s.status){var a=JSON.parse(s.bodyText);if(1===a.state){for(var r=0;r<a.data.length;){var i=a.data[r].contentName.indexOf("章");t.catalog.push({id:a.data[r].id,chapterName:a.data[r].contentName,parentID:a.data[r].parentID,siblingID:a.data[r].siblingID,content:a.data[r].content,predecessor:[],descendant:[],points:[],order:a.data[r].contentName.substring(1,i)});for(var o=0;o<a.data[r].subCatalog.length;o++){var n=a.data[r].subCatalog[o].contentName.indexOf("."),l=a.data[r].subCatalog[o].contentName.indexOf(" ");t.catalog[r].points.push({id:a.data[r].subCatalog[o].id,name:a.data[r].subCatalog[o].contentName,courseID:a.data[r].subCatalog[o].courseID,parentID:a.data[r].subCatalog[o].parentID,siblingID:a.data[r].subCatalog[o].siblingID,content:a.data[r].subCatalog[o].content,order:a.data[r].subCatalog[o].contentName.substring(n+1,l),edit:!1,new:!1})}t.chapterData.push({key:a.data[r].id,label:a.data[r].contentName,disabled:!1}),r++}t.reloadCatalog=!1}!0===e&&t.insertChapter(),t.getRelation()}else t.$message({type:"error",message:"加载失败!"}),t.menuLoading=!1},function(e){t.$message({type:"error",message:"加载失败!"}),t.menuLoading=!1})},getRelation:function(){var e=this;this.$http.get("http://10.60.38.173:8765/getChapterRelationByCourseID?courseID="+this.courseID,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200===t.status){var s=JSON.parse(t.bodyText);if(1===s.state)for(var a=0;a<s.data.length;){for(var r=0;r<e.catalog.length;){if(e.catalog[r].id===s.data[a].chapterNode.id){for(var i=0;i<s.data[a].preChapterNodes.length;i++)e.catalog[r].predecessor.push(s.data[a].preChapterNodes[i].id);for(var o=0;o<s.data[a].subChapterNodes.length;o++)e.catalog[r].descendant.push(s.data[a].subChapterNodes[o].id)}r++}a++}e.menuLoading=!1}else e.menuLoading=!1,e.$message({type:"error",message:"加载失败!"})},function(t){e.menuLoading=!1,e.$message({type:"error",message:"加载失败!"})})},getCourses:function(){var e=this;this.importData=[],this.$http.get("http://10.60.38.173:8765/question/sameCoursesById?courseId="+this.courseID+"&teacherId="+this.teacherID,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200===t.status){var s=JSON.parse(t.bodyText);if(1===s.state)for(var a=0,r=0;a<s.data.length;)Number(s.data[a].courseID)!==Number(e.courseID)&&(e.importData.push({value:r,label:s.data[a].courseYear+s.data[a].courseSemester,id:s.data[a].courseID}),r++),a++;e.importData.length>0&&(e.importSettings=0)}else e.$message({type:"error",message:"加载失败!"})},function(t){e.$message({type:"error",message:"加载失败!"})})},handleImportChapter:function(){this.importChapterVisible=!0},handleImportChapterClose:function(){},handleAddChapter:function(){this.updateChapterVisible=!0,this.chapterForm={index:this.catalog.length,order:0,name:"",predecessor:[],descendant:[],new:!0}},handleAddPoint:function(e){this.catalog[e].points.push({name:"",order:0,edit:!0,new:!0}),this.newPoint={name:"",order:0,edit:!0,new:!0}},handleEditPoint:function(e){e.edit=!0,this.newPoint=this.objDeepCopy(e);var t=this.newPoint.name.indexOf(" ")+1;this.newPoint.name=this.newPoint.name.substring(t)},handleEditChapter:function(e){this.updateChapterVisible=!0;var t=this.catalog[e].chapterName.indexOf("章");this.chapterForm={index:e,order:this.catalog[e].chapterName.substring(1,t),name:this.catalog[e].chapterName.substring(t+2),predecessor:this.catalog[e].predecessor,descendant:this.catalog[e].descendant,new:!1},this.chapterData[e].disabled=!0},resetEdit:function(){var e=this.catalog[this.chapterForm.index].chapterName.indexOf("章"),t={index:this.chapterForm.index,order:this.catalog[this.chapterForm.index].chapterName.substring(1,e),name:this.catalog[this.chapterForm.index].chapterName.substring(e+2),predecessor:this.catalog[this.chapterForm.index].predecessor,descendant:this.catalog[this.chapterForm.index].descendant,new:!1};this.chapterForm=t},handleChapterClose:function(){for(var e=0;e<this.chapterData.length;e++)this.chapterData[e].disabled=!1},alterChapterOrder:function(e,t){var s=this;this.$http.post("http://10.60.38.173:8765/alertChapter",{id:e.id,courseID:this.courseID,contentName:t,parentID:e.parentID,siblingID:e.siblingID,content:e.content},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200!==e.status)return s.$message({type:"error",message:"章节编辑失败!"}),void(s.submitLoading=!1)},function(e){s.$message({type:"error",message:"章节编辑失败!"}),s.submitLoading=!1})},alterChapterSib:function(e,t){var s=this;this.$http.post("http://10.60.38.173:8765/alertChapter",{id:e.id,courseID:this.courseID,contentName:e.chapterName,parentID:e.parentID,siblingID:t,content:e.content},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200!==e.status)return s.$message({type:"error",message:"章节编辑失败!"}),void(s.submitLoading=!1);s.getCatalog()},function(e){s.$message({type:"error",message:"章节编辑失败!"}),s.submitLoading=!1})},insertChapter:function(){var e=this;if(0===this.catalog.length)this.$http.post("http://10.60.38.173:8765/addChapter",{courseID:this.courseID,contentName:"第"+this.chapterForm.order.toString()+"章 "+this.chapterForm.name,parentID:0,siblingID:0,content:""},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200!==t.status)return e.$message({type:"error",message:"章节添加失败!"}),void(e.submitLoading=!1);e.updateChapterVisible=!1,e.submitLoading=!1,e.getCatalog()},function(t){e.$message({type:"error",message:"章节添加失败!"}),e.submitLoading=!1});else if(Number(this.chapterForm.order)>=Number(this.catalog[this.catalog.length-1].order)){var t=this.catalog.length-1,s=this.catalog[t].id;this.$http.post("http://10.60.38.173:8765/addChapter",{courseID:this.courseID,contentName:"第"+this.chapterForm.order.toString()+"章 "+this.chapterForm.name,parentID:0,siblingID:s,content:""},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200!==t.status)return e.$message({type:"error",message:"章节添加失败!"}),void(e.submitLoading=!1);var s={id:JSON.parse(t.bodyText).data.id,predecessor:[]};e.editPredecessor(s),e.getCatalog()},function(t){e.$message({type:"error",message:"章节添加失败!"}),e.submitLoading=!1})}else{var a=0,r=!1,i=0;if(1!==Number(this.chapterForm.order))for(var o=0;o<this.catalog.length;o++)if(Number(this.catalog[o].order)<Number(this.chapterForm.order)&&Number(this.catalog[o+1].order)>=Number(this.chapterForm.order)){a=this.catalog[o].id,i=o+1,Number(this.catalog[o+1].order)===Number(this.chapterForm.order)&&(r=!0);break}this.$http.post("http://10.60.38.173:8765/addChapter",{courseID:this.courseID,contentName:"第"+this.chapterForm.order.toString()+"章 "+this.chapterForm.name,parentID:0,siblingID:a,content:""},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200!==t.status)return e.$message({type:"error",message:"章节添加失败!"}),void(e.submitLoading=!1);if(r)for(var s=i;s<e.catalog.length;s++){var a=e.catalog[s].chapterName.indexOf("章")+1,o="第"+(Number(e.catalog[s].order)+1)+"章"+e.catalog[s].chapterName.substr(a);e.catalog[s].chapterName=o,e.alterChapterOrder(e.catalog[s],o)}var n=JSON.parse(t.bodyText),l={id:n.data.id,predecessor:[]};e.editPredecessor(l),e.alterChapterSib(e.catalog[i],n.data.id)},function(t){e.$message({type:"error",message:"章节添加失败!"}),e.submitLoading=!1})}},insertDelete:function(e){var t=this;if(0===e&&e!==this.catalog.length-1){if(Number(this.catalog[e+1].order)===Number(Number(this.catalog[e].order)+1))for(var s=e+1;s<this.catalog.length;s++){var a=this.catalog[s].chapterName.indexOf("章")+1,r="第"+(Number(this.catalog[s].order)-1)+"章"+this.catalog[s].chapterName.substr(a);this.catalog[s].chapterName=r,this.alterChapterOrder(this.catalog[s],r)}this.$http.post("http://10.60.38.173:8765/alertChapter",{id:this.catalog[e+1].id,courseID:this.courseID,contentName:this.catalog[e+1].chapterName,parentID:0,siblingID:0,content:""},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200!==e.status)return t.$message({type:"error",message:"章节编辑失败!"}),void(t.submitLoading=!1)},function(e){t.$message({type:"error",message:"章节编辑失败!"}),t.submitLoading=!1})}else if(e<this.catalog.length-1){if(Number(this.catalog[e+1].order)===Number(Number(this.catalog[e].order)+1))for(var i=e+1;i<this.catalog.length;i++){var o=this.catalog[i].chapterName.indexOf("章")+1,n="第"+(Number(this.catalog[i].order)-1)+"章"+this.catalog[i].chapterName.substr(o);this.catalog[i].chapterName=n,this.alterChapterOrder(this.catalog[i],n)}this.$http.post("http://10.60.38.173:8765/alertChapter",{id:this.catalog[e+1].id,courseID:this.courseID,contentName:this.catalog[e+1].chapterName,parentID:0,siblingID:this.catalog[e-1].id,content:""},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200!==e.status)return t.$message({type:"error",message:"章节编辑失败!"}),void(t.submitLoading=!1)},function(e){t.$message({type:"error",message:"章节编辑失败!"}),t.submitLoading=!1})}this.deleteChapterRelation(this.catalog[e]),this.$http.get("http://10.60.38.173:8765/deleteChapter",{params:{chapterID:this.catalog[e].id},headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200!==e.status)return t.$message({type:"error",message:"章节编辑失败!"}),void(t.menuLoading=!1);t.getCatalog(!0)},function(e){t.$message({type:"error",message:"章节编辑失败!"}),t.menuLoading=!1})},updateChapter:function(){var e=this;if(Number(this.chapterForm.order)===Number(this.catalog[this.chapterForm.index].order)){var t=0;this.chapterForm.index>0&&(t=this.catalog[this.chapterForm.index-1].id),this.$http.post("http://10.60.38.173:8765/alertChapter",{id:this.catalog[this.chapterForm.index].id,courseID:this.courseID,contentName:"第"+this.chapterForm.order.toString()+"章 "+this.chapterForm.name,parentID:0,siblingID:t,content:""},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200!==t.status)return e.$message({type:"error",message:"章节编辑失败!"}),void(e.submitLoading=!1);JSON.parse(t.bodyText);e.editPredecessor(e.catalog[e.chapterForm.index]),e.getCatalog()},function(t){e.$message({type:"error",message:"章节编辑失败!"}),e.submitLoading=!1})}else this.insertDelete(this.chapterForm.index)},confirmEdit:function(){Number(this.chapterForm.order)<0&&this.$message({type:"warning",message:"请正确填写章节号!"});this.submitLoading=!0,this.chapterForm.new?this.insertChapter():this.updateChapter()},editPredecessor:function(e){for(var t=this,s=!0,a=0;a<e.predecessor.length;a++)this.chapterForm.predecessor.indexOf(e.predecessor[a])<0&&(s=!1,this.$http.get("http://10.60.38.173:8765/deleteChapterRelation",{params:{chapterID:e.id,preChapterID:e.predecessor[a]},headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200!==e.status)return t.$message({type:"error",message:"章节更新失败!"}),void(t.submitLoading=!1);t.getRelation(),t.submitLoading=!1},function(e){t.$message({type:"error",message:"章节更新失败!"}),t.submitLoading=!1}));for(var r=0;r<this.chapterForm.predecessor.length;r++)e.predecessor.indexOf(this.chapterForm.predecessor[r])<0&&(s=!1,this.$http.get("http://10.60.38.173:8765/addChapterRelation",{params:{chapterID:e.id,preChapterID:this.chapterForm.predecessor[r]},headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200!==e.status)return t.$message({type:"error",message:"章节更新失败!"}),void(t.submitLoading=!1);t.getRelation(),t.submitLoading=!1},function(e){t.$message({type:"error",message:"章节更新失败!"}),t.submitLoading=!1}));this.updateChapterVisible=!1,this.$message({type:"success",message:"章节更新成功!"}),s&&(this.submitLoading=!1,this.getRelation())},deleteChapter:function(e){var t=this;this.$confirm("确认删除此章节吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){if(t.menuLoading=!0,0===e&&e!==t.catalog.length-1){if(Number(t.catalog[e+1].order)===Number(Number(t.catalog[e].order)+1))for(var s=e+1;s<t.catalog.length;s++){var a=t.catalog[s].chapterName.indexOf("章")+1,r="第"+(Number(t.catalog[s].order)-1)+"章"+t.catalog[s].chapterName.substr(a);t.catalog[s].chapterName=r,t.alterChapterOrder(t.catalog[s],r)}t.$http.post("http://10.60.38.173:8765/alertChapter",{id:t.catalog[e+1].id,courseID:t.courseID,contentName:t.catalog[e+1].chapterName,parentID:0,siblingID:0,content:""},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200!==e.status)return t.$message({type:"error",message:"章节删除失败!"}),void(t.submitLoading=!1)},function(e){t.$message({type:"error",message:"章节删除失败!"}),t.submitLoading=!1})}else if(e<t.catalog.length-1){if(Number(t.catalog[e+1].order)===Number(Number(t.catalog[e].order)+1))for(var i=e+1;i<t.catalog.length;i++){var o=t.catalog[i].chapterName.indexOf("章")+1,n="第"+(Number(t.catalog[i].order)-1)+"章"+t.catalog[i].chapterName.substr(o);t.catalog[i].chapterName=n,t.alterChapterOrder(t.catalog[i],n)}t.$http.post("http://10.60.38.173:8765/alertChapter",{id:t.catalog[e+1].id,courseID:t.courseID,contentName:t.catalog[e+1].chapterName,parentID:0,siblingID:t.catalog[e-1].id,content:""},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200!==e.status)return t.$message({type:"error",message:"章节删除失败!"}),void(t.submitLoading=!1)},function(e){t.$message({type:"error",message:"章节删除失败!"}),t.submitLoading=!1})}t.deleteChapterRelation(t.catalog[e]),t.$http.get("http://10.60.38.173:8765/deleteChapter",{params:{chapterID:t.catalog[e].id},headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200!==e.status)return t.$message({type:"error",message:"删除失败!"}),void(t.menuLoading=!1);t.$message({type:"success",message:"已删除章节!"}),t.menuLoading=!1,t.getCatalog()},function(e){t.$message({type:"error",message:"删除失败!"}),t.menuLoading=!1})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},deleteChapterRelation:function(e){for(var t=this,s=0;s<e.predecessor.length;s++)this.$http.get("http://10.60.38.173:8765/deleteChapterRelation",{params:{chapterID:e.id,preChapterID:e.predecessor[s]},headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){200===e.status?t.getRelation():t.$message({type:"error",message:"章节关系删除失败!"})},function(e){t.$message({type:"error",message:"章节关系删除失败!"})});for(var a=0;a<e.descendant.length;a++)this.$http.get("http://10.60.38.173:8765/deleteChapterRelation",{params:{chapterID:e.descendant[a],preChapterID:e.id},headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){200===e.status?t.getRelation():t.$message({type:"error",message:"章节关系删除失败!"})},function(e){t.$message({type:"error",message:"章节关系删除失败!"})})},confirmImport:function(){var e=this;"number"==typeof this.importSettings?this.$confirm("之前的章节信息将被覆盖，确认导入吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.importLoading=!0,e.$http.post("http://10.60.38.173:8765/question/copyNodes",{sourceCourseId:e.importData[e.importSettings].id,aimCourseId:e.courseID},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200!==t.status)return e.$message({type:"error",message:"章节导入失败!"}),void(e.importLoading=!1);e.$message({type:"success",message:"章节导入成功!"}),e.getCatalog(),e.importLoading=!1,e.importChapterVisible=!1},function(t){e.$message({type:"error",message:"章节导入失败!"}),e.importLoading=!1})}).catch(function(){}):this.$message({type:"warning",message:"无法导入章节信息!"})},deletePoint:function(e,t){var s=this;this.$confirm("确认删除此知识点吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){s.menuLoading=!0,0===t&&t!==e.points.length-1?s.$http.post("http://10.60.38.173:8765/alertChapter",{id:e.points[t+1].id,courseID:s.courseID,contentName:e.points[t+1].name,parentID:e.id,siblingID:0,content:e.points[t+1].content},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200!==e.status)return s.$message({type:"error",message:"知识点删除失败!"}),void(s.submitLoading=!1)},function(e){s.$message({type:"error",message:"知识点删除失败!"}),s.submitLoading=!1}):t<e.points.length-1&&s.$http.post("http://10.60.38.173:8765/alertChapter",{id:e.points[t+1].id,courseID:s.courseID,contentName:e.points[t+1].name,parentID:e.id,siblingID:e.points[t-1].id,content:e.points[t+1].content},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200!==e.status)return s.$message({type:"error",message:"知识点删除失败!"}),void(s.submitLoading=!1)},function(e){s.$message({type:"error",message:"知识点删除失败!"}),s.submitLoading=!1}),s.$http.get("http://10.60.38.173:8765/deleteChapter",{params:{chapterID:e.points[t].id},headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200!==e.status)return s.$message({type:"error",message:"删除失败!"}),void(s.menuLoading=!1);s.$message({type:"success",message:"已删除知识点!"}),s.getCatalog()},function(e){s.$message({type:"error",message:"删除失败!"}),s.menuLoading=!1})}).catch(function(){s.$message({type:"info",message:"已取消删除"})})},cancelEdit:function(e,t,s){s.new?e.points.splice(t,1):s.edit=!1,this.newPoint={}},submitEdit:function(e,t,s){var a=this;if(this.newPoint.order<=0||""===this.newPoint.order)this.$message({type:"warning",message:"请正确填写知识点序号!"});else if(void 0!=this.newPoint.name&&""!==this.newPoint.name){var r=0;s>0&&(r=e.points[s-1].id),this.menuLoading=!0,t.new?this.$http.post("http://10.60.38.173:8765/addChapter",{courseID:this.courseID,contentName:e.order+"."+this.newPoint.order+" "+this.newPoint.name,parentID:e.id,siblingID:r,content:""},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200!==e.status)return a.$message({type:"error",message:"知识点添加失败!"}),void(a.menuLoading=!1);JSON.parse(e.bodyText);a.$message({type:"success",message:"知识点添加成功!"}),a.getCatalog(),a.newPoint={}},function(e){a.$message({type:"error",message:"知识点添加失败!"}),a.menuLoading=!1}):this.$http.post("http://10.60.38.173:8765/alertChapter",{id:t.id,courseID:this.courseID,contentName:e.order+"."+this.newPoint.order+" "+this.newPoint.name,parentID:e.id,siblingID:r,content:t.content},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200!==e.status)return a.$message({type:"error",message:"知识点编辑失败!"}),void(a.menuLoading=!1);JSON.parse(e.bodyText);a.$message({type:"success",message:"知识点编辑成功!"}),a.getCatalog(),a.newPoint={}},function(e){a.$message({type:"error",message:"知识点编辑失败!"}),a.menuLoading=!1})}else this.$message({type:"warning",message:"请填写知识点名称!"})},objDeepCopy:function(e){var t=e instanceof Array?[]:{};for(var s in e)e.hasOwnProperty(s)&&(t[s]="object"===E()(e[s])?this.objDeepCopy(e[s]):e[s]);return t},getData:function(e){this.reloadCatalog=e}},created:function(){var e=this;this.courseID=this.$route.query.id,this.classID=this.$route.query.classID,this.getCatalog(),this.getCourses(),n.$on("reloadCatalog",function(t){return e.getData(t)})},watch:{reloadCatalog:function(e){!0===e&&this.getCatalog()}}},Q={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-container",[s("el-aside",[s("el-menu",{directives:[{name:"loading",rawName:"v-loading",value:e.menuLoading,expression:"menuLoading"}],staticStyle:{height:"100%","min-height":"720px"},attrs:{"default-active":"0-0","background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[s("el-menu-item",{attrs:{index:"101"}},[s("span",[s("el-button",{staticStyle:{color:"#fff"},attrs:{type:"text"},on:{click:e.handleImportChapter}},[e._v("导入章节")])],1),e._v(" "),s("span",{staticStyle:{"margin-left":"40px"}},[s("el-button",{staticStyle:{color:"#fff"},attrs:{type:"text"},on:{click:e.handleAddChapter}},[e._v("添加章节")])],1)]),e._v(" "),s("el-scrollbar",{attrs:{"wrap-style":"height: calc(100vh - 150px)",native:!1}},e._l(e.catalog,function(t,a){return s("el-submenu",{key:a,attrs:{index:a.toString()}},[s("template",{slot:"title"},[s("span",[s("el-button",{staticStyle:{color:"#fff"},attrs:{type:"text",size:"mini",circle:"",icon:"el-icon-edit"},on:{click:function(t){return e.handleEditChapter(a)}}})],1),e._v(" "),s("span",[e._v(e._s(t.chapterName))])]),e._v(" "),s("div",[s("el-menu-item",{attrs:{index:a.toString()+"001"}},[s("span",[s("el-button",{staticStyle:{color:"#fff"},attrs:{type:"text"},on:{click:function(t){return e.handleAddPoint(a)}}},[e._v("添加知识点")])],1)]),e._v(" "),e._l(t.points,function(r,i){return s("div",{key:10*a+i},[!1===r.edit?s("el-row",{staticClass:"vertical-middle"},[s("el-col",{attrs:{span:4}},[s("el-button",{staticStyle:{color:"#fff"},attrs:{type:"text",size:"mini",circle:"",icon:"el-icon-remove-outline"},on:{click:function(s){return e.deletePoint(t,i)}}})],1),e._v(" "),s("el-col",{attrs:{span:16}},[s("router-link",{staticClass:"router-link-active",attrs:{to:{name:"pointEdit",query:{item:r}}}},[s("el-menu-item",{attrs:{index:a.toString()+i}},[s("div",{staticClass:"point-name"},[e._v(e._s(r.name))])])],1)],1),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-button",{staticStyle:{color:"#fff"},attrs:{type:"text",size:"mini",circle:"",icon:"el-icon-edit"},on:{click:function(t){return e.handleEditPoint(r)}}})],1)],1):s("el-row",{staticClass:"vertical-middle",staticStyle:{height:"50px"}},[s("el-col",{attrs:{span:3,align:"start"}},[s("el-button",{staticStyle:{color:"#fff","margin-left":"3px"},attrs:{type:"text",size:"mini",circle:"",icon:"el-icon-circle-close-outline"},on:{click:function(s){return e.cancelEdit(t,i,r)}}})],1),e._v(" "),s("el-col",{attrs:{span:5}},[s("el-input",{staticStyle:{width:"100%"},attrs:{size:"small",type:"number"},model:{value:e.newPoint.order,callback:function(t){e.$set(e.newPoint,"order",t)},expression:"newPoint.order"}})],1),e._v(" "),s("el-col",{attrs:{span:13}},[s("el-input",{staticStyle:{width:"90%"},attrs:{size:"small"},model:{value:e.newPoint.name,callback:function(t){e.$set(e.newPoint,"name",t)},expression:"newPoint.name"}})],1),e._v(" "),s("el-col",{attrs:{span:3,align:"start"}},[s("el-button",{staticStyle:{color:"#fff"},attrs:{type:"text",size:"mini",icon:"el-icon-circle-check"},on:{click:function(s){return e.submitEdit(t,r,i)}}})],1)],1)],1)}),e._v(" "),s("router-link",{staticClass:"router-link-active",attrs:{to:{name:"preExerciseEdit",query:{id:t.id,courseID:e.courseID}}}},[s("el-menu-item",{attrs:{index:"pre"+a.toString()}},[e._v("课前摸底习题")])],1),e._v(" "),s("router-link",{staticClass:"router-link-active",attrs:{to:{name:"revExerciseEdit",query:{id:t.id,courseID:e.courseID}}}},[s("el-menu-item",{attrs:{index:"rev"+a.toString()}},[e._v("课后习题")])],1),e._v(" "),s("el-menu-item",{attrs:{index:a.toString()+"100"}},[s("span",[s("el-button",{staticStyle:{color:"#fff"},attrs:{type:"text"},on:{click:function(t){return e.deleteChapter(a)}}},[e._v("删除本章")])],1)])],2)],2)}),1),e._v(" "),s("div",{staticClass:"exit"},[s("span",[s("el-button",{staticStyle:{"background-color":"#545c64","border-color":"#545c64",width:"100%"},attrs:{type:"primary"},on:{click:e.goBack}},[s("i",{staticClass:"el-icon-arrow-left",staticStyle:{"margin-right":"6px"}}),e._v("退出编辑\n          ")])],1)])],1)],1),e._v(" "),s("el-main",[s("el-scrollbar",{attrs:{"wrap-style":"height: calc(100vh - 150px)",native:!1}},[s("router-view",{staticClass:"router-view"})],1),e._v(" "),s("el-dialog",{staticStyle:{height:"750px"},attrs:{visible:e.updateChapterVisible,width:"700px",center:!0},on:{"update:visible":function(t){e.updateChapterVisible=t},close:e.handleChapterClose}},[s("el-form",{ref:"chapterForm",staticStyle:{padding:"15px 50px 15px 50px"},attrs:{model:e.chapterForm,"status-icon":"",rules:e.chapterRules,"label-width":"100px","label-position":"top",align:"start"}},[s("el-form-item",{attrs:{label:"章节号",prop:"order"}},[s("el-input",{staticStyle:{width:"100px"},attrs:{size:"small",type:"number"},model:{value:e.chapterForm.order,callback:function(t){e.$set(e.chapterForm,"order",t)},expression:"chapterForm.order"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"章节名",prop:"name"}},[s("el-input",{staticStyle:{width:"200px"},attrs:{size:"small"},model:{value:e.chapterForm.name,callback:function(t){e.$set(e.chapterForm,"name",t)},expression:"chapterForm.name"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"前继章节",prop:"predecessor"}},[s("el-transfer",{attrs:{data:e.chapterData,titles:["无关章节","前继章节"]},model:{value:e.chapterForm.predecessor,callback:function(t){e.$set(e.chapterForm,"predecessor",t)},expression:"chapterForm.predecessor"}})],1),e._v(" "),s("el-form-item",{attrs:{align:"center"}},[s("el-button",{attrs:{type:"primary",size:"small",loading:e.submitLoading},on:{click:function(t){return e.confirmEdit()}}},[e._v("提交")]),e._v(" "),s("el-button",{attrs:{size:"small"},on:{click:function(t){return e.resetEdit()}}},[e._v("重置")])],1)],1)],1),e._v(" "),s("el-dialog",{attrs:{visible:e.importChapterVisible,width:"400px",center:!0,title:"历史记录"},on:{"update:visible":function(t){e.importChapterVisible=t},close:e.handleImportChapterClose}},[s("el-row",{attrs:{type:"flex",justify:"center"}},[s("el-select",{attrs:{size:"small"},model:{value:e.importSettings,callback:function(t){e.importSettings=t},expression:"importSettings"}},e._l(e.importData,function(e){return s("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})}),1)],1),e._v(" "),s("el-row",{staticStyle:{"margin-top":"15px"},attrs:{type:"flex",justify:"center"}},[s("el-button",{attrs:{type:"primary",size:"small",loading:e.importLoading},on:{click:function(t){return e.confirmImport()}}},[e._v("提交")])],1)],1)],1)],1)},staticRenderFns:[]};var ee=s("VU/8")(K,Q,!1,function(e){s("1q2Z"),s("/LVn")},"data-v-4b7dd1f6",null).exports,te=s("sYY+"),se=s.n(te),ae={name:"chapterEdit",data:function(){return{item:0,pointName:"",pointContent:"",editor:new se.a("#editor"),pointForm:{title:"",content:""},pointRules:{title:[{required:!0,message:"请输入标题",trigger:"blur"}],content:[{required:!0,message:"请输入知识点内容",trigger:"blur"}]},loading:!1}},methods:{getParams:function(){this.item=this.$route.query.item},getContents:function(){var e=this;this.pointName="",this.pointContent="",this.pointForm={title:"",content:""},this.$http.get("http://10.60.38.173:8765/getChapterByID?chapterID="+this.item.id,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200===t.status){var s=JSON.parse(t.bodyText);1===s.state&&(e.pointName=s.data.contentName,e.pointContent=s.data.content,e.pointForm.title=e.pointName,e.pointForm.content=e.pointContent,null!==s.data.content?e.editor.txt.html(s.data.content):e.editor.txt.html(""))}else e.$message({type:"error",message:"加载失败!"})},function(t){e.$message({type:"error",message:"加载失败!"})})},reset:function(){this.pointForm.title=this.pointName,this.pointForm.content=this.pointContent},save:function(){var e=this;this.loading=!0,this.$http.post("http://10.60.38.173:8765/alertChapter",{id:this.item.id,courseID:this.item.courseID,contentName:this.pointForm.title,parentID:this.item.parentID,siblingID:this.item.siblingID,content:this.pointForm.content},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){200===t.status?(e.editor.txt.html(""),e.getContents(),n.$emit("reloadCatalog",!0),e.loading=!1,e.$message({type:"success",message:"更新成功!"})):(e.loading=!1,e.$message({type:"error",message:"更新失败!"}))},function(t){e.loading=!1,e.$message({type:"error",message:"更新失败!"})})}},created:function(){this.getParams(),this.getContents()},mounted:function(){var e=this;this.editor.customConfig.menus=["bold","fontSize","fontName","italic","underline","foreColor","link","quote","list","justify","quote","image","code","table","undo","redo"],this.editor.customConfig.onchange=function(){e.pointForm.content=e.editor.txt.html()},this.editor.customConfig.debug=location.href.indexOf("wangeditor_debug_mode=1")>0,this.editor.customConfig.zIndex=10,this.editor.create()},watch:{$route:function(e){this.getParams(),this.getContents()}},beforeRouteUpdate:function(e,t,s){if(this.item.name!==this.pointForm.title||this.item.content!==this.pointForm.content)return window.confirm("更改尚未保存，确认离开吗？")?void s():void s(!1);s()},beforeRouteLeave:function(e,t,s){if(this.item.name!==this.pointForm.title||this.item.content!==this.pointForm.content)return window.confirm("更改尚未保存，确认离开吗？")?void s():void s(!1);s()}},re={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-container",[s("div",[s("el-form",{ref:"pointForm",staticStyle:{width:"700px",margin:"0 auto"},attrs:{model:e.pointForm,"status-icon":"",rules:e.pointRules,"label-width":"100px","label-position":"top",align:"start"}},[s("el-form-item",{attrs:{label:"标题",prop:"title"}},[s("el-input",{model:{value:e.pointForm.title,callback:function(t){e.$set(e.pointForm,"title",t)},expression:"pointForm.title"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"内容",prop:"content"}},[s("div",{attrs:{id:"editor"}})]),e._v(" "),s("el-form-item",{attrs:{align:"center"}},[s("el-button",{attrs:{type:"primary",size:"small",loading:e.loading},on:{click:e.save}},[e._v("保存")]),e._v(" "),s("el-button",{attrs:{size:"small"},on:{click:e.reset}},[e._v("重置")])],1)],1)],1)])},staticRenderFns:[]};var ie=s("VU/8")(ae,re,!1,function(e){s("066F")},"data-v-14ba4260",null).exports,oe={name:"preExerciseEdit",data:function(){return{id:0,chapterInfo:{},courseID:0,teacherID:202,exercises:[{exerciseID:100,question:"这里是题目内容",options:[],score:30,type:1,answer:[0],detail:"这里是题目解析",order:1,edit:!1,new:!1,edited:!1,delete:!1,cancelDelete:!1,oldOptions:[],longer:!1,shorter:!1}],exerciseNew:{},totalScore:0,importData:[],importSettings:"暂无数据",chapterData:[],chapterSettings:"暂无数据",addButton:!0,funcButton:!1,submitLoading:!1,publishLoading:!1,importLoading:!1,dialogTableVisible:!1,selectHistoryVisible:!1,time:"",startLimit:{disabledDate:function(e){return e.getTime()<Date.now()}}}},methods:{getParams:function(){this.courseID=this.$route.query.courseID,this.id=this.$route.query.id},getChapterInfo:function(){var e=this;this.$http.get("http://10.60.38.173:8765/getChapterByID?chapterID="+this.id,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200===t.status){var s=JSON.parse(t.bodyText);1===s.state&&(e.chapterInfo=s.data,void 0===e.chapterInfo.exerciseDeadline_1&&""===e.chapterInfo.exerciseDeadline_1||(e.time=e.chapterInfo.exerciseDeadline_1))}else e.$message({type:"error",message:"加载失败!"})},function(t){e.$message({type:"error",message:"加载失败!"})})},getPreExercises:function(){var e=this;this.exercises=[],this.totalScore=0,this.$http.get("http://10.60.38.173:8765/question/view?chapterId="+this.id+"&type=preview",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200===t.status){var s=JSON.parse(t.bodyText);if(1===s.state){for(var a=0;a<s.data.length;){e.exercises.push({exerciseID:s.data[a].exercise.exerciseId,question:s.data[a].exercise.exerciseContent,type:s.data[a].exercise.exerciseType,options:[],score:s.data[a].exercise.exercisePoint,answer:[],detail:s.data[a].exercise.exerciseAnalysis,order:s.data[a].exercise.exerciseNumber,edit:!1,new:!1,edited:!1,delete:!1,confirmDelete:!1,oldOptions:[],longer:!1,shorter:!1}),e.totalScore+=Number(s.data[a].exercise.exercisePoint);for(var r=0;r<s.data[a].exercise.exerciseAnswer.length;r++)e.exercises[a].answer.push(s.data[a].exercise.exerciseAnswer.charCodeAt(r)-65);for(var i=0;i<s.data[a].exerciseChoiceList.length;i++)e.exercises[a].options.push({id:s.data[a].exerciseChoiceList[i].id,content:s.data[a].exerciseChoiceList[i].choice}),e.exercises[a].oldOptions.push({id:s.data[a].exerciseChoiceList[i].id,content:s.data[a].exerciseChoiceList[i].choice});a++}e.exercises.sort(e.compare("order"))}}else e.$message({type:"error",message:"加载失败!"})},function(t){e.$message({type:"error",message:"加载失败!"})})},getCourses:function(){var e=this;this.importData=[],this.$http.get("http://10.60.38.173:8765/question/sameCoursesById?courseId="+this.courseID+"&teacherId="+this.teacherID,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200===t.status){var s=JSON.parse(t.bodyText);if(1===s.state)for(var a=0,r=0;a<s.data.length;)Number(s.data[a].courseID)!==Number(e.courseID)&&(e.importData.push({value:r,label:s.data[a].courseYear+s.data[a].courseSemester,id:s.data[a].courseID}),r++),a++;e.importData.length>0&&(e.importSettings=0,e.getChapterID())}else e.$message({type:"error",message:"加载失败!"})},function(t){e.$message({type:"error",message:"加载失败!"})})},getChapterID:function(){var e=this;this.chapterData=[],this.$http.get("http://10.60.38.173:8765/getCourseCatalog?courseID="+this.importData[this.importSettings].id,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200===t.status){var s=JSON.parse(t.bodyText);if(1===s.state){var a=0;for(e.chapterSettings=s.data[a].id;a<s.data.length;)e.chapterData.push({value:s.data[a].id,label:s.data[a].contentName}),a++}}else e.$message({type:"error",message:"加载失败!"})},function(t){e.$message({type:"error",message:"加载失败!"})})},setAnswerClass:function(e,t){return e.answer.indexOf(t)>=0&&!e.delete?"answer":""},handleType:function(){if(1===this.exerciseNew.type)for(var e=1;e<this.exerciseNew.answer.length;e++)this.exerciseNew.answer.splice(e,1)},handleChapter:function(){this.getChapterID()},addOption:function(){this.exerciseNew.options.push({id:"",content:""})},addPreExercise:function(){this.exercises.push({exerciseID:0,question:"",type:1,options:[{id:"",content:""},{id:"",content:""}],score:0,answer:[0],detail:"",order:this.exercises.length+1,edit:!0,new:!0,edited:!1,delete:!1,cancelDelete:!1,oldOptions:[{id:"",content:""},{id:"",content:""}],longer:!1,shorter:!1});var e=this.exercises.length-1;this.exerciseNew=this.objDeepCopy(this.exercises[e]),this.addButton=!1,this.funcButton=!0},deletePreExercise:function(e){var t=this,s=this;this.$confirm("确认删除该题吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.totalScore-=t.exercises[e].score,t.exercises[e].delete=!0,t.exercises[e].new&&(t.exercises[e].new=!1,t.exercises[e].cancelDelete=!0);for(var a=e+1;a<s.exercises.length;a++)s.exercises[a].order--,s.exercises[a].new||(s.exercises[a].edited=!0)}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},cancelDelete:function(e){this.totalScore+=Number(this.exercises[e].score),this.exercises[e].delete=!1,!this.exercises[e].new&&this.exercises[e].cancelDelete&&(this.exercises[e].new=!0,this.exercises[e].cancelDelete=!1);for(var t=e+1;t<this.exercises.length;t++)this.exercises[t].order++},editMode:function(e){this.exercises[e].edit=!0,this.exercises[e].new||(this.exercises[e].edited=!0),this.exerciseNew=this.objDeepCopy(this.exercises[e]),this.addButton=!1,this.funcButton=!0},moveUp:function(e){0!==e?(this.exercises[e].new||(this.exercises[e].edited=!0),this.exercises[e-1].new||(this.exercises[e-1].edited=!0),this.exercises.splice(e-1,0,this.exercises[e]),this.exercises.splice(e+1,1),this.exercises[e].order++,this.exercises[e-1].order--):this.$message({type:"error",message:"此题无法上移"})},moveDown:function(e){e!==this.exercises.length-1?(this.exercises[e].new||(this.exercises[e].edited=!0),this.exercises[e+1].new||(this.exercises[e+1].edited=!0),this.exercises.splice(e+2,0,this.exercises[e]),this.exercises.splice(e,1),this.exercises[e].order--,this.exercises[e+1].order++):this.$message({type:"error",message:"此题无法下移"})},deleteOption:function(e){this.exerciseNew.options.splice(e,1);var t=this.exerciseNew.answer.length-1;this.exerciseNew.answer[t]>=this.exerciseNew.options.length&&this.exerciseNew.answer.splice(t,1)},saveEdit:function(e){for(var t=0;t<this.exerciseNew.options.length;t++)if(""===this.exerciseNew.options[t].content)return void this.$message({message:"请将习题内容填写完整！",type:"warning"});if(0!==this.exerciseNew.answer.length)if(""!==this.exerciseNew.question&&""!==this.exerciseNew.detail)if(Number(this.exerciseNew.score)<=0||Number(this.exerciseNew.score)>100)this.$message({message:"分数应在0-100之间！",type:"warning"});else{var s=this.totalScore;s-=this.exercises[e].score,(s+=Number(this.exerciseNew.score))>100?this.$message({message:"总分超出最大值，请调整分数！",type:"warning"}):(this.totalScore-=Number(this.exercises[e].score),this.exercises[e]=this.objDeepCopy(this.exerciseNew),this.exercises[e].edit=!1,this.exercises[e].options.length<=this.exercises[e].oldOptions.length?(this.exercises[e].shorter=!0,this.exercises[e].longer=!1):(this.exercises[e].shorter=!1,this.exercises[e].longer=!0),this.exerciseNew={},this.totalScore+=Number(this.exercises[e].score),this.addButton=!0,this.funcButton=!1)}else this.$message({message:"请将习题内容填写完整！",type:"warning"});else this.$message({message:"请设置答案！",type:"warning"})},resetEdit:function(e){this.exerciseNew=this.objDeepCopy(this.exercises[e])},cancelEdit:function(e){this.exercises[e].edit=!1,this.exerciseNew={},this.exercises[e].new&&this.exercises.splice(e,1),this.addButton=!0,this.funcButton=!1},saveAddOption:function(e,t){var s=this,a={exerciseId:this.exercises[e].exerciseID,exerciceChoiceId:String.fromCharCode(t+65),choice:this.exercises[e].options[t].content};this.$http.post("http://10.60.38.173:8765/question/addChoice",a,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){return 200===e.status?e:(s.$message({type:"error",message:"选项添加失败!"}),null)},function(e){return s.$message({type:"error",message:"选项添加失败!"}),null})},saveDeleteOption:function(e,t){var s=this;this.$http.put("http://10.60.38.173:8765/question/deleteChoice",{exerciseChoiceId:this.exercises[e].oldOptions[t].id},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){return 200===e.status?e:(s.$message({type:"error",message:"选项删除失败!"}),null)},function(e){return s.$message({type:"error",message:"选项删除失败!"}),null})},saveAlterOption:function(e,t){var s=this,a={id:this.exercises[e].options[t].id,exerciseId:this.exercises[e].exerciseID,exerciceChoiceId:String.fromCharCode(t+65),choice:this.exercises[e].options[t].content};this.$http.post("http://10.60.38.173:8765/question/alterChoice",a,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){200===e.status||s.$message({type:"error",message:"选项修改失败!"})},function(e){s.$message({type:"error",message:"选项修改失败!"})})},saveAddPreExercise:function(e){for(var t=this,s="",a=0;a<this.exercises[e].answer.length;a++)s+=String.fromCharCode(this.exercises[e].answer[a]+65);var r={chapterId:this.id,exerciseType:this.exercises[e].type,exerciseNumber:this.exercises[e].order,exerciseContent:this.exercises[e].question,exerciseAnswer:s,exerciseAnalysis:this.exercises[e].detail,exercisePoint:this.exercises[e].score};this.$http.post("http://10.60.38.173:8765/question/addExercise",r,{headers:{Authorization:"Bearer "+localStorage.getItem("token"),"Content-Type":"application/json"}}).then(function(s){if(200===s.status){var a=JSON.parse(s.bodyText);t.exercises[e].exerciseID=a.data.exerciseId;for(var r=0;r<t.exercises[e].options.length;)t.saveAddOption(e,r),r+=1}else t.$message({type:"error",message:"习题添加失败!"})},function(e){t.$message({type:"error",message:"习题添加失败!"})})},saveDeletePreExercise:function(e){var t=this;this.$http.put("http://10.60.38.173:8765/question/deleteExercise",{exerciseId:this.exercises[e].exerciseID},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(s){if(200===s.status)for(var a=0;a<t.exercises[e].options.length;a++)t.saveDeleteOption(e,a);else t.$message({type:"error",message:"习题删除失败!"})},function(e){t.$message({type:"error",message:"习题删除失败!"})})},saveAlterPreExercise:function(e){for(var t=this,s="",a=0;a<this.exercises[e].answer.length;a++)s+=String.fromCharCode(this.exercises[e].answer[a]+65);var r={exerciseId:this.exercises[e].exerciseID,chapterId:this.id,exerciseType:this.exercises[e].type,exerciseNumber:this.exercises[e].order,exerciseContent:this.exercises[e].question,exerciseAnswer:s,exerciseAnalysis:this.exercises[e].detail,exercisePoint:this.exercises[e].score};this.$http.post("http://10.60.38.173:8765/question/alterExercise",r,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){200===e.status||t.$message({type:"error",message:"习题编辑失败!"})},function(e){t.$message({type:"error",message:"习题编辑失败!"})})},submitPreview:function(){this.submitLoading=!0;for(var e=0;e<this.exercises.length;e++)if(!this.exercises[e].delete||this.exercises[e].cancelDelete)if(this.exercises[e].new)this.saveAddPreExercise(e);else if(this.exercises[e].edited){this.saveAlterPreExercise(e);var t=0;if(this.exercises[e].longer){for(;t<this.exercises[e].oldOptions.length;)this.saveAlterOption(e,t),t+=1;for(;t<this.exercises[e].options.length;)this.saveAddOption(e,t),t+=1}else if(this.exercises[e].shorter){for(;t<this.exercises[e].options.length;)this.saveAlterOption(e,t),t+=1;for(;t<this.exercises[e].oldOptions.length;)this.saveDeleteOption(e,t),t+=1}}else;else this.saveDeletePreExercise(e);var s=this;setTimeout(function(){s.getPreExercises(),s.submitLoading=!1,s.$message({type:"success",message:"习题编辑成功!"})},2e3)},publish:function(){for(var e=this,t=0;t<this.exercises.length;t++)if(this.exercises[t].new||this.exercises[t].edited||this.exercises[t].edit||this.exercises[t].delete)return void this.$message({type:"error",message:"请先保存习题!"});this.publishLoading=!0;var s="";s="string"!=typeof this.time?this.time.Format("yyyy-MM-dd").toString():this.time;var a={};a=null===this.chapterInfo.exerciseVisible_2?{id:this.chapterInfo.id,courseID:this.chapterInfo.courseID,contentName:this.chapterInfo.contentName,parentID:this.chapterInfo.parentID,siblingID:this.chapterInfo.siblingID,content:null===this.chapterInfo.content?new String:this.chapterInfo.content,exerciseTitle:this.chapterInfo.contentName+"[课前习题]",exerciseVisible_1:!0,exerciseDeadline_1:s,exerciseTotal_1:Number(this.totalScore)}:{id:this.chapterInfo.id,courseID:this.chapterInfo.courseID,contentName:this.chapterInfo.contentName,parentID:this.chapterInfo.parentID,siblingID:this.chapterInfo.siblingID,content:null===this.chapterInfo.content?new String:this.chapterInfo.content,exerciseTitle:this.chapterInfo.contentName+"[课前习题]",exerciseVisible_1:!0,exerciseVisible_2:this.chapterInfo.exerciseVisible_2,exerciseDeadline_1:s,exerciseDeadline_2:this.chapterInfo.exerciseDeadline_2,exerciseTotal_1:Number(this.totalScore),exerciseTotal_2:this.chapterInfo.exerciseTotal_2},this.$http.post("http://10.60.38.173:8765/alertChapter",a,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200!==t.status)return e.$message({type:"error",message:"习题发布失败!"}),void(e.publishLoading=!1);JSON.parse(t.bodyText);e.$message({type:"success",message:"习题发布成功!"}),e.dialogTableVisible=!1,e.publishLoading=!1},function(t){e.$message({type:"error",message:"习题发布失败!"}),e.publishLoading=!1})},confirmImport:function(){var e=this;"暂无数据"!==this.importSettings&&"暂无数据"!==this.chapterSettings?this.$confirm("之前的习题信息将被覆盖，确认导入吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.importLoading=!0,e.$http.post("http://10.60.38.173:8765/question/copyExercise",{sourceChapterId:e.chapterSettings,aimChapterId:e.id,type:"review"},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200!==t.status)return e.$message({type:"error",message:"习题导入失败!"}),void(e.importLoading=!1);e.$message({type:"success",message:"习题导入成功!"}),e.getPreExercises(),e.importLoading=!1,e.selectHistoryVisible=!1},function(t){e.$message({type:"error",message:"习题导入失败!"}),e.importLoading=!1})}).catch(function(){}):this.$message({type:"warning",message:"无法导入习题信息!"})},objDeepCopy:function(e){var t=e instanceof Array?[]:{};for(var s in e)e.hasOwnProperty(s)&&(t[s]="object"===E()(e[s])?this.objDeepCopy(e[s]):e[s]);return t},compare:function(e){return function(t,s){var a=t[e],r=s[e];return r<a?1:r>a?-1:0}}},created:function(){this.getParams(),this.getPreExercises(),this.getChapterInfo(),this.getCourses()},watch:{$route:function(e){this.getParams(),this.getPreExercises(),this.getChapterInfo()}},beforeRouteUpdate:function(e,t,s){for(var a=0;a<this.exercises.length;a++){if(this.exercises[a].new||this.exercises[a].edited||this.exercises[a].edit||this.exercises[a].delete)return window.confirm("更改尚未保存，确认离开吗？")?void s():void s(!1)}s()},beforeRouteLeave:function(e,t,s){for(var a=0;a<this.exercises.length;a++){if(this.exercises[a].new||this.exercises[a].edited||this.exercises[a].edit||this.exercises[a].delete)return window.confirm("更改尚未保存，确认离开吗？")?void s():void s(!1)}s()}},ne={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-container",[s("div",{staticClass:"main",attrs:{align:"start"}},[s("el-dialog",{attrs:{title:"请选择截止时间",visible:e.dialogTableVisible},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[s("div",{attrs:{align:"center"}},[s("el-date-picker",{attrs:{type:"date",size:"small","picker-options":e.startLimit},model:{value:e.time,callback:function(t){e.time=t},expression:"time"}}),e._v(" "),s("el-button",{staticClass:"confirm-button",attrs:{loading:e.publishLoading,type:"primary",size:"small"},on:{click:e.publish}},[e._v("确认")])],1)]),e._v(" "),s("el-dialog",{attrs:{title:"请选择习题",visible:e.selectHistoryVisible},on:{"update:visible":function(t){e.selectHistoryVisible=t}}},[s("el-row",{attrs:{type:"flex",justify:"center"}},[s("el-select",{attrs:{size:"small"},on:{change:e.handleChapter},model:{value:e.importSettings,callback:function(t){e.importSettings=t},expression:"importSettings"}},e._l(e.importData,function(e){return s("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})}),1)],1),e._v(" "),s("el-row",{staticStyle:{"margin-top":"10px"},attrs:{type:"flex",justify:"center"}},[s("el-select",{attrs:{size:"small"},model:{value:e.chapterSettings,callback:function(t){e.chapterSettings=t},expression:"chapterSettings"}},e._l(e.chapterData,function(e){return s("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})}),1)],1),e._v(" "),s("el-row",{staticStyle:{"margin-top":"15px"},attrs:{type:"flex",justify:"center"}},[s("el-button",{attrs:{type:"primary",size:"small",loading:e.importLoading},on:{click:function(t){return e.confirmImport()}}},[e._v("提交")])],1)],1),e._v(" "),s("h4",[e._v("客观题("+e._s(e.totalScore)+"分)")]),e._v(" "),e._l(e.exercises,function(t,a){return s("div",{key:a,staticClass:"exercises",attrs:{align:"start"}},[!1===t.edit?s("div",{class:t.delete?"is-deleted":""},[s("div",{staticStyle:{"margin-top":"8px"}},[s("span",{staticStyle:{"font-size":"15px"}},[e._v(e._s(t.order)+". "+e._s(t.question)+"（"+e._s(t.score)+"分）")])]),e._v(" "),s("div",{staticClass:"betweenspace",staticStyle:{"margin-top":"15px",padding:"0 10px 0 10px","font-size":"14px"}},e._l(t.options,function(a,r){return s("div",{key:r},[s("div",{class:e.setAnswerClass(t,r)},[e._v(e._s(String.fromCharCode(r+65))+"."+e._s(a.content))])])}),0),e._v(" "),s("div",{staticClass:"detail"},[e._v(e._s(t.detail))]),e._v(" "),t.delete?s("div",{staticStyle:{"margin-top":"10px"}},[s("span",[s("el-button",{attrs:{size:"mini",type:"success",round:""},on:{click:function(t){return e.cancelDelete(a)}}},[e._v("恢复")])],1)]):s("div",{staticStyle:{"margin-top":"15px"}},[s("span",[s("el-button",{staticClass:"edit-button",attrs:{size:"mini",type:"warning",round:"",plain:""},on:{click:function(t){return e.editMode(a)}}},[e._v("编辑")])],1),e._v(" "),s("span",[s("el-button",{staticClass:"edit-button",attrs:{size:"mini",type:"warning",round:"",plain:""},on:{click:function(t){return e.deletePreExercise(a)}}},[e._v("删除")])],1),e._v(" "),s("span",[s("el-button",{staticClass:"edit-button",attrs:{size:"mini",type:"warning",round:"",plain:""},on:{click:function(t){return e.moveUp(a)}}},[e._v("上移")])],1),e._v(" "),s("span",[s("el-button",{staticClass:"edit-button",attrs:{size:"mini",type:"warning",round:"",plain:""},on:{click:function(t){return e.moveDown(a)}}},[e._v("下移")])],1)])]):s("div",{staticStyle:{"margin-bottom":"20px"}},[s("div",{staticStyle:{"margin-top":"8px"}},[s("p",{staticStyle:{"margin-left":"5px"}},[e._v(e._s(t.order)+".")]),e._v(" "),s("p",[s("el-input",{attrs:{type:"textarea",autosize:{minRows:8,maxRows:8},placeholder:"题目内容"},model:{value:e.exerciseNew.question,callback:function(t){e.$set(e.exerciseNew,"question",t)},expression:"exerciseNew.question"}})],1),e._v(" "),s("el-row",{staticStyle:{"margin-top":"20px"}},[s("el-col",{staticStyle:{"padding-top":"5px"},attrs:{span:3}},[s("el-radio",{attrs:{label:1},on:{change:e.handleType},model:{value:e.exerciseNew.type,callback:function(t){e.$set(e.exerciseNew,"type",t)},expression:"exerciseNew.type"}},[e._v("单选题")])],1),e._v(" "),s("el-col",{staticStyle:{"padding-top":"5px"},attrs:{span:3}},[s("el-radio",{attrs:{label:2},on:{change:e.handleType},model:{value:e.exerciseNew.type,callback:function(t){e.$set(e.exerciseNew,"type",t)},expression:"exerciseNew.type"}},[e._v("多选题")])],1),e._v(" "),s("el-col",{attrs:{span:18,align:"right"}},[s("div",[s("span",[e._v("分值")]),e._v(" "),s("span",{staticStyle:{"margin-left":"5px"}},[s("el-input",{staticStyle:{width:"80px"},attrs:{size:"mini",type:"number"},model:{value:e.exerciseNew.score,callback:function(t){e.$set(e.exerciseNew,"score",t)},expression:"exerciseNew.score"}})],1)])])],1)],1),e._v(" "),s("div",{staticClass:"betweenspace",staticStyle:{"margin-top":"15px"}},e._l(e.exerciseNew.options,function(t,a){return s("div",{key:a,staticStyle:{"margin-top":"10px"}},[s("span",[e._v(e._s(String.fromCharCode(a+65))+".")]),e._v(" "),s("span",[s("el-input",{staticStyle:{width:"280px"},attrs:{size:"mini",placeholder:"请填写选项"},model:{value:e.exerciseNew.options[a].content,callback:function(t){e.$set(e.exerciseNew.options[a],"content",t)},expression:"exerciseNew.options[j].content"}})],1),e._v(" "),s("span",[s("el-button",{attrs:{type:"text"},on:{click:function(t){return e.deleteOption(a)}}},[s("i",{staticClass:"el-icon-circle-close"})])],1)])}),0),e._v(" "),s("div",{staticStyle:{"margin-top":"15px"}},[s("el-button",{attrs:{size:"small",round:""},on:{click:function(t){return e.addOption()}}},[s("i",{staticClass:"el-icon-circle-plus-outline",staticStyle:{"margin-right":"6px"}}),e._v("添加选项\n          ")])],1),e._v(" "),s("div",{staticStyle:{"margin-top":"15px"}},[s("p",[e._v("答案")]),e._v(" "),1===e.exerciseNew.type?s("p",{staticStyle:{"margin-top":"10px"}},[s("el-radio-group",{model:{value:e.exerciseNew.answer[0],callback:function(t){e.$set(e.exerciseNew.answer,0,t)},expression:"exerciseNew.answer[0]"}},e._l(e.exerciseNew.options.length,function(t){return s("el-radio",{key:t,attrs:{value:t-1,label:t-1}},[e._v(e._s(String.fromCharCode(t+64)))])}),1)],1):s("p",{staticStyle:{"margin-top":"10px"}},[s("el-checkbox-group",{model:{value:e.exerciseNew.answer,callback:function(t){e.$set(e.exerciseNew,"answer",t)},expression:"exerciseNew.answer"}},e._l(e.exerciseNew.options.length,function(t){return s("el-checkbox",{key:t,attrs:{value:t-1,label:t-1}},[e._v(e._s(String.fromCharCode(t+64)))])}),1)],1)]),e._v(" "),s("div",{staticStyle:{"margin-top":"15px"}},[s("p",[e._v("解析")]),e._v(" "),s("el-input",{attrs:{type:"textarea",autosize:{minRows:8,maxRows:8},placeholder:"请输入题目解析"},model:{value:e.exerciseNew.detail,callback:function(t){e.$set(e.exerciseNew,"detail",t)},expression:"exerciseNew.detail"}})],1),e._v(" "),s("div",{staticStyle:{"margin-top":"20px"}},[s("el-button",{attrs:{size:"mini",type:"primary",round:"",plain:""},on:{click:function(t){return e.saveEdit(a)}}},[e._v("确认")]),e._v(" "),s("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"mini",type:"primary",round:"",plain:""},on:{click:function(t){return e.resetEdit(a)}}},[e._v("重置")]),e._v(" "),s("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"mini",type:"primary",round:"",plain:""},on:{click:function(t){return e.cancelEdit(a)}}},[e._v("取消")])],1)])])}),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.addButton,expression:"addButton"}]},[s("el-button",{staticStyle:{"margin-top":"20px"},attrs:{type:"warning",plain:"",size:"small",round:""},on:{click:e.addPreExercise}},[s("i",{staticClass:"el-icon-circle-plus-outline",staticStyle:{"margin-right":"6px"}}),e._v("添加客观题\n      ")])],1),e._v(" "),s("div",{staticStyle:{"margin-top":"20px"},attrs:{align:"center"}},[s("el-button",{staticClass:"edit-button",attrs:{type:"success",plain:"",size:"small"},on:{click:function(t){e.selectHistoryVisible=!0}}},[e._v("导入")]),e._v(" "),s("el-button",{staticClass:"edit-button",attrs:{type:"success",plain:"",loading:e.submitLoading,disabled:e.funcButton,size:"small"},on:{click:e.submitPreview}},[e._v("保存")]),e._v(" "),s("el-button",{attrs:{type:"success",disabled:e.funcButton,size:"small"},on:{click:function(t){e.dialogTableVisible=!0}}},[e._v("发布")]),e._v(" "),s("el-button",{attrs:{disabled:e.funcButton,type:"info",size:"small"},on:{click:e.getPreExercises}},[e._v("重置")])],1)],2)])},staticRenderFns:[]};var le=s("VU/8")(oe,ne,!1,function(e){s("ndgP")},"data-v-cf88cf7a",null).exports,ce={name:"revExerciseEdit",data:function(){return{id:0,chapterInfo:{},courseID:0,teacherID:202,exercisesObj:[{exerciseID:0,question:"这里是题目内容",options:["选项A","选项B","选项C","选项D"],score:20,answer:[0],type:4,detail:"这里是题目解析",order:1,edit:!1,new:!1,edited:!1,delete:!1,cancelDelete:!1,oldOptions:[],longer:!1,shorter:!1}],exercisesSub:[{exerciseID:0,question:"这里是题目内容",type:6,score:40,answer:"这里是题目答案",detail:"这里是题目解析",order:1,edit:!1,new:!1,edited:!1,delete:!1,cancelDelete:!1}],subjectNew:{},objectNew:{},importData:[],importSettings:"暂无数据",chapterData:[],chapterSettings:"暂无数据",totalObject:0,totalSubject:0,objectButton:!0,subjectButton:!0,time:"",dialogTableVisible:!1,funcButton:!1,submitLoading:!1,importLoading:!1,publishLoading:!1,selectHistoryVisible:!1,startLimit:{disabledDate:function(e){return e.getTime()<Date.now()}}}},methods:{getParams:function(){this.courseID=this.$route.query.courseID,this.id=this.$route.query.id},getChapterInfo:function(){var e=this;this.$http.get("http://10.60.38.173:8765/getChapterByID?chapterID="+this.id,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200===t.status){var s=JSON.parse(t.bodyText);1===s.state&&(e.chapterInfo=s.data,void 0===e.chapterInfo.exerciseDeadline_2&&""===e.chapterInfo.exerciseDeadline_2||(e.time=e.chapterInfo.exerciseDeadline_2))}else e.$message({type:"error",message:"加载失败!"})},function(t){e.$message({type:"error",message:"加载失败!"})})},getRevExercises:function(){var e=this;this.exercisesObj=[],this.exercisesSub=[],this.totalObject=0,this.totalSubject=0,this.$http.get("http://10.60.38.173:8765/question/view?chapterId="+this.id+"&type=review",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200===t.status){var s=JSON.parse(t.bodyText);if(1===s.state){for(var a=0;a<s.data.length;){if(4===s.data[a].exercise.exerciseType||5===s.data[a].exercise.exerciseType){e.exercisesObj.push({exerciseID:s.data[a].exercise.exerciseId,question:s.data[a].exercise.exerciseContent,type:s.data[a].exercise.exerciseType,options:[],score:s.data[a].exercise.exercisePoint,answer:[],detail:s.data[a].exercise.exerciseAnalysis,order:s.data[a].exercise.exerciseNumber,edit:!1,new:!1,edited:!1,delete:!1,confirmDelete:!1,oldOptions:[],longer:!1,shorter:!1}),e.totalObject+=Number(s.data[a].exercise.exercisePoint);for(var r=0;r<s.data[a].exercise.exerciseAnswer.length;r++)e.exercisesObj[a].answer.push(s.data[a].exercise.exerciseAnswer.charCodeAt(r)-65);for(var i=0;i<s.data[a].exerciseChoiceList.length;i++)e.exercisesObj[a].options.push({id:s.data[a].exerciseChoiceList[i].id,content:s.data[a].exerciseChoiceList[i].choice}),e.exercisesObj[a].oldOptions.push({id:s.data[a].exerciseChoiceList[i].id,content:s.data[a].exerciseChoiceList[i].choice});e.exercisesObj.sort(e.compare("order"))}else 6===s.data[a].exercise.exerciseType&&(e.exercisesSub.push({exerciseID:s.data[a].exercise.exerciseId,question:s.data[a].exercise.exerciseContent,type:s.data[a].exercise.exerciseType,score:s.data[a].exercise.exercisePoint,answer:s.data[a].exercise.exerciseAnswer,detail:s.data[a].exercise.exerciseAnalysis,order:s.data[a].exercise.exerciseNumber,edit:!1,new:!1,edited:!1,delete:!1,cancelDelete:!1}),e.totalSubject+=Number(s.data[a].exercise.exercisePoint));a++}e.exercisesSub.sort(e.compare("order"))}}else e.$message({type:"error",message:"加载失败!"})},function(t){e.$message({type:"error",message:"加载失败!"})})},getCourses:function(){var e=this;this.importData=[],this.$http.get("http://10.60.38.173:8765/question/sameCoursesById?courseId="+this.courseID+"&teacherId="+this.teacherID,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200===t.status){var s=JSON.parse(t.bodyText);if(1===s.state)for(var a=0,r=0;a<s.data.length;)Number(s.data[a].courseID)!==Number(e.courseID)&&(e.importData.push({value:r,label:s.data[a].courseYear+s.data[a].courseSemester,id:s.data[a].courseID}),r++),a++;e.importData.length>0&&(e.importSettings=0,e.getChapterID())}else e.$message({type:"error",message:"加载失败!"})},function(t){e.$message({type:"error",message:"加载失败!"})})},getChapterID:function(){var e=this;this.chapterData=[],this.$http.get("http://10.60.38.173:8765/getCourseCatalog?courseID="+this.importData[this.importSettings].id,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200===t.status){var s=JSON.parse(t.bodyText);if(1===s.state){var a=0;for(e.chapterSettings=s.data[a].id;a<s.data.length;)e.chapterData.push({value:s.data[a].id,label:s.data[a].contentName}),a++}}else e.$message({type:"error",message:"加载失败!"})},function(t){e.$message({type:"error",message:"加载失败!"})})},setAnswerClass:function(e,t){return e.answer.indexOf(t)>=0&&!e.delete?"answer":""},handleType:function(){if(4===this.objectNew.type)for(var e=1;e<this.objectNew.answer.length;e++)this.objectNew.answer.splice(e,1)},handleChapter:function(){this.getChapterID()},addRevOptions:function(){this.objectNew.options.push({id:"",content:""})},deleteObjOption:function(e){this.objectNew.options.splice(e,1);var t=this.objectNew.answer.length-1;this.objectNew.answer[t]>=this.objectNew.options.length&&this.objectNew.answer.splice(t,1)},deleteObject:function(e){var t=this,s=this;this.$confirm("确认删除该题吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.totalObject-=t.exercisesObj[e].score,t.exercisesObj[e].delete=!0,t.exercisesObj[e].new&&(t.exercisesObj[e].new=!1,t.exercisesObj[e].cancelDelete=!0);for(var a=e+1;a<s.exercisesObj.length;a++)s.exercisesObj[a].order--,s.exercisesObj[a].new||(s.exercisesObj[a].edited=!0)}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},cancelDeleteObject:function(e){this.totalObject+=Number(this.exercisesObj[e].score),this.exercisesObj[e].delete=!1,!this.exercisesObj[e].new&&this.exercisesObj[e].cancelDelete&&(this.exercisesObj[e].new=!0,this.exercisesObj[e].cancelDelete=!1);for(var t=e+1;t<this.exercisesObj.length;t++)this.exercisesObj[t].order++},moveObjUp:function(e){0!==e?(this.exercisesObj[e].new||(this.exercisesObj[e].edited=!0),this.exercisesObj[e-1].new||(this.exercisesObj[e-1].edited=!0),this.exercisesObj.splice(e-1,0,this.exercisesObj[e]),this.exercisesObj.splice(e+1,1),this.exercisesObj[e].order++,this.exercisesObj[e-1].order--):this.$message({type:"error",message:"此题无法上移"})},moveObjDown:function(e){e!==this.exercisesObj.length-1?(this.exercisesObj[e].new||(this.exercisesObj[e].edited=!0),this.exercisesObj[e+1].new||(this.exercisesObj[e+1].edited=!0),this.exercisesObj.splice(e+2,0,this.exercisesObj[e]),this.exercisesObj.splice(e,1),this.exercisesObj[e].order--,this.exercisesObj[e+1].order++):this.$message({type:"error",message:"此题无法下移"})},addReviewO:function(){this.exercisesObj.push({exerciseID:0,question:"",type:4,options:[{id:"",content:""},{id:"",content:""}],score:0,answer:[],detail:"",order:this.exercisesObj.length+1,edit:!0,new:!0,edited:!1,delete:!1,cancelDelete:!1,oldOptions:[{id:"",content:""},{id:"",content:""}],longer:!1,shorter:!1});var e=this.exercisesObj.length-1;this.objectNew=this.objDeepCopy(this.exercisesObj[e]),this.objectButton=!1,this.funcButton=!0},editObject:function(e){this.exercisesObj[e].edit=!0,this.objectNew=this.objDeepCopy(this.exercisesObj[e]),this.objectButton=!1,this.funcButton=!0},saveObject:function(e){for(var t=0;t<this.objectNew.options.length;t++)if(""===this.objectNew.options[t].content)return void this.$message({message:"请将习题内容填写完整！",type:"warning"});if(0!==this.objectNew.answer.length)if(""!==this.objectNew.question&&""!==this.objectNew.detail)if(Number(this.objectNew.score)<=0||Number(this.objectNew.score)>100)this.$message({message:"分数应在0-100之间！",type:"warning"});else{var s=this.totalObject;s-=this.exercisesObj[e].score,(s+=Number(this.objectNew.score))>100?this.$message({message:"总分超出最大值，请调整分数！",type:"warning"}):(this.totalObject-=Number(this.exercisesObj[e].score),this.exercisesObj[e]=this.objDeepCopy(this.objectNew),this.exercisesObj[e].edit=!1,this.exercisesObj[e].new||(this.exercisesObj[e].edited=!0),this.exercisesObj[e].options.length<=this.exercisesObj[e].oldOptions.length?(this.exercisesObj[e].shorter=!0,this.exercisesObj[e].longer=!1):(this.exercisesObj[e].shorter=!1,this.exercisesObj[e].longer=!0),this.objectNew={},this.totalObject+=Number(this.exercisesObj[e].score),this.objectButton=!0,this.funcButton=!1)}else this.$message({message:"请将习题内容填写完整！",type:"warning"});else this.$message({message:"请设置答案！",type:"warning"})},resetObject:function(e){this.objectNew=this.objDeepCopy(this.exercisesObj[e])},cancelObj:function(e){this.exercisesObj[e].edit=!1,this.objectNew={},this.exercisesObj[e].new&&this.exercisesObj.splice(e,1),this.objectButton=!0,this.funcButton=!1},addReviewS:function(){this.exercisesSub.push({exerciseID:0,question:"",type:6,score:0,answer:"",detail:"",order:this.exercisesSub.length+1,edit:!0,new:!0,edited:!1,delete:!1,cancelDelete:!1});var e=this.exercisesSub.length-1;this.subjectNew=this.objDeepCopy(this.exercisesSub[e]),this.subjectButton=!1,this.funcButton=!0},moveSubUp:function(e){0!==e?(this.exercisesSub[e].new||(this.exercisesSub[e].edited=!0),this.exercisesSub[e-1].new||(this.exercisesSub[e-1].edited=!0),this.exercisesSub.splice(e-1,0,this.exercisesSub[e]),this.exercisesSub.splice(e+1,1),this.exercisesSub[e].order++,this.exercisesSub[e-1].order--):this.$message({type:"error",message:"此题无法上移"})},moveSubDown:function(e){e!==this.exercisesSub.length-1?(this.exercisesSub[e].new||(this.exercisesSub[e].edited=!0),this.exercisesSub[e+1].new||(this.exercisesSub[e+1].edited=!0),this.exercisesSub.splice(e+2,0,this.exercisesSub[e]),this.exercisesSub.splice(e,1),this.exercisesSub[e].order--,this.exercisesSub[e+1].order++):this.$message({type:"error",message:"此题无法下移"})},deleteSubject:function(e){var t=this;this.$confirm("确认删除该题吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.totalSubject-=t.exercisesSub[e].score,t.exercisesSub[e].delete=!0,t.exercisesSub[e].new&&(t.exercisesSub[e].new=!1,t.exercisesSub[e].cancelDelete=!0);for(var s=e+1;s<that.exercisesSub.length;s++)that.exercisesSub[s].order--,that.exercisesSub[s].new||(that.exercisesSub[s].edited=!0)}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},cancelDeleteSubject:function(e){this.totalSubject+=Number(this.exercisesSub[e].score),this.exercisesSub[e].delete=!1,!this.exercisesSub[e].new&&this.exercisesSub[e].cancelDelete&&(this.exercisesSub[e].new=!0,this.exercisesSub[e].cancelDelete=!1);for(var t=e+1;t<this.exercisesSub.length;t++)this.exercisesSub[t].order++},editSubject:function(e){this.exercisesSub[e].edit=!0,this.subjectNew=this.objDeepCopy(this.exercisesSub[e]),this.subjectButton=!1,this.funcButton=!0},saveSubject:function(e){if(""===this.subjectNew.question||""===this.subjectNew.answer||""===this.subjectNew.detail)this.$message({message:"请将习题内容填写完整！",type:"warning"});else{if(Number(this.subjectNew.score)<=0||Number(this.subjectNew.score)>100)return void this.$message({message:"分数应在0-100之间！",type:"warning"});var t=this.totalSubject;if(t-=this.exercisesSub[e].score,t+=Number(this.subjectNew.score),this.totalSubject+t>100)return void this.$message({message:"总分超出最大值，请调整分数！",type:"warning"});this.totalSubject-=Number(this.exercisesSub[e].score),this.exercisesSub[e]=this.objDeepCopy(this.subjectNew),this.exercisesSub[e].edit=!1,this.exercisesSub[e].new||(this.exercisesSub[e].edited=!0),this.subjectNew={},this.totalSubject+=Number(this.exercisesSub[e].score),this.subjectButton=!0,this.funcButton=!1}},resetSubject:function(e){this.subjectNew=this.objDeepCopy(this.exercisesSub[e])},cancelSub:function(e){this.exercisesSub[e].edit=!1,this.subjectNew={},this.exercisesSub[e].new&&this.exercisesSub.splice(e,1),this.subjectButton=!0,this.funcButton=!1},saveAddOption:function(e,t){var s=this,a={exerciseId:this.exercisesObj[e].exerciseID,exerciceChoiceId:String.fromCharCode(t+65),choice:this.exercisesObj[e].options[t].content};this.$http.post("http://10.60.38.173:8765/question/addChoice",a,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){return 200===e.status?e:(s.$message({type:"error",message:"选项添加失败!"}),null)},function(e){return s.$message({type:"error",message:"选项添加失败!"}),null})},saveDeleteOption:function(e,t){var s=this;this.$http.put("http://10.60.38.173:8765/question/deleteChoice",{exerciseChoiceId:this.exercisesObj[e].oldOptions[t].id},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){return 200===e.status?e:(s.$message({type:"error",message:"选项删除失败!"}),null)},function(e){return s.$message({type:"error",message:"选项删除失败!"}),null})},saveAlterOption:function(e,t){var s=this,a={id:this.exercisesObj[e].options[t].id,exerciseId:this.exercisesObj[e].exerciseID,exerciceChoiceId:String.fromCharCode(t+65),choice:this.exercisesObj[e].options[t].content};this.$http.post("http://10.60.38.173:8765/question/alterChoice",a,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){200===e.status||s.$message({type:"error",message:"选项修改失败!"})},function(e){s.$message({type:"error",message:"选项修改失败!"})})},saveAddObjExercise:function(e){for(var t=this,s="",a=0;a<this.exercisesObj[e].answer.length;a++)s+=String.fromCharCode(this.exercisesObj[e].answer[a]+65);var r={chapterId:this.id,exerciseType:this.exercisesObj[e].type,exerciseNumber:this.exercisesObj[e].order,exerciseContent:this.exercisesObj[e].question,exerciseAnswer:s,exerciseAnalysis:this.exercisesObj[e].detail,exercisePoint:this.exercisesObj[e].score};this.$http.post("http://10.60.38.173:8765/question/addExercise",r,{headers:{Authorization:"Bearer "+localStorage.getItem("token"),"Content-Type":"application/json"}}).then(function(s){if(200===s.status){var a=JSON.parse(s.bodyText);t.exercisesObj[e].exerciseID=a.data.exerciseId;for(var r=0;r<t.exercisesObj[e].options.length;)t.saveAddOption(e,r),r+=1}else t.$message({type:"error",message:"习题添加失败!"})},function(e){t.$message({type:"error",message:"习题添加失败!"})})},saveAddSubExercise:function(e){var t=this,s={chapterId:this.id,exerciseType:6,exerciseNumber:this.exercisesSub[e].order,exerciseContent:this.exercisesSub[e].question,exerciseAnswer:this.exercisesSub[e].answer,exerciseAnalysis:this.exercisesSub[e].detail,exercisePoint:this.exercisesSub[e].score};this.$http.post("http://10.60.38.173:8765/question/addExercise",s,{headers:{Authorization:"Bearer "+localStorage.getItem("token"),"Content-Type":"application/json"}}).then(function(e){200===e.status||t.$message({type:"error",message:"习题添加失败!"})},function(e){t.$message({type:"error",message:"习题添加失败!"})})},saveDeleteObjExercise:function(e){var t=this;this.$http.put("http://10.60.38.173:8765/question/deleteExercise",{exerciseId:this.exercisesObj[e].exerciseID},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(s){if(200===s.status)for(var a=0;a<t.exercisesObj[e].options.length;a++)t.saveDeleteOption(e,a);else t.$message({type:"error",message:"习题删除失败!"})},function(e){t.$message({type:"error",message:"习题删除失败!"})})},saveDeleteSubExercise:function(e){var t=this;this.$http.put("http://10.60.38.173:8765/question/deleteExercise",{exerciseId:this.exercisesSub[e].exerciseID},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){200===e.status||t.$message({type:"error",message:"习题删除失败!"})},function(e){t.$message({type:"error",message:"习题删除失败!"})})},saveAlterObjExercise:function(e){for(var t=this,s="",a=0;a<this.exercisesObj[e].answer.length;a++)s+=String.fromCharCode(this.exercisesObj[e].answer[a]+65);var r={exerciseId:this.exercisesObj[e].exerciseID,chapterId:this.id,exerciseType:this.exercisesObj[e].type,exerciseNumber:this.exercisesObj[e].order,exerciseContent:this.exercisesObj[e].question,exerciseAnswer:s,exerciseAnalysis:this.exercisesObj[e].detail,exercisePoint:this.exercisesObj[e].score};this.$http.post("http://10.60.38.173:8765/question/alterExercise",r,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){200===e.status||t.$message({type:"error",message:"习题编辑失败!"})},function(e){t.$message({type:"error",message:"习题编辑失败!"})})},saveAlterSubExercise:function(e){var t=this,s={exerciseId:this.exercisesSub[e].exerciseID,chapterId:this.id,exerciseType:6,exerciseNumber:this.exercisesSub[e].order,exerciseContent:this.exercisesSub[e].question,exerciseAnswer:this.exercisesSub[e].answer,exerciseAnalysis:this.exercisesSub[e].detail,exercisePoint:this.exercisesSub[e].score};this.$http.post("http://10.60.38.173:8765/question/alterExercise",s,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){200===e.status||t.$message({type:"error",message:"习题编辑失败!"})},function(e){t.$message({type:"error",message:"习题编辑失败!"})})},submitReview:function(){this.submitLoading=!0;for(var e=0;e<this.exercisesObj.length;e++)if(!this.exercisesObj[e].delete||this.exercisesObj[e].cancelDelete)if(this.exercisesObj[e].new)this.saveAddObjExercise(e);else if(this.exercisesObj[e].edited){this.saveAlterObjExercise(e);var t=0;if(this.exercisesObj[e].longer){for(;t<this.exercisesObj[e].oldOptions.length;)this.saveAlterOption(e,t),t+=1;for(;t<this.exercisesObj[e].options.length;)this.saveAddOption(e,t),t+=1}else if(this.exercisesObj[e].shorter){for(;t<this.exercisesObj[e].options.length;)this.saveAlterOption(e,t),t+=1;for(;t<this.exercisesObj[e].oldOptions.length;)this.saveDeleteOption(e,t),t+=1}}else;else this.saveDeleteObjExercise(e);for(var s=0;s<this.exercisesSub.length;s++)!this.exercisesSub[s].delete||this.exercisesSub[s].cancelDelete?this.exercisesSub[s].new?this.saveAddSubExercise(s):this.exercisesSub[s].edited&&this.saveAlterSubExercise(s):this.saveDeleteSubExercise(s);var a=this;setTimeout(function(){a.getRevExercises(),a.submitLoading=!1,a.$message({type:"success",message:"习题编辑成功!"})},4e3)},publish:function(){for(var e=this,t=0;t<this.exercisesObj.length;t++)if(this.exercisesObj[t].new||this.exercisesObj[t].edited||this.exercisesObj[t].edit||this.exercisesObj[t].delete)return void this.$message({type:"error",message:"请先保存习题!"});for(var s=0;s<this.exercisesSub.length;s++)if(this.exercisesSub[s].new||this.exercisesSub[s].edited||this.exercisesSub[s].edit||this.exercisesSub[s].delete)return void this.$message({type:"error",message:"请先保存习题!"});this.publishLoading=!0;var a="";a="string"!=typeof this.time?this.time.Format("yyyy-MM-dd").toString():this.time;var r={};r=null===this.chapterInfo.exerciseVisible_1?{id:this.chapterInfo.id,courseID:this.chapterInfo.courseID,contentName:this.chapterInfo.contentName,parentID:this.chapterInfo.parentID,siblingID:this.chapterInfo.siblingID,content:null===this.chapterInfo.content?new String:this.chapterInfo.content,exerciseTitle:this.chapterInfo.contentName+"[课后习题]",exerciseVisible_2:!0,exerciseDeadline_2:a,exerciseTotal_2:Number(this.totalObject+this.totalSubject)}:{id:this.chapterInfo.id,courseID:this.chapterInfo.courseID,contentName:this.chapterInfo.contentName,parentID:this.chapterInfo.parentID,siblingID:this.chapterInfo.siblingID,content:null===this.chapterInfo.content?new String:this.chapterInfo.content,exerciseTitle:this.chapterInfo.contentName+"[课后习题]",exerciseVisible_1:this.chapterInfo.exerciseVisible_1,exerciseVisible_2:!0,exerciseDeadline_1:this.chapterInfo.exerciseDeadline_1,exerciseDeadline_2:a,exerciseTotal_1:this.chapterInfo.exerciseTotal_1,exerciseTotal_2:Number(this.totalObject+this.totalSubject)},this.$http.post("http://10.60.38.173:8765/alertChapter",r,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200!==t.status)return e.$message({type:"error",message:"习题发布失败!"}),e.publishLoading=!1,void(e.dialogTableVisible=!1);JSON.parse(t.bodyText);e.$message({type:"success",message:"习题发布成功!"}),e.publishLoading=!1,e.dialogTableVisible=!1},function(t){e.$message({type:"error",message:"习题发布失败!"}),e.publishLoading=!1,e.dialogTableVisible=!1})},confirmImport:function(){var e=this;"暂无数据"!==this.importSettings&&"暂无数据"!==this.chapterSettings?this.$confirm("之前的习题信息将被覆盖，确认导入吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.importLoading=!0,e.$http.post("http://10.60.38.173:8765/question/copyExercise",{sourceChapterId:e.chapterSettings,aimChapterId:e.id,type:"review"},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200!==t.status)return e.$message({type:"error",message:"习题导入失败!"}),void(e.importLoading=!1);e.$message({type:"success",message:"习题导入成功!"}),e.getRevExercises(),e.importLoading=!1,e.selectHistoryVisible=!1},function(t){e.$message({type:"error",message:"习题导入失败!"}),e.importLoading=!1})}).catch(function(){}):this.$message({type:"warning",message:"无法导入习题信息!"})},objDeepCopy:function(e){var t=e instanceof Array?[]:{};for(var s in e)e.hasOwnProperty(s)&&(t[s]="object"===E()(e[s])?this.objDeepCopy(e[s]):e[s]);return t},compare:function(e){return function(t,s){var a=t[e],r=s[e];return r<a?1:r>a?-1:0}}},created:function(){this.getParams(),this.getChapterInfo(),this.getRevExercises(),this.getCourses()},watch:{$route:function(e){this.getParams(),this.getChapterInfo(),this.getRevExercises()}},beforeRouteUpdate:function(e,t,s){for(var a=0;a<this.exercisesObj.length;a++){if(this.exercisesObj[a].new||this.exercisesObj[a].edited||this.exercisesObj[a].edit||this.exercisesObj[a].delete)return window.confirm("更改尚未保存，确认离开吗？")?void s():void s(!1)}for(var r=0;r<this.exercisesSub.length;r++){if(this.exercisesSub[r].new||this.exercisesSub[r].edited||this.exercisesSub[r].edit||this.exercisesSub[r].delete)return window.confirm("更改尚未保存，确认离开吗？")?void s():void s(!1)}s()},beforeRouteLeave:function(e,t,s){for(var a=0;a<this.exercisesObj.length;a++){if(this.exercisesObj[a].new||this.exercisesObj[a].edited||this.exercisesObj[a].edit||this.exercisesObj[a].delete)return window.confirm("更改尚未保存，确认离开吗？")?void s():void s(!1)}for(var r=0;r<this.exercisesSub.length;r++){if(this.exercisesSub[r].new||this.exercisesSub[r].edited||this.exercisesSub[r].edit||this.exercisesSub[r].delete)return window.confirm("更改尚未保存，确认离开吗？")?void s():void s(!1)}s()}},he={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-container",[s("div",{staticClass:"main",attrs:{align:"start"}},[s("el-dialog",{attrs:{title:"请选择截止时间",visible:e.dialogTableVisible},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[s("div",{attrs:{align:"center"}},[s("el-date-picker",{attrs:{type:"date",size:"small","picker-options":e.startLimit},model:{value:e.time,callback:function(t){e.time=t},expression:"time"}}),e._v(" "),s("el-button",{staticClass:"confirm-button",attrs:{loading:e.publishLoading,type:"primary",size:"small"},on:{click:e.publish}},[e._v("确认")])],1)]),e._v(" "),s("el-dialog",{attrs:{title:"请选择习题",visible:e.selectHistoryVisible},on:{"update:visible":function(t){e.selectHistoryVisible=t}}},[s("el-row",{attrs:{type:"flex",justify:"center"}},[s("el-select",{attrs:{size:"small"},on:{change:e.handleChapter},model:{value:e.importSettings,callback:function(t){e.importSettings=t},expression:"importSettings"}},e._l(e.importData,function(e){return s("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})}),1)],1),e._v(" "),s("el-row",{staticStyle:{"margin-top":"10px"},attrs:{type:"flex",justify:"center"}},[s("el-select",{attrs:{size:"small"},model:{value:e.chapterSettings,callback:function(t){e.chapterSettings=t},expression:"chapterSettings"}},e._l(e.chapterData,function(e){return s("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})}),1)],1),e._v(" "),s("el-row",{staticStyle:{"margin-top":"15px"},attrs:{type:"flex",justify:"center"}},[s("el-button",{attrs:{type:"primary",size:"small",loading:e.importLoading},on:{click:function(t){return e.confirmImport()}}},[e._v("提交")])],1)],1),e._v(" "),s("h4",[e._v("客观题("+e._s(e.totalObject)+"分)")]),e._v(" "),e._l(e.exercisesObj,function(t,a){return s("div",{key:100+a,staticClass:"exercises",attrs:{align:"start"}},[!1===t.edit?s("div",{class:t.delete?"is-deleted":""},[s("div",[s("span",{staticStyle:{"font-size":"15px"}},[e._v(e._s(t.order)+". "+e._s(t.question)+"（"+e._s(t.score)+"分）")])]),e._v(" "),s("div",{staticClass:"betweenspace",staticStyle:{"margin-top":"15px",padding:"0 10px 0 10px","font-size":"14px"}},e._l(t.options,function(r,i){return s("div",{key:100+a+i},[s("div",{class:e.setAnswerClass(t,i)},[e._v(e._s(String.fromCharCode(i+65))+"."+e._s(r.content))])])}),0),e._v(" "),s("div",{staticClass:"detail"},[e._v(e._s(t.detail))]),e._v(" "),t.delete?s("div",{staticStyle:{"margin-top":"10px"}},[s("span",[s("el-button",{attrs:{size:"mini",type:"success",round:""},on:{click:function(t){return e.cancelDeleteObject(a)}}},[e._v("恢复")])],1)]):s("div",{staticStyle:{"margin-top":"15px"}},[s("span",[s("el-button",{staticClass:"edit-button",attrs:{size:"mini",type:"warning",round:"",plain:""},on:{click:function(t){return e.editObject(a)}}},[e._v("编辑")])],1),e._v(" "),s("span",[s("el-button",{staticClass:"edit-button",attrs:{size:"mini",type:"warning",round:"",plain:""},on:{click:function(t){return e.deleteObject(a)}}},[e._v("删除")])],1),e._v(" "),s("span",[s("el-button",{staticClass:"edit-button",attrs:{size:"mini",type:"warning",round:"",plain:""},on:{click:function(t){return e.moveObjUp(a)}}},[e._v("上移")])],1),e._v(" "),s("span",[s("el-button",{staticClass:"edit-button",attrs:{size:"mini",type:"warning",round:"",plain:""},on:{click:function(t){return e.moveObjDown(a)}}},[e._v("下移")])],1)])]):s("div",{staticStyle:{"margin-bottom":"20px"}},[s("div",{staticStyle:{"margin-top":"8px"}},[s("p",{staticStyle:{"margin-left":"5px"}},[e._v(e._s(a+1)+".")]),e._v(" "),s("p",[s("el-input",{attrs:{type:"textarea",autosize:{minRows:8,maxRows:8},placeholder:"题目内容"},model:{value:e.objectNew.question,callback:function(t){e.$set(e.objectNew,"question",t)},expression:"objectNew.question"}})],1),e._v(" "),s("el-row",{staticStyle:{"margin-top":"20px"}},[s("el-col",{staticStyle:{"padding-top":"5px"},attrs:{span:3}},[s("el-radio",{attrs:{label:4},on:{change:e.handleType},model:{value:e.objectNew.type,callback:function(t){e.$set(e.objectNew,"type",t)},expression:"objectNew.type"}},[e._v("单选题")])],1),e._v(" "),s("el-col",{staticStyle:{"padding-top":"5px"},attrs:{span:3}},[s("el-radio",{attrs:{label:5},on:{change:e.handleType},model:{value:e.objectNew.type,callback:function(t){e.$set(e.objectNew,"type",t)},expression:"objectNew.type"}},[e._v("多选题")])],1),e._v(" "),s("el-col",{attrs:{span:18,align:"right"}},[s("div",[s("span",[e._v("分值")]),e._v(" "),s("span",{staticStyle:{"margin-left":"5px"}},[s("el-input",{staticStyle:{width:"80px"},attrs:{size:"mini",type:"number"},model:{value:e.objectNew.score,callback:function(t){e.$set(e.objectNew,"score",t)},expression:"objectNew.score"}})],1)])])],1)],1),e._v(" "),s("div",{staticClass:"betweenspace",staticStyle:{"margin-top":"15px"}},e._l(e.objectNew.options.length,function(t){return s("div",{key:100+a+t,staticStyle:{"margin-top":"10px"}},[s("span",[e._v(e._s(String.fromCharCode(t+64))+".")]),e._v(" "),s("span",{staticStyle:{"margin-left":"7px"}},[s("el-input",{staticStyle:{width:"240px"},attrs:{size:"mini"},model:{value:e.objectNew.options[t-1].content,callback:function(s){e.$set(e.objectNew.options[t-1],"content",s)},expression:"objectNew.options[j-1].content"}})],1),e._v(" "),s("span",[s("el-button",{attrs:{type:"text"},on:{click:function(s){return e.deleteObjOption(t-1)}}},[s("i",{staticClass:"el-icon-circle-close"})])],1)])}),0),e._v(" "),s("div",{staticStyle:{"margin-top":"15px"}},[s("el-button",{attrs:{size:"small",round:""},on:{click:function(t){return e.addRevOptions()}}},[s("i",{staticClass:"el-icon-circle-plus-outline",staticStyle:{"margin-right":"6px"}}),e._v("添加选项\n          ")])],1),e._v(" "),s("div",{staticStyle:{"margin-top":"15px"}},[s("p",[e._v("答案")]),e._v(" "),4===e.objectNew.type?s("p",{staticStyle:{"margin-top":"10px"}},[s("el-radio-group",{model:{value:e.objectNew.answer[0],callback:function(t){e.$set(e.objectNew.answer,0,t)},expression:"objectNew.answer[0]"}},e._l(e.objectNew.options.length,function(t){return s("el-radio",{key:t,attrs:{value:t-1,label:t-1}},[e._v(e._s(String.fromCharCode(t+64)))])}),1)],1):5===e.objectNew.type?s("p",{staticStyle:{"margin-top":"10px"}},[s("el-checkbox-group",{model:{value:e.objectNew.answer,callback:function(t){e.$set(e.objectNew,"answer",t)},expression:"objectNew.answer"}},e._l(e.objectNew.options.length,function(t){return s("el-checkbox",{key:t,attrs:{value:t-1,label:t-1}},[e._v(e._s(String.fromCharCode(t+64)))])}),1)],1):e._e()]),e._v(" "),s("div",{staticStyle:{"margin-top":"15px"}},[s("p",[e._v("解析")]),e._v(" "),s("el-input",{attrs:{type:"textarea",autosize:{minRows:8,maxRows:8},placeholder:"请输入题目解析"},model:{value:e.objectNew.detail,callback:function(t){e.$set(e.objectNew,"detail",t)},expression:"objectNew.detail"}})],1),e._v(" "),s("div",{staticStyle:{"margin-top":"20px"}},[s("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.saveObject(a)}}},[e._v("确认")]),e._v(" "),s("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"mini"},on:{click:function(t){return e.resetObject(a)}}},[e._v("重置")]),e._v(" "),s("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"mini"},on:{click:function(t){return e.cancelObj(a)}}},[e._v("取消")])],1)])])}),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.objectButton,expression:"objectButton"}]},[s("el-button",{staticStyle:{"margin-top":"20px"},attrs:{size:"small",round:"",type:"warning",plain:""},on:{click:e.addReviewO}},[s("i",{staticClass:"el-icon-circle-plus-outline",staticStyle:{"margin-right":"6px"}}),e._v("添加客观题\n      ")])],1),e._v(" "),s("h4",[e._v("主观题("+e._s(e.totalSubject)+"分)")]),e._v(" "),e._l(e.exercisesSub,function(t,a){return s("div",{key:a+600,staticClass:"exercises",staticStyle:{"font-size":"14px"},attrs:{align:"start"}},[!1===t.edit?s("div",{class:t.delete?"is-deleted":""},[s("div",[s("span",{staticStyle:{"font-size":"15px"}},[e._v(e._s(t.order)+"."+e._s(t.question)+"（"+e._s(t.score)+"分）")])]),e._v(" "),s("div",{staticClass:"answer-text"},[e._v(e._s(t.answer))]),e._v(" "),s("div",{staticClass:"detail"},[e._v(e._s(t.detail))]),e._v(" "),t.delete?s("div",{staticStyle:{"margin-top":"10px"}},[s("span",[s("el-button",{attrs:{size:"mini",type:"success",round:""},on:{click:function(t){return e.cancelDeleteSubject(a)}}},[e._v("恢复")])],1)]):s("div",{staticStyle:{"margin-top":"15px"}},[s("span",[s("el-button",{staticClass:"edit-button",attrs:{size:"mini",type:"warning",round:"",plain:""},on:{click:function(t){return e.editSubject(a)}}},[e._v("编辑")])],1),e._v(" "),s("span",[s("el-button",{staticClass:"edit-button",attrs:{size:"mini",type:"warning",round:"",plain:""},on:{click:function(t){return e.deleteSubject(a)}}},[e._v("删除")])],1),e._v(" "),s("span",[s("el-button",{staticClass:"edit-button",attrs:{size:"mini",type:"warning",round:"",plain:""},on:{click:function(t){return e.moveSubUp(a)}}},[e._v("上移")])],1),e._v(" "),s("span",[s("el-button",{staticClass:"edit-button",attrs:{size:"mini",type:"warning",round:"",plain:""},on:{click:function(t){return e.moveSubDown(a)}}},[e._v("下移")])],1)])]):s("div",{staticStyle:{"margin-bottom":"20px"}},[s("div",{staticStyle:{"margin-top":"8px"}},[s("p",{staticStyle:{"margin-left":"5px"}},[e._v(e._s(t.order)+".")]),e._v(" "),s("p",[s("el-input",{attrs:{type:"textarea",autosize:{minRows:8,maxRows:8},placeholder:"题目内容"},model:{value:e.subjectNew.question,callback:function(t){e.$set(e.subjectNew,"question",t)},expression:"subjectNew.question"}})],1)]),e._v(" "),s("div",[s("span",[e._v("分值")]),e._v(" "),s("span",{staticStyle:{"margin-left":"5px"}},[s("el-input",{staticStyle:{width:"80px"},attrs:{size:"mini",type:"number"},model:{value:e.subjectNew.score,callback:function(t){e.$set(e.subjectNew,"score",t)},expression:"subjectNew.score"}})],1)]),e._v(" "),s("div",{staticStyle:{"margin-top":"15px"}},[s("p",[e._v("答案")]),e._v(" "),s("el-input",{attrs:{type:"textarea",autosize:{minRows:8,maxRows:8},placeholder:"请输入题目答案"},model:{value:e.subjectNew.answer,callback:function(t){e.$set(e.subjectNew,"answer",t)},expression:"subjectNew.answer"}})],1),e._v(" "),s("div",{staticStyle:{"margin-top":"15px"}},[s("p",[e._v("解析")]),e._v(" "),s("el-input",{attrs:{type:"textarea",autosize:{minRows:8,maxRows:8},placeholder:"请输入题目解析"},model:{value:e.subjectNew.detail,callback:function(t){e.$set(e.subjectNew,"detail",t)},expression:"subjectNew.detail"}})],1),e._v(" "),s("div",{staticStyle:{"margin-top":"20px"}},[s("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.saveSubject(a)}}},[e._v("确认")]),e._v(" "),s("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"mini"},on:{click:function(t){return e.resetSubject(a)}}},[e._v("重置")]),e._v(" "),s("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"mini"},on:{click:function(t){return e.cancelSub(a)}}},[e._v("取消")])],1)])])}),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.subjectButton,expression:"subjectButton"}]},[s("el-button",{staticStyle:{"margin-top":"20px"},attrs:{type:"warning",plain:"",round:"",size:"small"},on:{click:e.addReviewS}},[s("i",{staticClass:"el-icon-circle-plus-outline",staticStyle:{"margin-right":"6px"}}),e._v("添加主观题\n      ")])],1),e._v(" "),s("div",{staticStyle:{"margin-top":"20px"},attrs:{align:"center"}},[s("el-button",{staticClass:"edit-button",attrs:{type:"success",plain:"",size:"small"},on:{click:function(t){e.selectHistoryVisible=!0}}},[e._v("导入")]),e._v(" "),s("el-button",{staticClass:"edit-button",attrs:{type:"success",plain:"",loading:e.submitLoading,disabled:e.funcButton,size:"small"},on:{click:e.submitReview}},[e._v("保存")]),e._v(" "),s("el-button",{attrs:{type:"success",disabled:e.funcButton,size:"small"},on:{click:function(t){e.dialogTableVisible=!0}}},[e._v("发布")]),e._v(" "),s("el-button",{attrs:{type:"info",disabled:e.funcButton,size:"small"},on:{click:e.getRevExercises}},[e._v("重置")])],1)],2)])},staticRenderFns:[]};var ue=s("VU/8")(ce,he,!1,function(e){s("/FTq")},"data-v-57c8edd8",null).exports,de={name:"studentList",data:function(){return{classID:0,courseID:0,studentInfo:[],studentCurrent:[],currentPage:1,listLoading:!1,searchId:"",studentCount:0}},methods:{goBack:function(){if(window.history.length<=1)return this.$router.push({path:"/"}),!1;this.$router.go(-1)},goAnalysis:function(e,t,s,a){this.$router.push({path:"/teacher/studentAnalysis",query:{studentID:e.id,studentName:e.name,classID:this.classID,courseID:this.courseID,userID:e.userID}})},getStudentInfo:function(e){var t=this;this.studentInfo=[],this.listLoading=!0,this.$http.get("http://10.60.38.173:8765/getStudentsByClassID?courseClassID="+this.classID,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200===e.status){var s=JSON.parse(e.bodyText);if(1===s.state){for(var a=0;a<s.data.length;)t.studentInfo.push({userID:s.data[a].userID,id:s.data[a].workID,name:s.data[a].name,email:s.data[a].mail}),a++,t.studentCount++;t.getStudentCurrent(1)}}else t.listLoading=!1,t.$message({type:"error",message:"加载失败!"})},function(e){t.listLoading=!1,t.$message({type:"error",message:"加载失败!"})})},getStudentCurrent:function(e){this.studentCurrent=[];for(var t=0;t<9;t++){var s=9*(e-1)+t;if(s>=this.studentInfo.length)break;this.studentCurrent.push(this.studentInfo[s])}this.currentPage=e,this.listLoading=!1},getStudentByID:function(){var e=this;""!==this.searchId?(this.listLoading=!0,this.studentInfo=[],this.$http.get("http://10.60.38.173:8765/getStudentsByClassID?courseClassID="+this.classID,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200===t.status){var s=JSON.parse(t.bodyText);if(1===s.state){for(var a=e.searchId.split(" "),r=[],i=0;i<s.data.length;i++){for(var o=!0,n=0;n<a.length;n++)if(-1===s.data[i].workID.toString().search(a[n])){o=!1;break}o&&r.push({id:s.data[i].workID,name:s.data[i].name,email:s.data[i].mail})}e.studentInfo=r,e.studentCount=e.studentInfo.length,e.getStudentCurrent(1)}}else e.listLoading=!1,e.$message({type:"error",message:"加载失败!"})},function(t){e.listLoading=!1,e.$message({type:"error",message:"加载失败!"})})):this.getStudentInfo()}},created:function(){this.classID=this.$route.query.classID,this.courseID=this.$route.query.courseID,this.getStudentInfo()}},pe={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-container",[s("el-main",{staticClass:"background"},[s("el-card",{staticClass:"card",attrs:{"body-style":{padding:"0"}}},[s("div",{staticClass:"cardbody"},[s("div",{staticClass:"header"},[s("div",{staticStyle:{float:"left","padding-top":"5px"}},[s("el-button",{staticClass:"button",attrs:{type:"text"},on:{click:e.goBack}},[s("i",{staticClass:"el-icon-back",staticStyle:{"margin-right":"6px"}})])],1),e._v(" "),s("div",{staticClass:"title"},[e._v("学生列表")])]),e._v(" "),s("div",[s("el-row",{staticClass:"margin",staticStyle:{"padding-left":"20px"},attrs:{gutter:30}},[s("el-col",{attrs:{span:8}},[s("el-input",{attrs:{placeholder:"按学号查找",size:"small"},model:{value:e.searchId,callback:function(t){e.searchId=t},expression:"searchId"}})],1),e._v(" "),s("el-col",{attrs:{span:3}},[s("el-button",{staticClass:"searchbutton",attrs:{type:"primary",size:"small"},on:{click:e.getStudentByID}},[s("i",{staticClass:"el-icon-search",staticStyle:{"margin-right":"10px"}}),e._v("搜索\n              ")])],1)],1),e._v(" "),s("el-row",{staticClass:"margin"},[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticClass:"table",attrs:{data:e.studentCurrent,size:"small"},on:{"row-click":e.goAnalysis}},[s("el-table-column",{attrs:{label:"学号",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"table-row"},[s("p",{staticClass:"text"},[e._v(e._s(t.row.id))])])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"姓名",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"table-row"},[s("p",{staticClass:"text"},[e._v(e._s(t.row.name))])])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"联系方式",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"table-row"},[s("p",{staticClass:"text"},[e._v(e._s(t.row.email))])])]}}])})],1)],1)],1),e._v(" "),s("div",{staticClass:"bottom page"},[s("el-pagination",{attrs:{"page-size":9,layout:"prev, pager, next",small:"",total:e.studentCount,"current-page":e.currentPage},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":function(t){return e.getStudentCurrent(e.currentPage)}}})],1)])])],1)],1)},staticRenderFns:[]};var me=s("VU/8")(de,pe,!1,function(e){s("d4A7")},"data-v-1bb8a78d",null).exports,ge=s("fZjL"),fe=s.n(ge),ve={name:"studentAnalysis",data:function(){return{studentID:1612345,studentName:"学生姓名",userID:0,courseID:0,classID:0,currentName:"暂无学习记录",activeNames:["1"],xyOptions:[{value:0,label:"学习成绩",xName:"章节",yName:"平均成绩"}],cOptions:[{value:0,label:"学生",disabled:!1,limit:4},{value:2,label:"班级平均分",disabled:!1,limit:4}],gradeOptions:[{value:0,label:"平均成绩"},{value:1,label:"课前成绩"},{value:2,label:"课后成绩"},{value:3,label:"课前-课后成绩",disabled:!1}],gradeAttribute:0,xy:0,comparison:0,xData:[],studentOptions:[],studentMap:[],studentInfo:[],gradeClass:[83,84,85],gradeEnumList:[60,70,80,90],amountList:[[8,17,29,18],[7,19,22,24],[12,16,31,13]],colors:["#0997F7","#92DD22","#FFFF33","#FFAAEE"],seriesData:[],colorOptions:[],legendData:[],drawCount:0,drawLoading:!1}},methods:{goBack:function(){if(window.history.length<=1)return this.$router.push({path:"/"}),!1;this.$router.go(-1)},getProcess:function(){var e=this;this.$http.get("http://10.60.38.173:8765/getCurrentProgress?courseClassID="+this.classID+"&studentID="+this.userID,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200===t.status){var s=JSON.parse(t.bodyText);1===s.state&&(e.currentName=s.data.contentName)}else e.$message({type:"error",message:"加载失败!"})},function(t){e.$message({type:"error",message:"加载失败!"})})},getStudentOptions:function(){var e=this;this.$http.get("http://10.60.38.173:8765/getStudentsByClassID?courseClassID="+this.classID,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200===t.status){var s=JSON.parse(t.bodyText);if(1===s.state)for(var a=0;a<s.data.length;)e.studentOptions.push({id:s.data[a].userID,value:a,label:s.data[a].name,disabled:!1}),s.data[a].userID===e.userID&&(e.studentOptions[a].disabled=!0),a++}else e.$message({type:"error",message:"加载失败!"})},function(t){e.$message({type:"error",message:"加载失败!"})})},getStudentInfo:function(e){var t=this;this.studentInfo=[],this.xData=[],this.$http.get("http://10.60.38.173:8765/getCourseScoreAndComment?courseID="+this.courseID+"&studentID="+e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200===e.status){for(var s=JSON.parse(e.bodyText),a=0;a<s.data.length;){var r=(Number(s.data[a].studentChapter.totalScore_1)+Number(s.data[a].studentChapter.totalScore_2))/2;t.studentInfo.push({id:s.data[a].studentChapter.id,scorePre:s.data[a].studentChapter.totalScore_1,scoreRev:s.data[a].studentChapter.totalScore_2,scoreAvg:r,chapter:s.data[a].chapterName,chapterID:s.data[a].studentChapter.chapterID}),t.xData.push(s.data[a].chapterName),a++}t.getStudentData(t.userID,0)}else t.$message({type:"error",message:"加载失败!"})},function(e){t.$message({type:"error",message:"加载失败!"})})},getStudentData:function(e,t){var s=this;this.$http.get("http://10.60.38.173:8765/getCourseScoreAndComment?courseID="+this.courseID+"&studentID="+e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200===e.status){for(var a=JSON.parse(e.bodyText),r=0;r<a.data.length;){var i=(Number(a.data[r].studentChapter.totalScore_1)+Number(a.data[r].studentChapter.totalScore_2))/2;if(0===s.xy&&3!==s.gradeAttribute)switch(s.gradeAttribute){case 0:s.seriesData[t].data.push(i);break;case 1:s.seriesData[t].data.push(a.data[r].studentChapter.totalScore_1);break;case 2:s.seriesData[t].data.push(a.data[r].studentChapter.totalScore_2)}0===s.xy&&3===s.gradeAttribute&&(s.seriesData[0].data.push(a.data[r].studentChapter.totalScore_1),s.seriesData[1].data.push(a.data[r].studentChapter.totalScore_2)),r++}s.drawChart()}else s.drawLoading=!1,s.$message({type:"error",message:"加载失败!"})},function(e){s.drawLoading=!1,s.$message({type:"error",message:"加载失败!"})})},getGenderAndClassData:function(e,t){var s=this;this.$http.get("http://10.60.38.173:8765/getCourseScoreAndCommentByGender?courseID="+this.courseID+"&chapterID="+e+"&getDetail=0&courseClassID="+this.classID,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200===e.status){var a=JSON.parse(e.bodyText);if(2===s.comparison)switch(s.gradeAttribute){case 0:var r=Number(a.data[0].scoreInfo.totalAverage1+a.data[0].scoreInfo.totalAverage2)/2;s.seriesData[1].data[t]=r.toFixed(2);break;case 1:var i=a.data[0].scoreInfo.totalAverage1;s.seriesData[1].data[t]=i.toFixed(2);break;case 2:var o=a.data[0].scoreInfo.totalAverage2;s.seriesData[1].data[t]=o.toFixed(2)}s.drawChart()}else s.drawLoading=!1,s.$message({type:"error",message:"加载失败!"})},function(e){s.drawLoading=!1,s.$message({type:"error",message:"加载失败!"})})},handleComparison:function(){switch(this.xy){case 0:this.comparison=0,this.xData=new Array,this.gradeAttribute=0,this.cOptions[0].disabled=!1,this.gradeOptions[3].disabled=!1,this.studentMap=new Array(4),this.getCharts()}},handleGradeAttribute:function(){0!==this.comparison?this.gradeOptions[3].disabled=!0:this.gradeOptions[3].disabled=!1},getCharts:function(){switch(this.xData=[],this.seriesData=new Array,this.colorOptions=new Array,this.legendData=new Array,this.drawCount=0,this.drawLoading=!0,this.xy){case 0:for(var e=0;e<this.studentInfo.length;e++){var t=this.studentInfo[e].chapter.indexOf("章");this.xData.push(this.studentInfo[e].chapter.substring(0,t+1))}switch(this.comparison){case 0:if(3!==this.gradeAttribute){this.seriesData.push({name:this.studentName,type:"bar",barGap:0,data:new Array}),this.colorOptions.push(this.colors[0]),this.legendData.push(this.studentName.toString()),this.getStudentData(this.userID,0);for(var s=1,a=0;a<this.studentMap.length;a++)if(void 0!==this.studentMap[a]&&""!==this.studentMap[a]){var r=this.studentMap[a];this.seriesData.push({name:this.studentOptions[r].label,type:"bar",barGap:0,data:new Array}),this.colorOptions.push(this.colors[s]),this.legendData.push(this.studentOptions[r].label.toString()),this.getStudentData(this.studentOptions[r].id,s),s+=1}}else this.seriesData=new Array(2),this.seriesData[0]={name:"课前成绩",type:"bar",barGap:0,data:[]},this.seriesData[1]={name:"课后成绩",type:"bar",barGap:0,data:[]},this.colorOptions.push(this.colors[0]),this.colorOptions.push(this.colors[1]),this.legendData.push("课前成绩"),this.legendData.push("课后成绩"),this.getStudentData(this.userID,0);break;case 2:this.seriesData=new Array(2),this.seriesData[0]={name:this.studentName,type:"bar",barGap:0,data:new Array},this.seriesData[1]={name:"班级平均",type:"bar",barGap:0,data:new Array},this.colorOptions.push(this.colors[0]),this.legendData.push(this.studentName.toString()),this.getStudentData(this.userID,0);for(var i=0;i<this.studentInfo.length;i++)this.seriesData[1].data.push(0),this.getGenderAndClassData(this.studentInfo[i].chapterID,i);this.colorOptions.push(this.colors[2]),this.legendData.push("班级平均")}}},drawChart:function(){var e=this.$echarts.init(document.getElementById("myChart"));e.clear(),this.drawCount++,console.log(this.xData.length),e.setOption({color:this.colorOptions,tooltip:{trigger:"axis",axisPointer:{type:"cross"}},legend:{data:this.legendData},dataZoom:[{type:"inside",filterMode:"filter",xAxisIndex:[0],startValue:0,endValue:7,orient:"horizontal",minValueSpan:5}],toolbox:{show:!0,orient:"vertical",right:"20px",top:"center",itemGap:20,feature:{mark:{show:!0},magicType:{show:!0,type:["line","bar","stack","tiled"]},restore:{show:!0},saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:this.xyOptions[this.xy].xName,axisTick:{show:!1},data:this.xData}],yAxis:[{name:this.xyOptions[this.xy].yName,type:"value"}],series:this.seriesData}),(0===this.comparison&&this.drawCount>=fe()(this.studentMap).length||this.drawCount===this.studentInfo.length)&&(this.drawLoading=!1)},objDeepCopy:function(e){var t=e instanceof Array?[]:{};for(var s in e)e.hasOwnProperty(s)&&(t[s]="object"===E()(e[s])?this.objDeepCopy(e[s]):e[s]);return t},getParams:function(){this.studentID=this.$route.query.studentID,this.studentName=this.$route.query.studentName,this.courseID=this.$route.query.courseID,this.classID=this.$route.query.classID,this.userID=this.$route.query.userID}},created:function(){this.getParams(),this.seriesData.push({name:this.studentName,type:"bar",barGap:0,data:new Array}),this.xData=new Array,this.colorOptions.push(this.colors[0]),this.legendData.push(this.studentName),this.getStudentInfo(this.userID),this.getStudentOptions(),this.getProcess()}},xe={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-container",[s("el-main",{staticClass:"background"},[s("el-row",{staticStyle:{margin:"0 auto",width:"90%","max-height":"685px"},attrs:{gutter:10,type:"flex",justify:"center"}},[s("el-col",{attrs:{span:2,align:"right"}},[s("div",[s("el-button",{staticStyle:{"box-shadow":"0 0 8px 1px #dbdbdb"},attrs:{circle:""},on:{click:e.goBack}},[s("i",{staticClass:"el-icon-back"})])],1)]),e._v(" "),s("el-col",{attrs:{span:6,align:"right"}},[s("el-card",{staticClass:"info-card",attrs:{"body-style":{padding:"0"}}},[s("div",{staticClass:"cardbody"},[s("div",{staticClass:"info",attrs:{align:"start"}},[s("div",[s("span",[e._v(e._s(e.studentID))]),e._v(" "),s("span",[e._v(e._s(e.studentName))])]),e._v(" "),s("el-row",{staticStyle:{"margin-top":"3px"}},[s("div",{staticStyle:{"padding-left":"11px","font-size":"12px",color:"#8e8e8e"}},[e._v("最近学习到 ["+e._s(e.currentName)+"]")])])],1),e._v(" "),s("div",{staticStyle:{padding:"10px 20px 10px 20px"},attrs:{align:"start"}},[s("el-tag",{staticStyle:{"margin-top":"5px"},attrs:{type:"danger",size:"small"}},[e._v("学科")]),e._v(" "),s("el-tag",{staticStyle:{"margin-top":"5px"},attrs:{type:"warning",size:"small"}},[e._v("语言")]),e._v(" "),s("el-tag",{staticStyle:{"margin-top":"5px"},attrs:{type:"success",size:"small"}},[e._v("专业")]),e._v(" "),s("el-tag",{staticStyle:{"margin-top":"5px"},attrs:{type:"info",size:"small"}},[e._v("薄弱")])],1)])]),e._v(" "),s("el-card",{staticClass:"select-card",attrs:{"body-style":{padding:"0"}}},[s("div",{staticClass:"cardbody",attrs:{align:"center"}},[s("div",{staticStyle:{width:"64%"},attrs:{align:"start"}},[s("el-row",{staticClass:"select-title"},[e._v("分析内容")]),e._v(" "),s("el-row",[s("el-select",{attrs:{size:"small"},on:{change:e.handleComparison},model:{value:e.xy,callback:function(t){e.xy=t},expression:"xy"}},e._l(e.xyOptions,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-row",[s("el-select",{staticClass:"select",attrs:{size:"small"},model:{value:e.gradeAttribute,callback:function(t){e.gradeAttribute=t},expression:"gradeAttribute"}},e._l(e.gradeOptions,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value,disabled:e.disabled}})}),1)],1),e._v(" "),3!==e.gradeAttribute?s("el-row",{staticClass:"select-title"},[e._v("对比组")]):e._e(),e._v(" "),3!==e.gradeAttribute?s("el-row",[s("el-select",{attrs:{size:"small"},on:{change:e.handleGradeAttribute},model:{value:e.comparison,callback:function(t){e.comparison=t},expression:"comparison"}},e._l(e.cOptions,function(e){return s("el-option",{key:e.value,attrs:{disabled:e.disabled,label:e.label,value:e.value}})}),1)],1):e._e(),e._v(" "),0===e.comparison&&3!==e.gradeAttribute?s("el-row",[s("el-row",{staticClass:"select-title"},[e._v("选择"+e._s(e.cOptions[e.comparison].label))]),e._v(" "),s("el-row",[s("el-row",[s("el-select",{attrs:{size:"small",filterable:"",clearable:"",multiple:"","multiple-limit":3},model:{value:e.studentMap,callback:function(t){e.studentMap=t},expression:"studentMap"}},e._l(e.studentOptions,function(e){return s("el-option",{directives:[{name:"show",rawName:"v-show",value:!e.disabled,expression:"!item.disabled"}],key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1):e._e(),e._v(" "),s("el-row",{staticClass:"select"},[s("el-button",{staticClass:"select-button",attrs:{type:"primary",size:"small",loading:e.drawLoading},on:{click:e.getCharts}},[e._v("确定")])],1)],1)])])],1),e._v(" "),s("el-col",{attrs:{span:16}},[s("el-card",{staticClass:"content-card",attrs:{"body-style":{padding:"0"}}},[s("div",{staticClass:"cardbody"},[s("el-scrollbar",{attrs:{"wrap-style":"height: 650px; margin-top: 5px",native:!1}},[s("div",[s("el-collapse",{staticClass:"collapse",model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[s("el-collapse-item",{attrs:{title:"成绩分析",name:"1"}},[s("el-row",[s("div",{staticClass:"my-chart",attrs:{id:"myChart"}})])],1),e._v(" "),s("el-collapse-item",{attrs:{title:"学习情况",name:"2"}},e._l(e.studentInfo,function(t){return s("div",{key:t.id,staticClass:"response",attrs:{align:"start"}},[s("el-row",[s("div",{staticClass:"title"},[e._v(e._s(t.chapter))])]),e._v(" "),s("el-row",{attrs:{gutter:10}},[s("el-col",{attrs:{span:6}},[s("span",{staticClass:"grade"},[e._v("课前成绩："+e._s(t.scorePre))])]),e._v(" "),s("el-col",{attrs:{span:6}},[s("span",{staticClass:"grade"},[e._v("课后成绩："+e._s(t.scoreRev))])]),e._v(" "),s("el-col",{attrs:{span:6}},[s("span",{staticClass:"grade"},[e._v("平均成绩："+e._s(t.scoreAvg))])])],1)],1)}),0)],1)],1)])],1)])],1)],1)],1)],1)},staticRenderFns:[]};var be=s("VU/8")(ve,xe,!1,function(e){s("kByn")},"data-v-68ec6033",null).exports,ye={name:"exerciseMark",data:function(){return{chapterID:0,classID:0,name:"",notSelect:!0,question:[],index:0,studentInfo:[],studentOptions:[],submitLoading:!1,questionLoading:!1,studentLoading:!1,scoreOptions:[{value:"1",label:"优"},{value:"0.9",label:"良"},{value:"0.8",label:"中"},{value:"0.6",label:"及格"},{value:"0",label:"不及格"}]}},methods:{goBack:function(){if(window.history.length<=1)return this.$router.push({path:"/"}),!1;this.$router.go(-1)},getExercises:function(){var e=this;this.question=[],this.$http.get("http://10.60.38.173:8765/question/view?chapterId="+this.chapterID+"&type=review",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200===t.status){var s=JSON.parse(t.bodyText);if(1===s.state){for(var a=0;a<s.data.length;)6===s.data[a].exercise.exerciseType&&e.question.push({id:s.data[a].exercise.exerciseId,content:s.data[a].exercise.exerciseContent,score:s.data[a].exercise.exercisePoint,order:s.data[a].exercise.exerciseNumber}),a++;e.getStudentInfo(),e.question.sort(e.compare("order"))}}else e.$message({type:"error",message:"加载失败!"})},function(t){e.$message({type:"error",message:"加载失败!"})})},getStudentInfo:function(){var e=this;this.studentInfo=[],this.studentOptions=[],this.$http.get("http://10.60.38.173:8765/getStudentsByClassID?courseClassID="+this.classID,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200===t.status){var s=JSON.parse(t.bodyText);if(1===s.state)for(var a=0;a<s.data.length;)e.studentInfo.push({answer:new Array,score:new Array,id:s.data[a].workID,name:s.data[a].name,studentId:s.data[a].userID}),e.studentOptions.push({value:a,label:s.data[a].workID+" "+s.data[a].name}),e.getAnswers(a),a++;console.log(e.studentInfo.length),console.log(e.studentOptions.length)}else e.$message({type:"error",message:"加载失败!"})},function(t){e.$message({type:"error",message:"加载失败!"})})},getAnswers:function(e){var t=this;this.$http.get("http://10.60.38.173:8765/question/viewSomeAnswer?chapterId="+this.chapterID+"&studentId=1&type=review",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(s){if(200===s.status){var a=JSON.parse(s.bodyText);if(1===a.state){for(var r=0;r<a.data.length;)6===a.data[r].exercise.exerciseType&&(t.studentInfo[e].answer.push({id:a.data[r].exercise.exerciseId,content:a.data[r].answer,order:a.data[r].exercise.exerciseNumber}),t.studentInfo[e].score.push(0)),r++;t.studentInfo[e].answer.sort(t.compare("order"))}else for(var i=0;i<t.question.length;i++)t.studentInfo[e].answer.push({id:t.question[i].id,content:"[[[该学生未提交答案!]]]",order:t.question[i].order}),t.studentInfo[e].score.push(0)}else t.$message({type:"error",message:"加载失败!"})},function(e){t.$message({type:"error",message:"加载失败!"})})},submit:function(){var e=this;if(0!==this.studentInfo[this.index].score.length){var t=1===this.studentInfo[this.index].score.length?this.studentInfo[this.index].score[0]:this.studentInfo[this.index].score;this.$http.post("http://10.60.38.173:8765/question/correctAll",{scores:t,studentId:1,chapterId:this.chapterID,type:"review"},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){200===t.status?e.$message({type:"success",message:"提交成功!"}):e.$message({type:"error",message:"提交失败!"})},function(t){e.$message({type:"error",message:"提交失败!"})})}else this.$message({type:"warning",message:"学生没有作答，无法评分!"})},compare:function(e){return function(t,s){var a=t[e],r=s[e];return r<a?1:r>a?-1:0}}},created:function(){this.chapterID=this.$route.query.chapterID,this.classID=this.$route.query.classID,this.name=this.$route.query.name,this.getExercises()},computed:{totalScore:function(){for(var e=[],t=0;t<this.studentInfo.length;t++){for(var s=0,a=0;a<this.question.length;a++)s+=this.studentInfo[t].score[a];e.push(s)}return e}}},we={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-container",[s("el-main",{staticClass:"background"},[s("div",{staticClass:"main"},[s("el-card",{attrs:{"body-style":{padding:"0"}}},[s("div",{staticClass:"header",attrs:{align:"center"}},[s("el-row",[s("el-col",{attrs:{span:2,align:"start"}},[s("div",[s("el-button",{staticClass:"back-button",attrs:{type:"text"},on:{click:e.goBack}},[s("i",{staticClass:"el-icon-back"})])],1)]),e._v(" "),s("el-col",{attrs:{span:22,align:"center"}},[s("div",{staticClass:"title"},[e._v(e._s(e.name))])])],1)],1),e._v(" "),s("div",{staticClass:"cardbody"},[s("el-row",{staticStyle:{"margin-top":"3px"}},[s("el-col",{attrs:{span:4,align:"center"}},[s("div",{staticStyle:{"font-size":"14px","margin-left":"20px","margin-top":"13px","font-weight":"450","letter-spacing":"1px"}},[e._v("总成绩："+e._s(e.totalScore[e.index]))])]),e._v(" "),s("el-col",{staticStyle:{height:"10px"},attrs:{span:13,align:"end"}},[e.notSelect?s("div",[s("el-button",{class:0===e.index?"buttonHid":"switch-button",attrs:{type:"text"},on:{click:function(t){e.index--}}},[s("i",{staticClass:"el-icon-caret-left"})])],1):s("div",[e._v(" ")])]),e._v(" "),s("el-col",{attrs:{span:5,align:"center"}},[e.notSelect&&e.studentInfo.length>0?s("div",{staticClass:"student-info",on:{dblclick:function(t){e.notSelect=!1}}},[e._v(e._s(e.studentInfo[e.index].id)+" "+e._s(e.studentInfo[e.index].name))]):s("div",{staticClass:"student-option"},[s("el-select",{attrs:{placeholder:"跳转到学生",filterable:"",size:"small"},model:{value:e.index,callback:function(t){e.index=t},expression:"index"}},e._l(e.studentOptions,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)]),e._v(" "),s("el-col",{attrs:{span:2,align:"start"}},[e.notSelect?s("div",[s("el-button",{class:e.index===e.studentInfo.length-1?"buttonHid":"switch-button",attrs:{type:"text"},on:{click:function(t){e.index++}}},[s("i",{staticClass:"el-icon-caret-right"})])],1):s("div",[s("el-button",{staticClass:"cancel-button",attrs:{type:"text"},on:{click:function(t){e.notSelect=!0}}},[s("i",{staticClass:"el-icon-circle-close"})])],1)])],1),e._v(" "),e.question.length>0&&e.studentInfo.length>0&&e.question.length===e.studentInfo[e.index].answer.length?s("div",e._l(e.question,function(t,a){return s("div",{key:a,staticClass:"question",attrs:{align:"start"}},[s("div",{staticStyle:{"font-weight":"400","letter-spacing":"0.8px","font-size":"14px"}},[e._v(e._s(t.order)+"."+e._s(t.content)+"("+e._s(t.score)+"分)")]),e._v(" "),s("div",{staticClass:"answer"},[e._v(e._s(e.studentInfo[e.index].answer[a].content))]),e._v(" "),s("div",{staticStyle:{"margin-top":"15px"}},[s("span",{staticClass:"notice"},[e._v("得分")]),e._v(" "),s("span",{staticStyle:{"margin-left":"10px"}},[s("el-select",{staticStyle:{width:"100px"},attrs:{size:"small"},model:{value:e.studentInfo[e.index].score[a],callback:function(t){e.$set(e.studentInfo[e.index].score,a,t)},expression:"studentInfo[index].score[i]"}},e._l(e.scoreOptions,function(e){return s("el-option",{key:10*e.value,attrs:{label:e.label,value:e.value*t.score}})}),1)],1)])])}),0):e._e()],1),e._v(" "),s("div",{staticStyle:{"margin-top":"20px","padding-bottom":"15px"},attrs:{align:"center"}},[s("el-button",{staticClass:"submit-button",attrs:{type:"primary",size:"small"},on:{click:e.submit}},[e._v("提交")])],1)])],1)])],1)},staticRenderFns:[]};var Ie=s("VU/8")(ye,we,!1,function(e){s("AnAC")},"data-v-0353bb7c",null).exports,_e=s("XLwt"),Ce=s.n(_e),De={props:{width:{type:Number,default:100,validator:function(e){return e>=0}},color:{type:String,default:"#FF99EB"},percentage:{type:Number,default:0,required:!0,validator:function(e){return e>=0&&e<=100}}},computed:{wrapStyle:function(){var e={};return e.width=this.width+"%",e},plusStyle:function(){var e={};return e.backgroundColor=this.color,e.width=this.percentage+"%",e.display="inline-block",e},minusStyle:function(){var e={backgroundColor:"#adecfc"};if(0===this.percentage)e.width="0";else{var t=100-this.percentage;e.width=t+"%"}return e.display="inline-block",e}}},Se={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"vue-progress-bar default-theme"},[t("div",{staticClass:"vue-progress-bar__outer",style:this.wrapStyle},[t("div",{staticClass:"vue-progress-bar-plus__inner",style:this.plusStyle}),this._v(" "),t("div",{staticClass:"vue-progress-bar-minus__inner",style:this.minusStyle})])])},staticRenderFns:[]};var Ne={name:"courseAnalysis",components:{vsBar:s("VU/8")(De,Se,!1,function(e){s("qlxr")},"data-v-f954cff8",null).exports},data:function(){return{courseID:0,teacherID:203,teacherName:"古唏",activeNames:["1"],courseGrade:0,courseAmountBoy:0,courseAmountGirl:0,courseClassAmount:0,courseLoading:!1,courseOptions:[],courseIndex:0,courseName:"",courseNameID:0,xyOptions:[{value:0,label:"教学评分",children:[{value:0,label:"按章节",xyValue:2,xName:"课程章节",yName:"教学评分"},{value:1,label:"按分数段",xyValue:3,xName:"教学评分",yName:"人数"},{value:2,label:"按学期",xyValue:7,xName:"课程学期",yName:"教学评分"},{value:3,label:"按学年",xyValue:5,xName:"课程学年",yName:"教学评分"}]},{value:1,label:"学习成绩",children:[{value:0,label:"按章节",xyValue:0,xName:"课程章节",yName:"成绩分数"},{value:1,label:"按分数段",xyValue:1,xName:"成绩分数",yName:"人数"},{value:2,label:"按学期",xyValue:6,xName:"课程学期",yName:"课程成绩"},{value:3,label:"按学年",xyValue:4,xName:"课程学年",yName:"课程成绩"}]}],cOptions:[{value:0,label:"学生",disabled:!0,limit:4},{value:1,label:"性别",disabled:!0,limit:1},{value:2,label:"班级",disabled:!1,limit:4},{value:3,label:"教师",disabled:!0,limit:4},{value:4,label:"章节",disabled:!0,limit:4}],gradeOptions:[{value:0,label:"总平均成绩",disabled:!1},{value:1,label:"课前平均成绩",disabled:!1},{value:2,label:"课后平均成绩",disabled:!1},{value:3,label:"课前-课后平均成绩",disabled:!1}],genderOptions:[],gradeAttribute:0,detail:[],detailValue:[],xy:2,xyIndex:[0,0],comparison:2,xData:[],setGradeAttribute:!1,setChapter:!1,teacherInfo:[],classOptions:[],chapterOptions:[],chapterSettings:0,genderMap:[],genderIndex:[],responseType:0,chapterIndex:0,chapterRate:0,classInfo:[{classNum:0,rate:0,positive:"-",negative:"-",percentage:0}],commentLoading:!1,studentOptions:[],studentMap:[],studentIndex:[],colors:["#0997F7","#92DD22","#FFFF33","#FFAAEE"],seriesData:[],colorOptions:[],legendData:[],drawLoading:!1,drawCount:0}},methods:{goBack:function(){if(window.history.length<=1)return this.$router.push({path:"/"}),!1;this.$router.go(-1)},getCourses:function(){var e=this;this.$http.get("http://10.60.38.173:8765/getCoursesByTeacherID?teacherID="+this.teacherID,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200===t.status){var s=JSON.parse(t.bodyText);if(1===s.state){var a=0,r=0;for(e.courseID=s.data[a].courseInfo.courseID,e.courseName=s.data[a].courseInfo.courseName+"["+s.data[a].courseInfo.courseYear+s.data[a].courseInfo.courseSemester+"]",e.courseNameID=s.data[a].courseNameID;a<s.data.length;){for(var i=!0,o=0;o<e.courseOptions.length;o++)if(e.courseOptions[o].courseID===s.data[a].courseInfo.courseID){i=!1;break}i&&(e.courseOptions.push({value:r,label:s.data[a].courseInfo.courseName+"["+s.data[a].courseInfo.courseYear+s.data[a].courseInfo.courseSemester+"]",courseID:s.data[a].courseInfo.courseID,courseNameID:s.data[a].courseNameID}),r++),a++}e.getChapters(),e.getTeacherInfo(),e.getBaseInfo()}}else e.$message({type:"error",message:"加载失败!"})},function(t){e.$message({type:"error",message:"加载失败!"})})},getStudentOptions:function(e){var t=this;this.$http.get("http://10.60.38.173:8765/getStudentsByClassID?courseClassID="+this.studentOptions[e].id,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(s){if(200===s.status){var a=JSON.parse(s.bodyText);if(1===a.state)for(var r=0;r<a.data.length;)t.studentOptions[e].children.push({value:r,label:a.data[r].name,userID:a.data[r].userID,disabled:!1}),r++}else t.$message({type:"error",message:"加载失败!"})},function(e){t.$message({type:"error",message:"加载失败!"})})},getClassOptions:function(){var e=this;this.classOptions=[],this.studentOptions=[],this.genderOptions=[],this.$http.get("http://10.60.38.173:8765/getClassesByCourseID?courseID="+this.courseID,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200===t.status){for(var s=JSON.parse(t.bodyText),a=0;a<s.data.length;)e.classOptions.push({value:a,id:s.data[a].id,label:s.data[a].classNum+"班"}),e.studentOptions.push({value:a,id:s.data[a].id,label:s.data[a].classNum+"班",children:[]}),e.genderOptions.push({value:a,id:s.data[a].id,label:s.data[a].classNum+"班",children:new Array(2)}),e.getStudentOptions(a),e.genderOptions[a].children[0]={value:0,label:"男生",disabled:!1},e.genderOptions[a].children[1]={value:1,label:"女生",disabled:!1},a++;for(var r=e.classOptions.length<4?e.classOptions.length:4,i=0;i<r;i++)e.detail.push(e.classOptions[i]),e.detailValue.push(i);e.getClassInfo(),e.getCharts()}else e.$message({type:"error",message:"加载失败!"})},function(t){e.$message({type:"error",message:"加载失败!"})})},getBaseInfo:function(){var e=this;this.courseLoading=!0,this.$http.get("http://10.60.38.173:8765/getCourseClassAvgScore?courseID="+this.courseID,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200===t.status){var s=JSON.parse(t.bodyText),a=Number(((s.data.courseGirlAvgRate+s.data.courseBoyAvgRate)/2).toFixed(1));e.courseGrade=a,e.courseAmountBoy=s.data.courseBoyNum,e.courseAmountGirl=s.data.courseGirlNum,e.courseClassAmount=s.data.classInfo.length,e.courseLoading=!1}else e.courseLoading=!1,e.$message({type:"error",message:"加载失败!"})},function(t){e.courseLoading=!1,e.$message({type:"error",message:"加载失败!"})})},getTeacherInfo:function(){var e=this;this.teacherInfo=[],this.$http.get("http://10.60.38.173:8765/getTeacherInfoByNID?courseNameID="+this.courseNameID,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200===t.status)for(var s=JSON.parse(t.bodyText),a=0,r=0;a<s.data.length;){for(var i=!0,o=0;o<e.teacherInfo.length;o++)if(e.teacherInfo[o].teacherID===s.data[a].courseInfo.teacherID){e.teacherInfo[o].courseInfo.push({courseID:s.data[a].courseInfo.courseID}),i=!1;break}i&&(e.teacherInfo.push({value:r,label:s.data[a].courseInfo.teacherName,teacherID:s.data[a].courseInfo.teacherID,self:!1,courseInfo:[{courseID:s.data[a].courseInfo.courseID}]}),s.data[a].courseInfo.teacherID===e.teacherID&&(e.teacherInfo[r].self=!0),r++),a++}else e.$message({type:"error",message:"加载失败!"})},function(t){e.$message({type:"error",message:"加载失败!"})})},getChapters:function(){var e=this;this.chapterOptions=[],this.$http.get("http://10.60.38.173:8765/getCourseCatalog?courseID="+this.courseID,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200===t.status){var s=JSON.parse(t.bodyText),a=0;for(e.chapterSettings=s.data[a].id;a<s.data.length;)e.chapterOptions.push({value:a,label:s.data[a].contentName,id:s.data[a].id}),a++;e.getClassOptions()}else e.$message({type:"error",message:"加载失败!"})},function(t){e.$message({type:"error",message:"加载失败!"})})},getClassInfo:function(){var e=this;this.commentLoading=!0,this.$http.get("http://10.60.38.173:8765/getCourseClassAvgScore?courseID="+this.courseID,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200===t.status){var s=JSON.parse(t.bodyText);if(0===e.classInfo[0].classNum){var a=0;for(e.classInfo=[];a<s.data.classInfo.length;)e.classInfo.push({classNum:a+1,rate:Number(Number((s.data.classInfo[a].girlAvgRate+s.data.classInfo[a].boyAvgRate)/2).toFixed(1)),percentage:0,positive:"-",negative:"-"}),a++;e.getClassNLP()}else{for(var r=0;r<s.data.classInfo.length;)e.classOptions[r].rate=Number(Number((s.data.classInfo[r].girlAvgRate+s.data.classInfo[r].boyAvgRate)/2).toFixed(1)),e.classInfo[r].positive="-",e.classInfo[r].negative="-",r++;e.getClassNLP()}e.commentLoading=!1}else e.commentLoading=!1,e.$message({type:"error",message:"加载失败!"})},function(t){e.commentLoading=!1,e.$message({type:"error",message:"加载失败!"})})},getClassNLP:function(){var e=this;this.$http.get("http://10.60.38.173:8765/getCourseClassNLPRateNum?courseID="+this.courseID,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200===t.status)for(var s=JSON.parse(t.bodyText),a=0;a<s.data.classInfo.length;){for(var r=0;r<e.classInfo.length;r++)e.classInfo[r].classNum===s.data.classInfo[a].classNum&&(e.classInfo[r].percentage=Math.round(Number(s.data.classInfo[a].classPositiveNum)/Number(s.data.classInfo[a].classStudentNum)*100),e.classInfo[r].positive=s.data.classInfo[a].classPositiveNum,e.classInfo[r].negative=s.data.classInfo[a].classNegativeNum);a++}else e.$message({type:"error",message:"加载失败!"})},function(t){e.$message({type:"error",message:"加载失败!"})})},getChapterClassInfo:function(e){var t=this;this.commentLoading=!0,this.$http.get("http://10.60.38.173:8765/getCourseScoreAndCommentByGender?chapterID="+e+"&getDetail=0",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(s){if(200===s.status){var a=JSON.parse(s.bodyText);if(0===t.classInfo[0].classNum){var r=0;for(t.classInfo=[];r<a.data.length;)t.classInfo.push({classNum:a.data[r].classNum,rate:Number(Number(a.data[r].scoreInfo.totalRateAvg).toFixed(1)),percentage:0,positive:"-",negative:"-"}),r++;t.getChapterClassNLP(e)}else{for(var i=0;i<t.classInfo.length;)t.classInfo[i].rate=Number(Number(a.data[i].scoreInfo.totalRateAvg).toFixed(1)),t.classInfo[i].positive="-",t.classInfo[i].negative="-",i++;t.getChapterClassNLP(e)}t.chapterRate=Number(a.data[0].scoreInfo.totalRateAvg.toFixed(1)),t.commentLoading=!1}else t.commentLoading=!1,t.$message({type:"error",message:"加载失败!"})},function(e){t.commentLoading=!1,t.$message({type:"error",message:"加载失败!"})})},getChapterClassNLP:function(e){var t=this;this.$http.get("http://10.60.38.173:8765/getChapterNLPRateNum?chapterID="+e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200===e.status)for(var s=JSON.parse(e.bodyText),a=0;a<s.data.classInfo.length;){for(var r=0;r<t.classInfo.length;r++)t.classInfo[r].classNum===s.data.classInfo[a].classNum&&(t.classInfo[r].percentage=Math.round(Number(s.data.classInfo[a].classPositiveNum)/Number(s.data.classInfo[a].classStudentNum)*100),t.classInfo[r].positive=s.data.classInfo[a].classPositiveNum,t.classInfo[r].negative=s.data.classInfo[a].classNegativeNum);a++}else t.$message({type:"error",message:"加载失败!"})},function(e){t.$message({type:"error",message:"加载失败!"})})},getStudentScoreData:function(e,t,s){var a=this;this.$http.get("http://10.60.38.173:8765/getCourseScoreAndComment?courseID="+this.courseID+"&studentID="+e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200===e.status){var r=JSON.parse(e.bodyText);if(1===r.state){if(s>=r.data.length)return;var i=(Number(r.data[s].studentChapter.totalScore_1)+Number(r.data[s].studentChapter.totalScore_2))/2;if(0===a.xy&&3!==a.gradeAttribute)switch(a.gradeAttribute){case 0:a.seriesData[t].data[s]=i;break;case 1:a.seriesData[t].data[s]=r.data[s].studentChapter.totalScore_1;break;case 2:a.seriesData[t].data[s]=r.data[s].studentChapter.totalScore_2}0===a.xy&&3===a.gradeAttribute&&(a.seriesData[0].data[s]=r.data[s].studentChapter.totalScore_1,a.seriesData[1].data[s]=r.data[s].studentChapter.totalScore_2),a.drawChart()}}else a.$message({type:"error",message:"加载失败!"})},function(e){a.$message({type:"error",message:"加载失败!"})})},getOtherScoreData:function(e,t,s,a){var r=this;this.$http.get("http://10.60.38.173:8765/getCourseScoreAndCommentByGender?courseID="+this.courseID+"&chapterID="+e+"&getDetail=0&courseClassID="+t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200===e.status){var t=JSON.parse(e.bodyText);if(1===t.state){if(1===r.comparison)switch(r.gradeAttribute){case 0:var i=Number(t.data[0].scoreInfo.boyAverage1)+Number(t.data[0].scoreInfo.boyAverage2)/2,o=Number(t.data[0].scoreInfo.girlAverage1)+Number(t.data[0].scoreInfo.girlAverage2)/2;r.seriesData[0].data[s]=i.toFixed(2),r.seriesData[1].data[s]=o.toFixed(2);break;case 1:r.seriesData[0].data[s]=t.data[0].scoreInfo.boyAverage1.toFixed(2),r.seriesData[1].data[s]=t.data[0].scoreInfo.girlAverage1.toFixed(2);break;case 2:r.seriesData[0].data[s]=t.data[0].scoreInfo.boyAverage2.toFixed(2),r.seriesData[1].data[s]=t.data[0].scoreInfo.girlAverage2.toFixed(2)}if(2===r.comparison)switch(r.gradeAttribute){case 0:var n=Number(t.data[0].scoreInfo.totalAverage1+t.data[0].scoreInfo.totalAverage2)/2;r.seriesData[a].data[s]=n.toFixed(2);break;case 1:var l=t.data[0].scoreInfo.totalAverage1;r.seriesData[a].data[s]=l.toFixed(2);break;case 2:var c=t.data[0].scoreInfo.totalAverage2;r.seriesData[a].data[s]=c.toFixed(2)}r.drawChart()}}else r.drawLoading=!1,r.$message({type:"error",message:"加载失败!"})},function(e){r.drawLoading=!1,r.$message({type:"error",message:"加载失败!"})})},getScoreDistributeData:function(e,t,s,a){var r=this;this.$http.get("http://10.60.38.173:8765/getCourseScoreAndCommentByGender?courseID="+this.courseID+"&chapterID="+e+"&getDetail=0&courseClassID="+t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200===e.status){var t=JSON.parse(e.bodyText);if(1===r.comparison)switch(r.gradeAttribute){case 0:r.seriesData[s].data=0===a?t.data[0].scoreInfo.boyScoreAvgDistribute:t.data[0].scoreInfo.girlScoreAvgDistribute;break;case 1:r.seriesData[s].data=0===a?t.data[0].scoreInfo.boyScoreDistribute1:t.data[0].scoreInfo.girlScoreDistribute1;break;case 2:r.seriesData[s].data=0===a?t.data[0].scoreInfo.boyScoreDistribute2:t.data[0].scoreInfo.girlScoreDistribute2}if(2===r.comparison)switch(r.gradeAttribute){case 0:r.seriesData[s].data=t.data[0].scoreInfo.totalScoreAvgDistribute;break;case 1:r.seriesData[s].data=t.data[0].scoreInfo.totalScoreDistribute1;break;case 2:r.seriesData[s].data=t.data[0].scoreInfo.totalScoreDistribute2}r.drawChart()}else r.drawLoading=!1,r.$message({type:"error",message:"加载失败!"})},function(e){r.drawLoading=!1,r.$message({type:"error",message:"加载失败!"})})},getClassRateData:function(e,t,s,a){var r=this;this.$http.get("http://10.60.38.173:8765/getCourseScoreAndCommentByGender?courseID="+this.courseID+"&chapterID="+e+"&getDetail=0&courseClassID="+t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200===e.status){var t=JSON.parse(e.bodyText);void 0!==t.data[0].scoreInfo.totalRateAvg&&(r.seriesData[a].data[s]=t.data[0].scoreInfo.totalRateAvg.toFixed(2),r.drawChart())}else r.drawLoading=!1,r.$message({type:"error",message:"加载失败!"})},function(e){r.drawLoading=!1,r.$message({type:"error",message:"加载失败!"})})},getRateDistribute:function(e,t){var s=this;this.$http.get("http://10.60.38.173:8765/question/rateNumber?chapterId="+e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200===e.status){var a=JSON.parse(e.bodyText);s.seriesData[t].data=a.data,s.drawChart()}else s.drawLoading=!1,s.$message({type:"error",message:"加载失败!"})},function(e){s.drawLoading=!1,s.$message({type:"error",message:"加载失败!"})})},getTeacherYearRateData:function(e,t,s){var a=this;this.$http.get("http://10.60.38.173:8765/getCourseYearAvgScoreRate?courseNameID="+this.courseNameID+"&teacherID="+e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200===e.status){var r=JSON.parse(e.bodyText);if(1===r.state)if(s)for(var i in r.data.year)a.xData.push(i),a.seriesData[t].data.push(Number(r.data.year[i].rate).toFixed(1));else for(var i in a.seriesData[t].data=new Array(a.xData.length),r.data.year){var o=a.xData.indexOf(i);-1!==o&&(a.seriesData[t].data[o]=Number(r.data.year[i].rate).toFixed(1))}a.drawChart()}else a.$message({type:"error",message:"加载失败!"})},function(e){a.$message({type:"error",message:"加载失败!"})})},getTeacherSemesterRateData:function(e,t,s){var a=this;this.$http.get("http://10.60.38.173:8765/getCourseYearAvgScoreRate?courseNameID="+this.courseNameID+"&teacherID="+e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200===e.status){var r=JSON.parse(e.bodyText);if(1===r.state)if(s)for(var i in r.data.semester)a.xData.push(i),a.seriesData[t].data.push(Number(r.data.semester[i].rate).toFixed(1));else for(var i in a.seriesData[t].data=new Array(a.xData.length),r.data.semester){var o=a.xData.indexOf(i);-1!==o&&(a.seriesData[t].data[o]=Number(r.data.semester[i].rate).toFixed(1))}a.drawChart()}else a.$message({type:"error",message:"加载失败!"})},function(e){a.$message({type:"error",message:"加载失败!"})})},getTeacherYearScoreData:function(e,t,s){var a=this;this.$http.get("http://10.60.38.173:8765/getCourseYearAvgScoreRate?courseNameID="+this.courseNameID+"&teacherID="+e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200===e.status){var r=JSON.parse(e.bodyText);if(1===r.state)if(s)for(var i in r.data.year)a.xData.push(i),a.seriesData[t].data.push(Number(r.data.year[i].score).toFixed(2));else for(var i in a.seriesData[t].data=new Array(a.xData.length),r.data.year){var o=a.xData.indexOf(i);-1!==o&&(a.seriesData[t].data[o]=Number(r.data.year[i].score).toFixed(2))}a.drawChart()}else a.drawLoading=!1,a.$message({type:"error",message:"加载失败!"})},function(e){a.drawLoading=!1,a.$message({type:"error",message:"加载失败!"})})},getTeacherSemesterScoreData:function(e,t,s){var a=this;this.$http.get("http://10.60.38.173:8765/getCourseYearAvgScoreRate?courseNameID="+this.courseNameID+"&teacherID="+e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200===e.status){var r=JSON.parse(e.bodyText);if(1===r.state)if(s)for(var i in r.data.semester)a.xData.push(i),a.seriesData[t].data.push(Number(r.data.semester[i].score).toFixed(2));else for(var i in a.seriesData[t].data=new Array(a.xData.length),r.data.semester){var o=a.xData.indexOf(i);-1!==o&&(a.seriesData[t].data[o]=Number(r.data.semester[i].score).toFixed(2))}a.drawChart()}else a.$message({type:"error",message:"加载失败!"})},function(e){a.$message({type:"error",message:"加载失败!"})})},handleCourse:function(e){this.drawLoading=!1,this.courseID=this.courseOptions[e].courseID,this.courseName=this.courseOptions[e].label,this.courseNameID=this.courseOptions[e].courseNameID,this.detailValue=[],this.detail=[],this.xyIndex=[0,0],this.xy=2,this.comparison=2,this.getChapters(),this.getTeacherInfo(),this.getBaseInfo(),this.studentIndex=new Array(4),this.studentMap=new Array(4),this.genderMap=new Array(2),this.genderIndex=new Array(2)},handleComparison:function(e){switch(this.drawLoading=!1,this.xy=this.xyOptions[e[0]].children[e[1]].xyValue,this.xy){case 0:this.comparison=0,this.gradeAttribute=0,this.chapterSettings=this.chapterOptions[0].id,this.detail=[],this.detailValue=[],this.setGradeAttribute=!0,this.setChapter=!1,this.gradeOptions[3].disabled=!1,this.drawLoading=!1;for(var t=0;t<this.cOptions.length;t++)this.cOptions[t].disabled=4===t||3===t;break;case 1:this.comparison=1,this.gradeAttribute=0,this.chapterSettings=this.chapterOptions[0].id,this.detail=[],this.detailValue=[],this.setGradeAttribute=!0,this.setChapter=!0,this.gradeOptions[3].disabled=!0,this.drawLoading=!1;for(var s=0;s<this.cOptions.length;s++)this.cOptions[s].disabled=1!==s&&2!==s;break;case 2:this.comparison=2,this.detail=[],this.detailValue=[],this.setGradeAttribute=!1,this.setChapter=!1,this.drawLoading=!1;for(var a=0;a<this.cOptions.length;a++)this.cOptions[a].disabled=2!==a;break;case 3:this.comparison=4,this.detail=[],this.detailValue=[],this.setChapter=!1,this.setGradeAttribute=!1,this.drawLoading=!1;for(var r=0;r<this.cOptions.length;r++)this.cOptions[r].disabled=4!==r;break;case 4:this.comparison=3,this.detail=[],this.detailValue=[],this.setGradeAttribute=!1,this.setChapter=!1,this.drawLoading=!1;for(var i=0;i<this.cOptions.length;i++)this.cOptions[i].disabled=3!==i;break;case 5:this.comparison=3,this.detail=[],this.detailValue=[],this.setGradeAttribute=!1,this.setChapter=!1,this.drawLoading=!1;for(var o=0;o<this.cOptions.length;o++)this.cOptions[o].disabled=3!==o;break;case 6:this.comparison=3,this.detail=[],this.detailValue=[],this.setGradeAttribute=!1,this.setChapter=!1,this.drawLoading=!1;for(var n=0;n<this.cOptions.length;n++)this.cOptions[n].disabled=3!==n;break;case 7:this.comparison=3,this.detail=[],this.detailValue=[],this.setGradeAttribute=!1,this.setChapter=!1,this.drawLoading=!1;for(var l=0;l<this.cOptions.length;l++)this.cOptions[l].disabled=3!==l}},handleDetail:function(){this.drawLoading=!1,this.detailValue=[],this.detail=[],this.gradeAttribute=0,0===this.comparison?this.gradeOptions[3].disabled=!1:this.gradeOptions[3].disabled=!0},handleDetailValue:function(e){this.detail=[];for(var t=0;t<this.detailValue.length;t++)this.detail.push(this.detailOptions[this.detailValue[t]])},handleStudent:function(e){var t=this.studentMap[e];if(void 0!==this.studentIndex[e]&&0===fe()(t).length){var s=this.studentIndex[e][0],a=this.studentIndex[e][1];this.studentOptions[s].children[a].disabled=!1}else{var r=t[0],i=t[1];this.studentOptions[r].children[i].disabled=!0,this.studentIndex[e]=new Array,this.studentIndex[e]=t}},handleGender:function(e){var t=this.genderMap[e];if(void 0!==this.genderIndex[e]&&0===fe()(t).length){var s=this.genderIndex[e][0],a=this.genderIndex[e][1];this.genderOptions[s].children[a].disabled=!1}else{var r=t[0],i=t[1];this.genderOptions[r].children[i].disabled=!0,this.genderIndex[e]=new Array,this.genderIndex[e]=t}},handleChapter:function(e){var t=this.chapterOptions[e].id;this.getChapterClassInfo(t)},handleResponse:function(){0===this.responseType&&(this.classInfo=[{classNum:0,rate:0,positive:"-",negative:"-",percentage:0}],this.getClassInfo()),1===this.responseType&&(this.classInfo=[{classNum:0,rate:0,positive:"-",negative:"-",percentage:0}],this.getChapterClassInfo(this.chapterSettings))},getCharts:function(){switch(this.xData=new Array,this.seriesData=new Array,this.colorOptions=new Array,this.legendData=new Array,this.drawLoading=!0,this.drawCount=0,this.xy){case 0:for(var e=0;e<this.chapterOptions.length;e++)this.xData.push(this.chapterOptions[e].label);switch(this.comparison){case 0:if(3!==this.gradeAttribute){for(var t=0,s=0;s<this.studentMap.length;s++){var a=this.studentMap[s];if(void 0!==a&&0!==fe()(a).length){var r=a[0],i=a[1];this.seriesData.push({name:this.studentOptions[r].children[i].label,type:"bar",barGap:0,data:new Array(this.chapterOptions.length)}),this.colorOptions.push(this.colors[t]),this.legendData.push(this.studentOptions[r].children[i].label.toString());for(var o=0;o<this.chapterOptions.length;o++)this.getStudentScoreData(this.studentOptions[r].children[i].userID,t,o);t+=1}}0===this.seriesData.length&&(this.$message({type:"warning",message:"请选择学生!"}),this.drawLoading=!1)}else{var n=this.studentMap[0],l=n[0],c=n[1];this.seriesData=new Array(2),this.seriesData[0]={name:"课前成绩",type:"bar",barGap:0,data:new Array(this.chapterOptions.length)},this.seriesData[1]={name:"课后成绩",type:"bar",barGap:0,data:new Array(this.chapterOptions.length)},this.colorOptions.push(this.colors[0]),this.colorOptions.push(this.colors[1]),this.legendData.push("课前成绩"),this.legendData.push("课后成绩");for(var h=0;h<this.chapterOptions.length;h++)this.getStudentScoreData(this.studentOptions[l].children[c].userID,0,h)}break;case 1:for(var u=0;u<2;u++){var d=this.genderMap[u];if(void 0===d||0===fe()(d).length)return this.$message({type:"warning",message:"请将选项选择完整!"}),void(this.drawLoading=!1);var p=d[0],m=d[1];this.seriesData.push({name:this.genderOptions[p].label+this.genderOptions[p].children[m].label,type:"bar",barGap:0,data:new Array(this.chapterOptions.length)}),this.legendData.push(this.genderOptions[p].label+this.genderOptions[p].children[m].label);for(var g=0;g<this.chapterOptions.length;g++)this.getOtherScoreData(this.chapterOptions[g].id,this.genderOptions[p].id,g)}this.colorOptions.push(this.colors[2]),this.colorOptions.push(this.colors[1]);break;case 2:if(0===this.detail.length)return this.$message({type:"warning",message:"请选择班级!"}),void(this.drawLoading=!1);for(var f=0;f<this.detail.length;f++){this.seriesData.push({name:this.detail[f].label,type:"bar",barGap:0,data:new Array(this.chapterOptions.length)}),this.colorOptions.push(this.colors[f]),this.legendData.push(this.detail[f].label);for(var v=0;v<this.chapterOptions.length;v++)this.getOtherScoreData(this.chapterOptions[v].id,this.detail[f].id,v,f)}}break;case 1:switch(this.xData=["60以下","60-70","70-80","80-90","90-100"],this.comparison){case 1:for(var x=0;x<2;x++){var b=this.genderMap[x];if(void 0===b||0===fe()(b).length)return this.$message({type:"warning",message:"请将选项选择完整!"}),void(this.drawLoading=!1);var y=b[0],w=b[1];this.seriesData.push({name:this.genderOptions[y].label+this.genderOptions[y].children[w].label,type:"bar",barGap:0,data:new Array(6)}),this.legendData.push(this.genderOptions[y].label+this.genderOptions[y].children[w].label),this.getScoreDistributeData(this.chapterOptions[this.chapterSettings].id,this.genderOptions[y].id,x,this.genderOptions[y].children[w].value)}this.colorOptions.push(this.colors[2]),this.colorOptions.push(this.colors[1]);break;case 2:if(0===this.detail.length)return this.$message({type:"warning",message:"请选择班级!"}),void(this.drawLoading=!1);for(var I=0;I<this.detail.length;I++)this.seriesData.push({name:this.detail[I].label,type:"bar",barGap:0,data:new Array(6)}),this.colorOptions.push(this.colors[I]),this.legendData.push(this.detail[I].label),this.getScoreDistributeData(this.chapterOptions[this.chapterSettings].id,this.detail[I].id,I)}break;case 2:switch(this.comparison){case 2:for(var _=0;_<this.chapterOptions.length;_++)this.xData.push(this.chapterOptions[_].label);if(0===this.detail.length)return this.$message({type:"warning",message:"请选择班级!"}),void(this.drawLoading=!1);for(var C=0;C<this.detail.length;C++){this.seriesData.push({name:this.detail[C].label,type:"bar",barGap:0,data:new Array(this.chapterOptions.length)}),this.colorOptions.push(this.colors[C]),this.legendData.push(this.detail[C].label);for(var D=0;D<this.chapterOptions.length;D++)this.getClassRateData(this.chapterOptions[D].id,this.detail[C].id,D,C)}}break;case 3:switch(this.xData=["1分","2分","3分","4分","5分"],this.comparison){case 4:if(0===this.detail.length)return this.$message({type:"warning",message:"请选择章节!"}),void(this.drawLoading=!1);for(var S=0;S<this.detail.length;S++)this.seriesData.push({name:this.detail[S].label,type:"bar",barGap:0,data:new Array(5)}),this.colorOptions.push(this.colors[S]),this.legendData.push(this.detail[S].label),this.getRateDistribute(this.detail[S].id,S)}break;case 4:switch(this.comparison){case 3:this.seriesData.push({name:this.teacherName,type:"bar",barGap:0,data:new Array}),this.colorOptions.push(this.colors[0]),this.legendData.push(this.teacherName),this.getTeacherYearScoreData(this.teacherID,0,!0);for(var N=0;N<this.detail.length;N++)this.seriesData.push({name:this.detail[N].label,type:"bar",barGap:0,data:new Array}),this.colorOptions.push(this.colors[N+1]),this.legendData.push(this.detail[N].label),this.getTeacherYearScoreData(this.detail[N].teacherID,N+1,!1)}break;case 5:switch(this.comparison){case 3:this.seriesData.push({name:this.teacherName,type:"bar",barGap:0,data:new Array}),this.colorOptions.push(this.colors[0]),this.legendData.push(this.teacherName),this.getTeacherYearRateData(this.teacherID,0,!0);for(var k=0;k<this.detail.length;k++)this.seriesData.push({name:this.detail[k].label,type:"bar",barGap:0,data:new Array}),this.colorOptions.push(this.colors[k+1]),this.legendData.push(this.detail[k].label),this.getTeacherYearRateData(this.detail[k].teacherID,k+1,!1)}break;case 6:switch(this.comparison){case 3:this.seriesData.push({name:this.teacherName,type:"bar",barGap:0,data:new Array}),this.colorOptions.push(this.colors[0]),this.legendData.push(this.teacherName),this.getTeacherSemesterScoreData(this.teacherID,0,!0);for(var O=0;O<this.detail.length;O++)this.seriesData.push({name:this.detail[O].label,type:"bar",barGap:0,data:new Array}),this.colorOptions.push(this.colors[O+1]),this.legendData.push(this.detail[O].label),this.getTeacherSemesterScoreData(this.detail[O].teacherID,O+1,!1)}break;case 7:switch(this.comparison){case 3:this.seriesData.push({name:this.teacherName,type:"bar",barGap:0,data:new Array}),this.colorOptions.push(this.colors[0]),this.legendData.push(this.teacherName),this.getTeacherSemesterRateData(this.teacherID,0,!0);for(var $=0;$<this.detail.length;$++)this.seriesData.push({name:this.detail[$].label,type:"bar",barGap:0,data:new Array}),this.colorOptions.push(this.colors[$+1]),this.legendData.push(this.detail[$].label),this.getTeacherSemesterRateData(this.detail[$].teacherID,$+1,!1)}}},drawChart:function(){var e=this.$echarts.init(document.getElementById("myChart"));e.clear(),this.drawCount+=1,console.log(this.xData.length),e.setOption({color:this.colorOptions,tooltip:{trigger:"axis",axisPointer:{type:"cross"}},legend:{data:this.legendData},dataZoom:[{type:"inside",filterMode:"filter",xAxisIndex:[0],startValue:0,endValue:7,orient:"horizontal",minValueSpan:5}],toolbox:{show:!0,orient:"vertical",right:"20px",top:"center",itemGap:20,feature:{mark:{show:!0},magicType:{show:!0,type:["line","bar","stack","tiled"]},restore:{show:!0},saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:this.xyOptions[this.xyIndex[0]].children[this.xyIndex[1]].xName,axisTick:{show:!1},data:this.xData}],yAxis:[{name:this.xyOptions[this.xyIndex[0]].children[this.xyIndex[1]].yName,type:"value"}],series:this.seriesData}),(this.comparison<=1||3===this.comparison&&this.drawCount>this.detail.length||(2===this.comparison||4===this.comparison)&&this.drawCount===this.detail.length)&&(this.drawLoading=!1)}},created:function(){this.getCourses(),this.studentIndex=new Array(4),this.studentMap=new Array(4),this.genderMap=new Array(2),this.genderIndex=new Array(2)},computed:{detailOptions:function(){var e=[];switch(this.comparison){case 0:e=this.studentOptions;break;case 1:e=this.genderOptions;break;case 2:e=this.classOptions;break;case 3:e=this.teacherInfo;break;case 4:e=this.chapterOptions}return e}}},ke={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-container",[s("el-main",{staticClass:"background"},[s("el-row",{staticStyle:{margin:"0 auto",width:"90%","max-height":"685px"},attrs:{gutter:10,type:"flex",justify:"center"}},[s("el-col",{attrs:{span:2,align:"right"}},[s("div",[s("el-button",{staticStyle:{"box-shadow":"0 0 8px 1px #dbdbdb"},attrs:{circle:""},on:{click:e.goBack}},[s("i",{staticClass:"el-icon-back"})])],1)]),e._v(" "),s("el-col",{attrs:{span:6,align:"right"}},[s("el-card",{staticClass:"info-card",attrs:{"body-style":{padding:"0"}}},[s("div",{staticClass:"cardbody",attrs:{align:"start"}},[s("div",{staticClass:"course-info"},[s("div",{staticClass:"name"},[s("span",[e._v(e._s(e.courseName))])]),e._v(" "),s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.courseLoading,expression:"courseLoading"}],staticClass:"grade"},[s("el-row",[s("el-col",{staticClass:"text",attrs:{span:6}},[e._v("课程评分")]),e._v(" "),s("el-col",{attrs:{span:18}},[s("el-rate",{staticStyle:{width:"100%"},attrs:{disabled:"","show-score":"","text-color":"#ff9900","score-template":"{value}"},model:{value:e.courseGrade,callback:function(t){e.courseGrade=t},expression:"courseGrade"}})],1)],1),e._v(" "),s("el-row",[s("el-col",{staticClass:"text",attrs:{span:6}},[e._v("班级数目")]),e._v(" "),s("el-col",{staticClass:"amount",staticStyle:{"margin-top":"2px","padding-left":"5px"},attrs:{span:18}},[e._v(e._s(e.courseClassAmount))])],1),e._v(" "),s("el-row",[s("el-col",{staticClass:"text",attrs:{span:6}},[e._v("选课人数")]),e._v(" "),s("el-col",{staticClass:"amount",staticStyle:{"margin-top":"1px"},attrs:{span:18}},[e._v("男生"+e._s(e.courseAmountBoy)+"人 / 女生"+e._s(e.courseAmountGirl)+"人")])],1)],1)])])]),e._v(" "),s("el-card",{staticClass:"select-card",attrs:{"body-style":{padding:"0"}}},[s("div",{staticClass:"cardbody",attrs:{align:"center"}},[s("div",{staticStyle:{width:"64%"},attrs:{align:"start"}},[s("el-row",{staticClass:"select-title"},[e._v("分析内容")]),e._v(" "),s("el-row",[s("el-cascader",{attrs:{options:e.xyOptions,filterable:"",size:"small"},on:{change:e.handleComparison},model:{value:e.xyIndex,callback:function(t){e.xyIndex=t},expression:"xyIndex"}})],1),e._v(" "),s("el-row",[e.setGradeAttribute?s("el-select",{staticClass:"select",attrs:{size:"small"},model:{value:e.gradeAttribute,callback:function(t){e.gradeAttribute=t},expression:"gradeAttribute"}},e._l(e.gradeOptions,function(e){return s("el-option",{directives:[{name:"show",rawName:"v-show",value:!e.disabled,expression:"!item.disabled"}],key:e.value,attrs:{label:e.label,value:e.value}})}),1):e._e()],1),e._v(" "),s("el-row",{staticClass:"select-title"},[e._v("对比组")]),e._v(" "),s("el-row",[s("el-select",{attrs:{size:"small",filterable:""},on:{change:e.handleDetail},model:{value:e.comparison,callback:function(t){e.comparison=t},expression:"comparison"}},e._l(e.cOptions,function(e){return s("el-option",{directives:[{name:"show",rawName:"v-show",value:!e.disabled,expression:"!item.disabled"}],key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),e.setChapter?s("el-row",[s("el-row",{staticClass:"select-title"},[e._v("选择章节")]),e._v(" "),s("el-row",[s("el-select",{attrs:{size:"small",filterable:""},model:{value:e.chapterSettings,callback:function(t){e.chapterSettings=t},expression:"chapterSettings"}},e._l(e.chapterOptions,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1):e._e(),e._v(" "),s("el-row",{staticClass:"select-title"},[e._v("选择"+e._s(e.cOptions[e.comparison].label))]),e._v(" "),0!==e.comparison&&1!==e.comparison?s("el-row",[s("el-select",{attrs:{multiple:"",size:"small","multiple-limit":e.cOptions[e.comparison].limit+4,filterable:""},on:{change:e.handleDetailValue},model:{value:e.detailValue,callback:function(t){e.detailValue=t},expression:"detailValue"}},e._l(e.detailOptions,function(e){return s("el-option",{directives:[{name:"show",rawName:"v-show",value:!e.self,expression:"!item.self"}],key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1):e._e(),e._v(" "),0===e.comparison?s("el-row",[s("el-row",[s("el-cascader",{attrs:{options:e.studentOptions,filterable:"",size:"small",clearable:""},on:{change:function(t){return e.handleStudent(0)}},model:{value:e.studentMap[0],callback:function(t){e.$set(e.studentMap,0,t)},expression:"studentMap[0]"}})],1),e._v(" "),3!==e.gradeAttribute?s("el-row",[s("el-row",{staticClass:"select"},[s("el-cascader",{attrs:{options:e.studentOptions,filterable:"",size:"small",clearable:""},on:{change:function(t){return e.handleStudent(1)}},model:{value:e.studentMap[1],callback:function(t){e.$set(e.studentMap,1,t)},expression:"studentMap[1]"}})],1),e._v(" "),s("el-row",{staticClass:"select"},[s("el-cascader",{attrs:{options:e.studentOptions,filterable:"",size:"small",clearable:""},on:{change:function(t){return e.handleStudent(2)}},model:{value:e.studentMap[2],callback:function(t){e.$set(e.studentMap,2,t)},expression:"studentMap[2]"}})],1),e._v(" "),s("el-row",{staticClass:"select"},[s("el-cascader",{attrs:{options:e.studentOptions,filterable:"",size:"small",clearable:""},on:{change:function(t){return e.handleStudent(3)}},model:{value:e.studentMap[3],callback:function(t){e.$set(e.studentMap,3,t)},expression:"studentMap[3]"}})],1)],1):e._e()],1):e._e(),e._v(" "),1===e.comparison?s("el-row",[s("el-row",[s("el-cascader",{attrs:{options:e.genderOptions,filterable:"",size:"small",clearable:""},on:{change:function(t){return e.handleGender(0)}},model:{value:e.genderMap[0],callback:function(t){e.$set(e.genderMap,0,t)},expression:"genderMap[0]"}})],1),e._v(" "),s("el-row",{staticClass:"select"},[s("el-cascader",{attrs:{options:e.genderOptions,filterable:"",size:"small",clearable:""},on:{change:function(t){return e.handleGender(1)}},model:{value:e.genderMap[1],callback:function(t){e.$set(e.genderMap,1,t)},expression:"genderMap[1]"}})],1)],1):e._e(),e._v(" "),s("el-row",{staticClass:"select"},[s("el-button",{staticClass:"select-button",attrs:{type:"primary",size:"small",loading:e.drawLoading},on:{click:e.getCharts}},[e._v("确定")])],1)],1)])])],1),e._v(" "),s("el-col",{attrs:{span:16}},[s("el-card",{staticClass:"content-card",attrs:{"body-style":{padding:"0"}}},[s("div",{staticClass:"cardbody"},[s("el-scrollbar",{attrs:{"wrap-style":"height: 650px; margin-top: 5px",native:!1}},[s("div",[s("el-collapse",{staticClass:"collapse",model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[s("el-collapse-item",{attrs:{title:"数据分析",name:"1"}},[s("el-row",{staticStyle:{padding:"10px 20px 0 50px"},attrs:{type:"flex",justify:"start"}},[s("el-select",{attrs:{size:"small",filterable:""},on:{change:e.handleCourse},model:{value:e.courseIndex,callback:function(t){e.courseIndex=t},expression:"courseIndex"}},e._l(e.courseOptions,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-row",[s("div",{staticClass:"my-chart",attrs:{id:"myChart"}})])],1),e._v(" "),s("el-collapse-item",{attrs:{title:"教学反馈",name:"2",id:"start"}},[s("el-row",{staticClass:"chapter-set"},[s("el-col",{staticStyle:{"padding-top":"5px","padding-bottom":"5px"},attrs:{span:7,align:"start"}},[s("el-radio",{staticStyle:{zoom:"90%"},attrs:{label:0},on:{change:e.handleResponse},model:{value:e.responseType,callback:function(t){e.responseType=t},expression:"responseType"}},[e._v("按课程")]),e._v(" "),s("el-radio",{staticStyle:{zoom:"90%"},attrs:{label:1},on:{change:e.handleResponse},model:{value:e.responseType,callback:function(t){e.responseType=t},expression:"responseType"}},[e._v("按章节")])],1),e._v(" "),1===e.responseType?s("el-col",{attrs:{span:9,align:"start"}},[s("el-select",{staticStyle:{width:"250px"},attrs:{filterable:"",size:"small"},on:{change:e.handleChapter},model:{value:e.chapterIndex,callback:function(t){e.chapterIndex=t},expression:"chapterIndex"}},e._l(e.chapterOptions,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1):e._e(),e._v(" "),1===e.responseType?s("el-col",{attrs:{span:8,align:"start"}},[s("el-rate",{staticStyle:{zoom:"90%","margin-top":"8px","margin-left":"25px"},attrs:{disabled:"","show-score":"","text-color":"#ff9900","score-template":"{value}"},model:{value:e.chapterRate,callback:function(t){e.chapterRate=t},expression:"chapterRate"}})],1):e._e()],1),e._v(" "),s("el-row",e._l(e.classInfo,function(t,a){return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.commentLoading,expression:"commentLoading"}],key:a,staticClass:"response",staticStyle:{"margin-top":"10px"},attrs:{align:"start"}},[s("el-row",[s("div",{staticClass:"title"},[e._v("班级"+e._s(t.classNum))])]),e._v(" "),s("el-row",{staticStyle:{"margin-top":"20px"},attrs:{gutter:5}},[s("el-col",{attrs:{span:5,align:"right"}},[0===e.responseType?s("div",{staticClass:"notice"},[e._v("课程评分")]):s("div",{staticClass:"notice"},[e._v("章节评分")])]),e._v(" "),s("el-col",{staticStyle:{"padding-left":"20px"},attrs:{span:14}},[s("el-rate",{staticClass:"rate",attrs:{disabled:"","show-score":"","text-color":"#ff9900","score-template":"{value}"},model:{value:t.rate,callback:function(s){e.$set(t,"rate",s)},expression:"item.rate"}})],1)],1),e._v(" "),s("el-row",{staticStyle:{"margin-top":"20px"},attrs:{gutter:10}},[s("el-col",{attrs:{span:5,align:"end"}},[s("div",{staticClass:"notice"},[e._v(e._s(t.positive)+"人赞赏")])]),e._v(" "),s("el-col",{attrs:{span:14,align:"center"}},[s("vs-bar",{attrs:{percentage:t.percentage,width:90}})],1),e._v(" "),s("el-col",{attrs:{span:5,align:"start"}},[s("div",{staticClass:"notice"},[e._v(e._s(t.negative)+"人吐槽")])])],1)],1)}),0)],1)],1)],1)])],1)])],1)],1)],1)],1)},staticRenderFns:[]};var Oe=s("VU/8")(Ne,ke,!1,function(e){s("WMCM")},"data-v-38e83032",null).exports,$e={name:"feedback",data:function(){return{courseClassID:0,rate:null,textarea:"",half:!0}},methods:{feedbackBack:function(){this.$router.back({path:"/student/courseDetail"})},submit:function(){var e=this,t=this.$route.query.courseClassID;this.courseClassID=t;var s=new URLSearchParams;s.append("courseClassID",this.courseClassID),s.append("studentId",1),s.append("comment",this.textarea),s.append("rate",this.rate),this.$axios.post("http://10.60.38.173:8765/addClassComment",s,{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){console.log(t.data,"feedback"),1==t.data.state&&e.$message("提交成功")}).catch(function(e){console.log(e)})}}},Ae={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-row",[s("el-row",{staticClass:"head"},[s("el-col",{staticStyle:{"padding-top":"20px"},attrs:{span:2}},[s("i",{staticClass:"el-icon-back",on:{click:e.feedbackBack}}),s("span",{staticStyle:{cursor:"pointer"},on:{click:e.feedbackBack}},[e._v("返回")])])],1),e._v(" "),s("el-row",{staticStyle:{"padding-top":"50px"}},[s("el-col",{attrs:{span:14,offset:5}},[s("el-row",[s("p",[e._v("本学期已经结束啦，对课程进行一下评分和评价吧~")]),e._v(" "),s("el-row",{staticStyle:{"padding-bottom":"20px"}},[s("el-col",{attrs:{span:2,offset:9}},[s("span",{staticStyle:{"font-size":"13px"}},[e._v("评分：")])]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-rate",{attrs:{colors:["#99A9BF","#F7BA2A","#FF9900"],"allow-half":e.half},model:{value:e.rate,callback:function(t){e.rate=t},expression:"rate"}})],1)],1),e._v(" "),s("el-input",{attrs:{type:"textarea",rows:6,placeholder:"请输入",autosize:{minRows:6,maxRows:10}},model:{value:e.textarea,callback:function(t){e.textarea=t},expression:"textarea"}})],1),e._v(" "),s("el-row",{staticStyle:{"padding-top":"20px"}},[s("el-col",{attrs:{span:2,offset:22}},[s("el-button",{attrs:{size:"mini"},on:{click:e.submit}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var ze=s("VU/8")($e,Ae,!1,function(e){s("sMsM"),s("j796")},"data-v-7f34efbc",null).exports,Te={name:"courseList",data:function(){return{rate:null,textarea:"",items:[{courseInfo:{courseID:1,teacherID:433,courseName:"JavaEE",teacherName:"范鸿飞",courseYear:2018,courseSemester:"秋季",currentExerciseChapter:null,startTime:"2018-09-01",endTime:"2019-01-31"},courseClass:{id:1,courseID:1,classNum:1,classCode:"100001"}},{courseInfo:{courseID:2,teacherID:433,courseName:"JavaEE",teacherName:"范鸿飞",courseYear:2018,courseSemester:"秋季",currentExerciseChapter:null,startTime:"2018-09-01",endTime:"2019-01-31"},courseClass:{id:2,courseID:2,classNum:1,classCode:"100002"}},{courseInfo:{courseID:3,teacherID:433,courseName:"JavaEE",teacherName:"范鸿飞",courseYear:2018,courseSemester:"秋季",currentExerciseChapter:null,startTime:"2018-09-01",endTime:"2019-01-31"},courseClass:{id:3,courseID:3,classNum:1,classCode:"100003"}}],analysisMode:!1,allCourse:[]}},created:function(){var e=this;this.$axios.get("http://10.60.38.173:8765/getAllCourses",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){1==t.data.state&&(e.allCourse=t.data.data,console.log(e.allCourse,"allcourse"))}).catch(function(e){console.log(e)})},methods:{edit:function(){this.$router.push({path:"/adminManage/courseGraph"})}}},Fe={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-row",{staticStyle:{"padding-top":"20px"}},[s("el-col",{attrs:{span:20,offset:2}},[s("el-row",[s("el-col",{staticStyle:{"margin-top":"10px"},attrs:{span:4}},[s("el-button",{attrs:{size:"mini"},on:{click:e.edit}},[e._v("编辑课程")])],1)],1),e._v(" "),s("el-row",e._l(e.allCourse,function(t,a){return s("el-col",{key:a,attrs:{span:7,offset:1}},[s("el-card",{staticStyle:{margin:"20px 0"},attrs:{"body-style":{padding:0}}},[s("el-row",{staticClass:"top"},[s("p",{attrs:{id:"name"}},[e._v(e._s(t.courseName))]),e._v(" "),s("el-row",[s("el-col",{staticStyle:{"margin-top":"10px"},attrs:{span:5,offset:18}},[s("span",{staticStyle:{"font-size":"10px",color:"rgb(238, 235, 235)"}},[e._v("老师："+e._s(t.teacherName))])])],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:5,offset:18}},[s("span",{staticStyle:{"font-size":"10px",color:"rgb(238, 235, 235)"}},[e._v("ID："+e._s(t.teacherID))])])],1)],1),e._v(" "),s("el-row",{staticClass:"bottom"},[s("el-row"),e._v(" "),s("el-row",{staticStyle:{"padding-bottom":"10px"}},[s("el-col",[e._v(e._s(t.courseYear+t.courseSemester))])],1),e._v(" "),s("el-row",{staticStyle:{"padding-bottom":"10px"}},[s("el-col",[e._v(e._s(t.startTime+" - "+t.endTime))])],1)],1)],1)],1)}),1)],1)],1)],1)},staticRenderFns:[]};var Le=s("VU/8")(Te,Fe,!1,function(e){s("e76U"),s("UfQ2")},"data-v-5eecd0c0",null).exports,je={name:"teacherList",data:function(){return{rate:null,textarea:"",teachers:[],sels:[],listLoading:!1}},created:function(){var e=this;this.$axios.get("http://10.60.38.173:8765/getAllCourses",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){1==t.data.state&&(e.teachers=t.data.data)}).catch(function(e){console.log(e)})},methods:{edit:function(){this.$router.push({path:"/adminManage/edit"})},selsChange:function(e){this.sels=e},handleView:function(){this.$router.push({path:"/adminManage/chart"})}}},Be={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-row",{staticStyle:{"padding-top":"20px"}},[s("el-col",{attrs:{span:20,offset:3}},[s("el-row",[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.teachers,"highlight-current-row":""},on:{"selection-change":e.selsChange}},[s("el-table-column",{attrs:{type:"selection",width:"50"}}),e._v(" "),s("el-table-column",{attrs:{prop:"courseID",label:"课程编号",width:"120",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"courseName",label:"课程名",width:"180",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"teacherName",label:"教师姓名",width:"120",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"teacherID",label:"教师编号",width:"120",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"courseYear",label:"年份",width:"140",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"courseSemester",label:"学期",width:"140",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"startTime",label:"开课时间",width:"150",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"endTime",label:"结课时间",width:"150",sortable:""}})],1)],1)],1)],1)],1)},staticRenderFns:[]};var Ee=s("VU/8")(je,Be,!1,function(e){s("/iGr"),s("Y+q6")},"data-v-5dbe5c58",null).exports,Pe=s("bOdI"),Re=s.n(Pe),qe={name:"courseAnalysis",data:function(){var e;return e={activeNames:["1"],courseGrade:0,courseID:0,courseAmountBoy:0,courseAmountGirl:0,courseClassAmount:0,courseLoading:!1,courseOptions:[],courseSettings:0,setCourse:!1,xyOptions:[{value:0,label:"选课人数",children:[{value:0,label:"按课程",xyValue:0,xName:"课程",yName:"选课人数"}]},{value:1,label:"课程成绩",children:[{value:0,label:"按年份",xyValue:1,xName:"年份",yName:"课程成绩"},{value:1,label:"按学期",xyValue:2,xName:"学期",yName:"课程成绩"},{value:2,label:"按课程",xyValue:3,xName:"课程",yName:"课程成绩"}]},{value:2,label:"课程评分",children:[{value:0,label:"按年份",xyValue:4,xName:"年份",yName:"课程评分"},{value:1,label:"按学期",xyValue:5,xName:"学期",yName:"课程评分"},{value:2,label:"按课程",xyValue:6,xName:"课程",yName:"课程评分"}]}],cOptions:[{value:0,label:"教师",disabled:!1,limit:4},{value:1,label:"课程",disabled:!0,limit:4},{value:2,label:"学期",disabled:!1,limit:4},{value:3,label:"学年",disabled:!1,limit:4}],detail:[],xy:0,comparison:3,xyIndex:[0,0],xData:[],detailValue:[],teacherOptions:[]},Re()(e,"courseOptions",[]),Re()(e,"semesterOptions",[]),Re()(e,"yearOptions",[]),Re()(e,"chapter",0),Re()(e,"colors",["#0997F7","#92DD22","#FFFF33","#FFAAEE"]),Re()(e,"seriesData",[]),Re()(e,"colorOptions",[]),Re()(e,"legendData",[]),Re()(e,"drawLoading",!1),Re()(e,"drawCount",0),e},methods:{goBack:function(){if(window.history.length<=1)return this.$router.push({path:"/"}),!1;this.$router.go(-1)},getTeacherOptions:function(){var e=this;this.teacherOptions=[],this.$http.get("http://10.60.38.173:8765/getTeacherInfoByNID",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200===t.status)for(var s=JSON.parse(t.bodyText),a=0,r=0;a<s.data.length;)-1===e.search(e.teacherOptions,s.data[a].courseInfo.teacherName,"label")&&(e.teacherOptions.push({value:r,label:s.data[a].courseInfo.teacherName,id:s.data[a].courseInfo.teacherID}),r++),a++;else e.$message({type:"error",message:"加载失败!"})},function(t){e.$message({type:"error",message:"加载失败!"})})},getCourseTeacherOptions:function(e){var t=this;this.$http.get("http://10.60.38.173:8765/getTeacherInfoByNID?courseNameID="+this.courseOptions[e].id,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(s){if(200===s.status){for(var a=JSON.parse(s.bodyText),r=0,i=0;r<a.data.length;){var o=t.search(t.courseOptions[e].teachers,a.data[r].courseInfo.teacherID,"id");-1!==o?t.courseOptions[e].teachers[o].courses.push({courseID:a.data[r].courseInfo.courseID,semester:a.data[r].courseInfo.courseYear+a.data[r].courseInfo.courseSemester,score:0,rate:0}):(t.courseOptions[e].teachers.push({value:i,label:a.data[r].courseInfo.teacherName,id:a.data[r].courseInfo.teacherID,courses:[{courseID:a.data[r].courseInfo.courseID,semester:a.data[r].courseInfo.courseYear+a.data[r].courseInfo.courseSemester,score:0,rate:0}]}),i++),r++}for(var n=0;n<t.courseOptions[e].teachers.length;n++)for(var l=0;l<t.courseOptions[e].teachers[n].courses.length;l++)t.getBaseData(t.courseOptions[e].teachers[n].courses[l].courseID,e,n,l);t.courseLoading=!1}else t.courseLoading=!1,t.$message({type:"error",message:"加载失败!"})},function(e){t.courseLoading=!1,t.$message({type:"error",message:"加载失败!"})})},getSemesterOptions:function(){var e=this;this.semesterOptions=[],this.$http.get("http://10.60.38.173:8765/getAllCourses",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200===t.status)for(var s=JSON.parse(t.bodyText),a=0,r=0;a<s.data.length;){for(var i=!0,o=s.data[a].courseYear+s.data[a].courseSemester,n=0;n<e.semesterOptions.length;n++)if(e.semesterOptions[n].label===o){i=!1;break}i&&(e.semesterOptions.push({value:r,label:o}),r++),a++}else e.$message({type:"error",message:"加载失败!"})},function(t){e.$message({type:"error",message:"加载失败!"})})},getYearOptions:function(){var e=this;this.yearOptions=[],this.$http.get("http://10.60.38.173:8765/getAllCourses",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200===t.status){for(var s=JSON.parse(t.bodyText),a=0,r=0;a<s.data.length;){for(var i=s.data[a].courseYear,o=!0,n=0;n<e.yearOptions.length;n++)if(e.yearOptions[n].label===i){o=!1;break}o&&(e.yearOptions.push({value:r,label:i}),r++),a++}for(var l=e.yearOptions.length<4?e.yearOptions.length:4,c=0;c<l;c++)e.detailValue.push(c),e.detail.push(e.yearOptions[c]);e.getCharts()}else e.$message({type:"error",message:"加载失败!"})},function(t){e.$message({type:"error",message:"加载失败!"})})},getCourseOptions:function(){var e=this;this.courseOptions=[],this.$http.get("http://10.60.38.173:8765/getCourseList",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(200===t.status){for(var s=JSON.parse(t.bodyText),a=0;a<s.data.length;)e.courseOptions.push({value:a,label:s.data[a].courseName,id:s.data[a].courseNameID,teachers:[]}),e.getCourseTeacherOptions(a),a++;e.getYearOptions(),e.getSemesterOptions()}else e.$message({type:"error",message:"加载失败!"})},function(t){e.$message({type:"error",message:"加载失败!"})})},handleComparison:function(e){switch(this.xy=this.xyOptions[e[0]].children[e[1]].xyValue,this.drawLoading=!1,this.xy){case 0:this.comparison=0,this.detail=[],this.detailValue=[],this.setCourse=!1;for(var t=0;t<this.cOptions.length;t++)this.cOptions[t].disabled=1===t;break;case 1:this.comparison=0,this.detail=[],this.detailValue=[],this.setCourse=!0;for(var s=0;s<this.cOptions.length;s++)this.cOptions[s].disabled=s>1;break;case 2:this.comparison=0,this.detail=[],this.detailValue=[],this.setCourse=!0;for(var a=0;a<this.cOptions.length;a++)this.cOptions[a].disabled=a>1;break;case 3:this.comparison=0,this.detail=[],this.detailValue=[],this.setCourse=!1;for(var r=0;r<this.cOptions.length;r++)this.cOptions[r].disabled=1===r;break;case 4:this.comparison=0,this.detail=[],this.detailValue=[],this.setCourse=!0;for(var i=0;i<this.cOptions.length;i++)this.cOptions[i].disabled=!(i<2);break;case 5:this.comparison=0,this.detail=[],this.detailValue=[],this.setCourse=!0;for(var o=0;o<this.cOptions.length;o++)this.cOptions[o].disabled=!(o<2);break;case 6:this.comparison=0,this.detail=[],this.detailValue=[],this.setCourse=!1;for(var n=0;n<this.cOptions.length;n++)this.cOptions[n].disabled=1===n}},handleCourseDetail:function(){this.drawLoading=!1,this.detailValue=[],this.detail=[]},handleDetail:function(e){switch(this.drawLoading=!1,this.detailValue=[],this.detail=[],e){case 0:3===this.xy||6===this.xy?this.setCourse=!1:this.setCourse=!0;break;case 1:this.setCourse=!1}},handleDetailValue:function(e){this.detail=[];for(var t=0;t<this.detailValue.length;t++)this.detail.push(this.detailOptions[this.detailValue[t]])},getBaseData:function(e,t,s,a){var r=this;this.$http.get("http://10.60.38.173:8765/getCourseClassAvgScore?courseID="+e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200===e.status){var i=JSON.parse(e.bodyText);1===i.state&&(r.courseOptions[t].teachers[s].courses[a].score=(Number(i.data.courseBoyAvgScore+i.data.courseGirlAgeScore)/2).toFixed(2),r.courseOptions[t].teachers[s].courses[a].rate=(Number(i.data.courseGirlAvgRate+i.data.courseBoyAvgRate)/2).toFixed(1),console.log("["+t+","+s+","+a+"]"))}else r.$message({type:"error",message:"加载失败!"})},function(e){r.$message({type:"error",message:"加载失败!"})})},getTeacherNumData:function(e,t){var s=this;this.$http.get("http://10.60.38.173:8765/getStudentNumByTeacher?teacherID="+e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200===e.status){var a=JSON.parse(e.bodyText);if(1===a.state)for(var r in a.data){var i=s.xData.indexOf(r);-1!==i&&(s.seriesData[t].data[i]=a.data[r])}s.drawChart()}else s.$message({type:"error",message:"加载失败!"})},function(e){s.$message({type:"error",message:"加载失败!"})})},getSemesterNumData:function(e,t,s){var a=this;this.$http.get("/http://10.60.38.173:8765/getStudentNumBySemesterAndYear?year="+e+"&semester="+t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200===e.status){var t=JSON.parse(e.bodyText);if(1===t.state)for(var r in t.data){var i=a.xData.indexOf(r);-1!==i&&(a.seriesData[s].data[i]=t.data[r])}a.drawChart()}else a.$message({type:"error",message:"加载失败!"})},function(e){a.$message({type:"error",message:"加载失败!"})})},getYearNumData:function(e,t){var s=this;this.$http.get("http://10.60.38.173:8765/getStudentNumByYear?year="+e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200===e.status){var a=JSON.parse(e.bodyText);if(1===a.state)for(var r in a.data){var i=s.xData.indexOf(r);-1!==i&&(s.seriesData[t].data[i]=a.data[r])}s.drawChart()}else s.$message({type:"error",message:"加载失败!"})},function(e){s.$message({type:"error",message:"加载失败!"})})},getTeacherYearRateData:function(e,t,s){var a=this;this.$http.get("http://10.60.38.173:8765/getCourseYearAvgScoreRate?courseNameID="+e+"&teacherID="+t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200===e.status){var t=JSON.parse(e.bodyText);if(1===t.state)for(var r in t.data.year){var i=a.xData.indexOf(Number(r));-1!==i&&(a.seriesData[s].data[i]=Number(t.data.year[r].rate).toFixed(1))}a.drawChart()}else a.$message({type:"error",message:"加载失败!"})},function(e){a.$message({type:"error",message:"加载失败!"})})},getYearRateData:function(e,t,s,a){var r=this;this.$http.get("http://10.60.38.173:8765/getRateBySemesterAndYear?courseNameID="+e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200===e.status){var i=JSON.parse(e.bodyText);if(1===i.state){for(var o=0,n=0,l=0;o<i.data.length;)i.data[o].semesterAndYear.year==a&&(l+=i.data[o].avgRate,n++),o++;0!==n&&(l=(l/n).toFixed(1)),r.seriesData[t].data[s]=l}r.drawChart()}else r.$message({type:"error",message:"加载失败!"})},function(e){r.$message({type:"error",message:"加载失败!"})})},getTeacherSemesterRateData:function(e,t,s){var a=this;this.$http.get("http://10.60.38.173:8765/getCourseYearAvgScoreRate?courseNameID="+e+"&teacherID="+t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200===e.status){var t=JSON.parse(e.bodyText);if(1===t.state)for(var r in t.data.semester){var i=a.xData.indexOf(r);-1!==i&&(a.seriesData[s].data[i]=Number(t.data.semester[r].rate).toFixed(1))}a.drawChart()}else a.$message({type:"error",message:"加载失败!"})},function(e){a.$message({type:"error",message:"加载失败!"})})},getSemesterRateData:function(e,t,s,a){var r=this;this.$http.get("http://10.60.38.173:8765/getRateBySemesterAndYear?courseNameID="+e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200===e.status){var i=JSON.parse(e.bodyText);if(1===i.state){for(var o=0,n=0,l=0;o<i.data.length;)i.data[o].semesterAndYear.year+i.data[o].semesterAndYear.semester===a&&(l+=i.data[o].avgRate,n++),o++;0!==n&&(l=(l/n).toFixed(1)),r.seriesData[t].data[s]=l}r.drawChart()}else r.$message({type:"error",message:"加载失败!"})},function(e){r.$message({type:"error",message:"加载失败!"})})},getTeacherYearScoreData:function(e,t,s){var a=this;this.$http.get("http://10.60.38.173:8765/getCourseYearAvgScoreRate?courseNameID="+e+"&teacherID="+t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200===e.status){var t=JSON.parse(e.bodyText);if(1===t.state)for(var r in t.data.year){var i=a.xData.indexOf(Number(r));-1!==i&&(a.seriesData[s].data[i]=Number(t.data.year[r].score).toFixed(2))}a.drawChart()}else a.$message({type:"error",message:"加载失败!"})},function(e){a.$message({type:"error",message:"加载失败!"})})},getYearScoreData:function(e,t){var s=this;this.$http.get("http://10.60.38.173:8765/getCourseYearAvgScoreRate?courseNameID="+e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(a){if(200===a.status){var r=JSON.parse(a.bodyText);if(1===r.state)for(var i in r.data.year){if(1===s.xy){var o=s.xData.indexOf(Number(i));-1!==o&&(s.seriesData[t].data[o]=Number(r.data.year[i].score).toFixed(2))}if(3===s.xy){var n=s.search(s.courseOptions,e,"id"),l=s.search(s.detail,Number(i),"label");-1!==l&&(s.seriesData[l].data[n]=Number(r.data.year[i].score).toFixed(2))}}s.drawChart()}else s.$message({type:"error",message:"加载失败!"})},function(e){s.$message({type:"error",message:"加载失败!"})})},getTeacherSemesterScoreData:function(e,t,s){var a=this;this.$http.get("http://10.60.38.173:8765/getCourseYearAvgScoreRate?courseNameID="+e+"&teacherID="+t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(200===e.status){var t=JSON.parse(e.bodyText);if(1===t.state)for(var r in t.data.semester){var i=a.xData.indexOf(r);-1!==i&&(a.seriesData[s].data[i]=Number(t.data.semester[r].score).toFixed(2))}a.drawChart()}else a.$message({type:"error",message:"加载失败!"})},function(e){a.$message({type:"error",message:"加载失败!"})})},getSemesterScoreData:function(e,t){var s=this;this.$http.get("http://10.60.38.173:8765/getCourseYearAvgScoreRate?courseNameID="+e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(a){if(200===a.status){var r=JSON.parse(a.bodyText);if(1===r.state)for(var i in r.data.semester){if(2===s.xy){var o=s.xData.indexOf(i);-1!==o&&(s.seriesData[t].data[o]=Number(r.data.semester[i].score).toFixed(2))}if(3===s.xy){var n=s.search(s.courseOptions,e,"id"),l=s.search(s.detail,i,"label");-1!==l&&(s.seriesData[l].data[n]=Number(r.data.semester[i].score).toFixed(2))}}s.drawChart()}else s.$message({type:"error",message:"加载失败!"})},function(e){s.$message({type:"error",message:"加载失败!"})})},getCharts:function(){if(0!==this.detail.length)switch(this.xData=new Array,this.seriesData=new Array,this.colorOptions=new Array,this.legendData=new Array,this.drawLoading=!0,this.drawCount=0,this.xy){case 0:for(var e=0;e<this.courseOptions.length;e++)this.xData.push(this.courseOptions[e].label);switch(this.comparison){case 0:for(var t=0;t<this.detail.length;t++)this.seriesData.push({name:this.detail[t].label,type:"bar",barGap:0,data:new Array(this.xData.length)}),this.colorOptions.push(this.colors[t]),this.legendData.push(this.detail[t].label),this.getTeacherNumData(this.detail[t].id,t);break;case 2:for(var s=0;s<this.detail.length;s++)this.seriesData.push({name:this.detail[s].label,type:"bar",barGap:0,data:new Array(this.xData.length)}),this.colorOptions.push(this.colors[s]),this.legendData.push(this.detail[s].label),this.getSemesterNumData(this.detail[s].label.substr(0,4),this.detail[s].label.substr(4),s);break;case 3:for(var a=0;a<this.detail.length;a++)this.seriesData.push({name:this.detail[a].label,type:"bar",barGap:0,data:new Array(this.xData.length)}),this.colorOptions.push(this.colors[a]),this.legendData.push(this.detail[a].label.toString()),this.getYearNumData(this.detail[a].label,a)}break;case 1:for(var r=0;r<this.yearOptions.length;r++)this.xData.push(this.yearOptions[r].label);switch(this.comparison){case 0:for(var i=0;i<this.detail.length;i++){this.seriesData.push({name:this.detail[i].label,type:"bar",barGap:0,data:new Array(this.xData.length)}),this.colorOptions.push(this.colors[i]),this.legendData.push(this.detail[i].label);var o=this.courseOptions[this.courseSettings];this.getTeacherYearScoreData(o.id,this.detail[i].id,i)}break;case 1:for(var n=0;n<this.detail.length;n++)this.seriesData.push({name:this.detail[n].label,type:"bar",barGap:0,data:new Array(this.xData.length)}),this.colorOptions.push(this.colors[n]),this.legendData.push(this.detail[n].label),this.getYearScoreData(this.detail[n].id,n)}break;case 2:for(var l=0;l<this.semesterOptions.length;l++)this.xData.push(this.semesterOptions[l].label);switch(this.comparison){case 0:for(var c=0;c<this.detail.length;c++){this.seriesData.push({name:this.detail[c].label,type:"bar",barGap:0,data:new Array(this.xData.length)}),this.colorOptions.push(this.colors[c]),this.legendData.push(this.detail[c].label);var h=this.courseOptions[this.courseSettings];this.getTeacherSemesterScoreData(h.id,this.detail[c].id,c)}break;case 1:for(var u=0;u<this.detail.length;u++)this.seriesData.push({name:this.detail[u].label,type:"bar",barGap:0,data:new Array(this.xData.length)}),this.colorOptions.push(this.colors[u]),this.legendData.push(this.detail[u].label),this.getSemesterScoreData(this.detail[u].id,u)}break;case 3:for(var d=0;d<this.courseOptions.length;d++)this.xData.push(this.courseOptions[d].label);switch(this.comparison){case 0:for(var p=0;p<this.detail.length;p++){this.seriesData.push({name:this.detail[p].label,type:"bar",barGap:0,data:new Array(this.xData.length)}),this.colorOptions.push(this.colors[p]),this.legendData.push(this.detail[p].label);for(var m=0;m<this.courseOptions.length;m++){var g=this.search(this.courseOptions[m].teachers,this.detail[p].id,"id");if(-1!==g){for(var f=0,v=this.courseOptions[m].teachers[g].courses.length,x=0;x<v;x++)f+=this.courseOptions[m].teachers[g].courses[x].score;0!==v&&(this.seriesData[p].data[m]=(f/v).toFixed(2))}}this.drawChart()}break;case 2:for(var b=0;b<this.detail.length;b++){this.seriesData.push({name:this.detail[b].label,type:"bar",barGap:0,data:new Array(this.xData.length)}),this.colorOptions.push(this.colors[b]),this.legendData.push(this.detail[b].label);for(var y=0;y<this.courseOptions.length;y++)this.getSemesterScoreData(this.courseOptions[y].id,b)}break;case 3:for(var w=0;w<this.detail.length;w++){this.seriesData.push({name:this.detail[w].label,type:"bar",barGap:0,data:new Array(this.xData.length)}),this.colorOptions.push(this.colors[w]),this.legendData.push(this.detail[w].label.toString());for(var I=0;I<this.courseOptions.length;I++)this.getYearScoreData(this.courseOptions[I].id,w)}}break;case 4:for(var _=0;_<this.yearOptions.length;_++)this.xData.push(this.yearOptions[_].label);switch(this.comparison){case 0:for(var C=0;C<this.detail.length;C++){this.seriesData.push({name:this.detail[C].label,type:"bar",barGap:0,data:new Array(this.xData.length)}),this.colorOptions.push(this.colors[C]),this.legendData.push(this.detail[C].label);var D=this.courseOptions[this.courseSettings];this.getTeacherYearRateData(D.id,this.detail[C].id,C)}break;case 1:for(var S=0;S<this.detail.length;S++){this.seriesData.push({name:this.detail[S].label,type:"bar",barGap:0,data:new Array(this.xData.length)}),this.colorOptions.push(this.colors[S]),this.legendData.push(this.detail[S].label);for(var N=0;N<this.xData.length;N++)this.getYearRateData(this.detail[S].id,S,N,this.xData[N])}}break;case 5:for(var k=0;k<this.semesterOptions.length;k++)this.xData.push(this.semesterOptions[k].label);switch(this.comparison){case 0:for(var O=0;O<this.detail.length;O++){this.seriesData.push({name:this.detail[O].label,type:"bar",barGap:0,data:new Array(this.xData.length)}),this.colorOptions.push(this.colors[O]),this.legendData.push(this.detail[O].label);var $=this.courseOptions[this.courseSettings];this.getTeacherSemesterRateData($.id,this.detail[O].id,O)}break;case 1:for(var A=0;A<this.detail.length;A++){this.seriesData.push({name:this.detail[A].label,type:"bar",barGap:0,data:new Array(this.xData.length)}),this.colorOptions.push(this.colors[A]),this.legendData.push(this.detail[A].label);for(var z=0;z<this.xData.length;z++)this.getSemesterRateData(this.detail[A].id,A,z,this.xData[z])}}break;case 6:for(var T=0;T<this.courseOptions.length;T++)this.xData.push(this.courseOptions[T].label);switch(this.comparison){case 0:for(var F=0;F<this.detail.length;F++){this.seriesData.push({name:this.detail[F].label,type:"bar",barGap:0,data:new Array(this.xData.length)}),this.colorOptions.push(this.colors[F]),this.legendData.push(this.detail[F].label);for(var L=0;L<this.courseOptions.length;L++){var j=this.search(this.courseOptions[L].teachers,this.detail[F].id,"id");if(-1!==j){for(var B=0,E=this.courseOptions[L].teachers[j].courses.length,P=0;P<E;P++)B+=this.courseOptions[L].teachers[j].courses[P].rate;0!==E&&(this.seriesData[F].data[L]=(B/E).toFixed(1))}}this.drawChart()}break;case 2:for(var R=0;R<this.detail.length;R++){this.seriesData.push({name:this.detail[R].label,type:"bar",barGap:0,data:new Array(this.xData.length)}),this.colorOptions.push(this.colors[R]),this.legendData.push(this.detail[R].label);for(var q=0;q<this.courseOptions.length;q++)this.getSemesterRateData(this.courseOptions[q].id,R,q,this.detail[R].label)}break;case 3:for(var V=0;V<this.detail.length;V++){this.seriesData.push({name:this.detail[V].label,type:"bar",barGap:0,data:new Array(this.xData.length)}),this.colorOptions.push(this.colors[V]),this.legendData.push(this.detail[V].label.toString());for(var G=0;G<this.courseOptions.length;G++)this.getYearRateData(this.courseOptions[G].id,V,G,this.detail[V].label)}}}else this.$message({type:"warning",message:"请添加选项!"})},drawChart:function(){var e=this.$echarts.init(document.getElementById("myChart"));e.clear(),this.drawCount+=1,console.log(this.xData.length),e.setOption({color:this.colorOptions,tooltip:{trigger:"axis",axisPointer:{type:"cross"}},legend:{data:this.legendData},dataZoom:[{type:"inside",filterMode:"filter",xAxisIndex:[0],startValue:0,endValue:7,orient:"horizontal",minValueSpan:5}],toolbox:{show:!0,orient:"vertical",right:"20px",top:"center",itemGap:20,feature:{mark:{show:!0},magicType:{show:!0,type:["line","bar","stack","tiled"]},restore:{show:!0},saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",name:this.xyOptions[this.xyIndex[0]].children[this.xyIndex[1]].xName,axisTick:{show:!1},data:this.xData}],yAxis:[{name:this.xyOptions[this.xyIndex[0]].children[this.xyIndex[1]].yName,type:"value"}],series:this.seriesData}),this.drawCount===this.detail.length&&(this.drawLoading=!1)},objDeepCopy:function(e){var t=e instanceof Array?[]:{};for(var s in e)e.hasOwnProperty(s)&&(t[s]="object"===E()(e[s])?this.objDeepCopy(e[s]):e[s]);return t},search:function(e,t,s){for(var a=0;a<e.length;a++)if(e[a][s]===t)return a;return-1}},created:function(){this.getCourseOptions(),this.getTeacherOptions(),this.courseLoading=!0},computed:{detailOptions:function(){var e=[];switch(this.comparison){case 0:e=this.setCourse?this.courseOptions[this.courseSettings].teachers:this.teacherOptions;break;case 1:e=this.courseOptions;break;case 2:e=this.semesterOptions;break;case 3:e=this.yearOptions}return e}}},Ve={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-container",[s("el-main",{staticClass:"background"},[s("el-row",{staticStyle:{margin:"0 auto",width:"90%","max-height":"685px"},attrs:{gutter:10,type:"flex",justify:"center"}},[s("el-col",{attrs:{span:2,align:"right"}},[s("div",[s("el-button",{staticStyle:{"box-shadow":"0 0 8px 1px #dbdbdb"},attrs:{circle:""},on:{click:e.goBack}},[s("i",{staticClass:"el-icon-back"})])],1)]),e._v(" "),s("el-col",{attrs:{span:6,align:"right"}},[s("el-card",{staticClass:"info-card",attrs:{"body-style":{padding:"0"}}},[s("div",{staticClass:"cardbody",attrs:{align:"start"}},[s("div",{staticClass:"course-info"},[s("div",{staticClass:"name"},[s("span",[e._v("课程分析")])]),e._v(" "),s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.courseLoading,expression:"courseLoading"}],staticClass:"grade"},[s("el-row",[s("el-col",{staticClass:"text",attrs:{span:6}},[e._v("课程数目")]),e._v(" "),s("el-col",{staticClass:"amount",staticStyle:{"margin-top":"1px","padding-left":"5px"},attrs:{span:18}},[e._v(e._s(e.courseOptions.length))])],1),e._v(" "),s("el-row",[s("el-col",{staticClass:"text",attrs:{span:6}},[e._v("老师数目")]),e._v(" "),s("el-col",{staticClass:"amount",staticStyle:{"margin-top":"1px","padding-left":"5px"},attrs:{span:18}},[e._v(e._s(e.teacherOptions.length)+"人")])],1),e._v(" "),s("el-row",[s("el-col",{staticClass:"text",attrs:{span:6}},[e._v("学生数目")]),e._v(" "),s("el-col",{staticClass:"amount",staticStyle:{"margin-top":"1px","padding-left":"5px"},attrs:{span:18}},[e._v("271人")])],1)],1)])])]),e._v(" "),s("el-card",{staticClass:"select-card",attrs:{"body-style":{padding:"0"}}},[s("div",{staticClass:"cardbody",attrs:{align:"center"}},[s("div",{staticStyle:{width:"64%"},attrs:{align:"start"}},[s("el-row",{staticClass:"select-title"},[e._v("分析内容")]),e._v(" "),s("el-row",[s("el-cascader",{attrs:{options:e.xyOptions,filterable:"",size:"small"},on:{change:e.handleComparison},model:{value:e.xyIndex,callback:function(t){e.xyIndex=t},expression:"xyIndex"}})],1),e._v(" "),s("el-row",{staticClass:"select-title"},[e._v("对比组")]),e._v(" "),s("el-row",[s("el-select",{attrs:{size:"small",filterable:""},on:{change:e.handleDetail},model:{value:e.comparison,callback:function(t){e.comparison=t},expression:"comparison"}},e._l(e.cOptions,function(e){return s("el-option",{directives:[{name:"show",rawName:"v-show",value:!e.disabled,expression:"!item.disabled"}],key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),e.setCourse?s("el-row",[s("el-row",{staticClass:"select-title"},[e._v("选择课程")]),e._v(" "),s("el-row",[s("el-select",{attrs:{size:"small",filterable:""},on:{change:e.handleCourseDetail},model:{value:e.courseSettings,callback:function(t){e.courseSettings=t},expression:"courseSettings"}},e._l(e.courseOptions,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1):e._e(),e._v(" "),s("el-row",{staticClass:"select-title"},[e._v("选择"+e._s(e.cOptions[e.comparison].label))]),e._v(" "),s("el-row",[s("el-select",{attrs:{multiple:"",size:"small","multiple-limit":e.cOptions[e.comparison].limit+4,filterable:""},on:{change:e.handleDetailValue},model:{value:e.detailValue,callback:function(t){e.detailValue=t},expression:"detailValue"}},e._l(e.detailOptions,function(e){return s("el-option",{directives:[{name:"show",rawName:"v-show",value:!e.self,expression:"!item.self"}],key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-row",{staticClass:"select"},[s("el-button",{staticClass:"select-button",attrs:{type:"primary",size:"small",loading:e.drawLoading},on:{click:e.getCharts}},[e._v("确定")])],1)],1)])])],1),e._v(" "),s("el-col",{attrs:{span:16}},[s("el-card",{staticClass:"content-card",attrs:{"body-style":{padding:"0"}}},[s("div",{staticClass:"cardbody"},[s("el-scrollbar",{attrs:{"wrap-style":"height: 650px; margin-top: 5px",native:!1}},[s("div",[s("el-collapse",{staticClass:"collapse",model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[s("el-collapse-item",{attrs:{title:"数据分析",name:"1"}},[s("el-row",[s("div",{staticClass:"my-chart",attrs:{id:"myChart"}})])],1)],1)],1)])],1)])],1)],1)],1)],1)},staticRenderFns:[]};var Ge=s("VU/8")(qe,Ve,!1,function(e){s("GA9S")},"data-v-5884d8f1",null).exports,Me={name:"courseGraph",data:function(){return{screenWidth:{width:window.screen.width},isAddCourse:!0,isAddClass:!1,courseName:0,isEditCourse:!1,isEditClass:!1,isDelCourse:!1,isAddClassNum:!1,dialog1:!1,dialog2:!1,editClassNum:!1,dataIndex:0,rowIndex:0,data:[],links:[],allCourse:[],dupCourse:[],loading:!0,pickerOptions0:this.startTime(),pickerOptions1:this.endTime(),pickerOptions2:this.courseYear(),courses:[],relayForm:{},classNum:null,ruleForm1:{courseName:"",successor:{}},ruleForm2:{courseName:"",successor:{}},ruleForm3:{teacherName:"",teacherID:null,courseYear:"",courseSemester:"",startTime:null,endTime:null,classNum:null},ruleForm4:{teacherName:"",teacherID:null,courseYear:"",courseSemester:"",startTime:null,endTime:null},rules12:{courseName:[{required:!0,message:"请输入课程名称",trigger:"blur"},{min:1,max:15,message:"长度在 1 到 15 个字符",trigger:"blur"}],successor:[{required:!1,message:"请选择前继课程",trigger:"blur"}]},rules34:{teacherName:[{required:!0,message:"请输入教师姓名",trigger:"blur"},{min:1,max:10,message:"长度在 1 到 10 个字符",trigger:"blur"}],teacherID:[{required:!0,message:"请输入教师工号",trigger:"blur"}],courseYear:[{type:"date",required:!0,message:"请选择年份",trigger:"change"}],courseSemester:[{required:!0,message:"请选择春/秋季",trigger:"change"}],startTime:[{type:"date",required:!0,message:"请选择开始日期",trigger:"change"}],endTime:[{type:"date",required:!0,message:"请选择结束日期",trigger:"change"}],classNum:[{required:!0,message:"请输入班级个数"},{type:"number",message:"必须为数字值"}]},multipleSelection:[]}},created:function(){var e=this;d.a.get("http://10.60.38.173:8765/getAllCoursesRelation",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(1==t.data.state){e.allCourse=t.data.data,console.log(e.allCourse,"allcourse");var s=e.allCourse.length;0!=s?e.set(s):e.draw()}else e.$message(t.data.message)}).catch(function(e){console.log(e)})},computed:{filterAllCourse:function(){var e=I()({},this.allCourse),t=this.data[this.dataIndex];delete e[this.dataIndex-1];for(var s=this.links.length,a=0;a<s;a++)if(this.links[a].source==t)for(var r=0;r<e.length;r++)if(e[r].courseName.courseName==this.links[a].target){delete e[r];break}return e}},mounted:function(){},methods:{set:function(e){var t=this.allCourse.map(function(e){return[e.courseName.courseName,{level:0,subCourses:e.subCoursesName.map(function(e){return e.courseName})}]});console.log("nodes",t);for(var s=function(e){var s=t[e][1];s.subCourses.length&&s.subCourses.forEach(function(e){var a=t.findIndex(function(t){return t[0]===e});t[a]=[t[a][0],I()({},t[a][1],{level:t[a][1].level>s.level?t[a][1].level:s.level+1})],console.log("!!!",t[a])})},a=0;a<t.length;a++)s(a);var r=new C.a;t.forEach(function(e){r.set(e[1].level,[])}),t.forEach(function(e){r.set(e[1].level,r.get(e[1].level).concat([e[0]]))});var i=[],o=0,n=function(e){m=e[1].length,o=1400/m,e[1].forEach(function(t,s){var a={name:t,x:Math.round(o+2800/m*s),y:340*(parseInt(e[0])+1)};i.push(a)})},l=!0,c=!1,h=void 0;try{for(var u,d=y()(r.entries());!(l=(u=d.next()).done);l=!0){n(u.value)}}catch(e){c=!0,h=e}finally{try{!l&&d.return&&d.return()}finally{if(c)throw h}}i.push({name:"start",x:1400,y:0}),this.data=i,console.log("TCL: set -> data",i);for(var p=0;p<e;p++){var m=this.allCourse[p].preCoursesName.length,g=this.allCourse[p].courseName.courseName;if(0==m){var f={target:g,source:"start",label:{normal:{show:!1}}};this.links.push(f)}else for(var v=0;v<m;v++){f={target:g,source:this.allCourse[p].preCoursesName[v].courseName,label:{normal:{show:!1}}};this.links.push(f)}}console.log("TCL: set -> links",this.links),this.draw()},setAllCourse:function(){var e=this;d.a.get("http://10.60.38.173:8765/getAllCoursesRelation",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){1==t.data.state&&(e.allCourse=t.data.data)}).catch(function(e){console.log(e)})},initGraph:function(){var e=this.$refs.graph;return this.$echarts.init(e)},startTime:function(e){return{disabledDate:function(t){return null!=e.endTime&&t.getTime()>=e.endTime||t.getTime()<Date.now()}}},endTime:function(e){return{disabledDate:function(t){return null!=e.startTime&&t.getTime()<=e.startTime||t.getTime()<Date.now()}}},courseYear:function(){return{disabledDate:function(e){return e.getTime()<Date.now()}}},setTime:function(e){return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()},getTime:function(e){return e.getFullYear()},getDupCourse:function(){var e=this;d.a.get("http://10.60.38.173:8765/getAllCoursesByNameID",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{courseNameID:this.allCourse[this.dataIndex-1].courseName.courseNameID}}).then(function(t){console.log(e.allCourse[e.dataIndex-1].courseName.courseNameID,"nameid"),console.log(t.data,"resp.data"),1==t.data.state&&(e.dupCourse=t.data.data),console.log(e.dupCourse,"dup")}).catch(function(e){console.log(e)})},submitForm1:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),alert("信息不完整"),!1;for(var s=t.data.length,a=0;a<s;a++)if(t.ruleForm1.courseName==t.data[a].name)return"start"==t.ruleForm1.courseName?alert("不可添加名为“start”的课程"):alert("已添加该课程"),1;t.addCourse()}),this.resetForm(e)},submitForm2:function(e){for(var t=this.data.length,s=0;s<t;s++)if(this.ruleForm2.courseName==this.data[s].name&&this.ruleForm2.courseName!=this.data[this.dataIndex].name)return"start"==this.ruleForm2.courseName?alert("不可更改课程名为“start”"):alert("该课程已存在"),1;this.editCourse()},submitForm3:function(e){var t=this;this.$refs[e].validate(function(s){if(!s)return console.log("error submit!!"),!1;var a=I()({},t.ruleForm3);console.log(t.ruleForm3,"ruleForm3"),a.startTime=t.setTime(a.startTime),a.endTime=t.setTime(a.endTime),a.courseYear=t.getTime(a.courseYear),console.log(a);var r=new URLSearchParams;r.append("teacherID",a.teacherID),r.append("courseName",t.courseName),r.append("teacherName",a.teacherName),r.append("courseYear",a.courseYear),r.append("courseSemester",a.courseSemester),r.append("startTime",a.startTime),r.append("endTime",a.endTime),d.a.post("http://10.60.38.173:8765/addCourse",r,{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(console.log(e.data,"need"),1==e.data.state){console.log(e.data,"addClass");for(var s=e.data.data.courseID,r=0;r<a.classNum;r++){var i=new URLSearchParams;i.append("courseID",s),i.append("classNum",r+1),d.a.post("http://10.60.38.173:8765/addClass",i,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(console.log(e.data,"addClassNum"),1!=e.data.state)return t.$message("添加失败"),-1;t.$message("添加成功")}).catch(function(e){console.log(e)})}}}).catch(function(e){console.log(e)}),t.resetForm(e)})},submitForm4:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;var s=I()({},t.ruleForm4);s.startTime=t.setTime(s.startTime),s.endTime=t.setTime(s.endTime),s.courseYear=t.getTime(s.courseYear);var a=new URLSearchParams;a.append("courseID",s.courseID),a.append("teacherID",s.teacherID),a.append("courseName",t.courseName),a.append("teacherName",s.teacherName),a.append("courseYear",s.courseYear),a.append("courseSemester",s.courseSemester),a.append("startTime",s.startTime),a.append("endTime",s.endTime),d.a.post("http://10.60.38.173:8765/alterCourseInfo",a,{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){if(1==e.data.state){if(console.log(e.data,"editClass"),1!=e.data.state)return t.$message("修改失败"),-1;t.$message("修改成功")}}).catch(function(e){console.log(e)})}),this.resetForm(e),this.isEditClass=!1,this.isAddCourse=!0},resetForm:function(e){this.$refs[e].resetFields()},addCourse:function(){var e=this,t=this.ruleForm1.courseName,s=this.ruleForm1.successor.length;if(0==s){var a=this.data.length;this.data.forEach(function(t,s){340==t.y&&(e.data[s].x=Math.round(1400/(a+1)+2800/(a+1)*s))});var r={name:t,x:Math.round(1400/(a+1)+2800/(a+1)*a),y:340};this.data.push(r);var i={target:t,source:"start",label:{normal:{show:!1}},lineStyle:{normal:{curveness:.2}}};this.links.push(i)}else{for(var o=0,n=0;n<s;n++)this.data.forEach(function(t,s){t.name==e.ruleForm1.successor[n]&&t.y>o&&(o=t.y)});a=this.data.length;this.data.forEach(function(t,s){t.y==o+340&&(e.data[s].x=Math.round(1400/(a+1)+2800/(a+1)*s))});r={name:t,x:Math.round(1400/(a+1)+2800/(a+1)*a),y:o+340};this.data.push(r);for(n=0;n<s;n++){i={target:this.ruleForm1.courseName,source:this.ruleForm1.successor[n],label:{normal:{show:!1}},lineStyle:{normal:{curveness:.2}}};this.links.push(i)}}var l=I()({},this.ruleForm1),c=new URLSearchParams;c.append("courseName",l.courseName),d.a.post("http://10.60.38.173:8765/addCourseName",c,{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(1==t.data.state){for(var s=t.data.data.courseNameID,a=0;a<l.successor.length;a++)for(var r=0;r<e.allCourse.length;r++)l.successor[a]==e.allCourse[r].courseName.courseName&&d.a.get("http://10.60.38.173:8765/addCourseRelation",{params:{courseNameID:s,preCourseNameID:e.allCourse[r].courseName.courseNameID},headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){console.log("links,success"),0==e.data.state&&alert("关系添加失败")});e.$message("课程添加成功")}}).catch(function(e){console.log("err",e)}),this.test()},addCourseVisible:function(){0==this.isAddCourse&&(this.isEditCourse=!1,this.isEditClass=!1,this.isAddCourse=!0,this.isAddClass=!1,this.editClassNum=!1)},editCourseVisible:function(){this.dialog1=!1,this.isAddCourse=!1,this.isEditCourse=!0,this.isAddClass=!1,this.isEditClass=!1,this.editClassNum=!1;var e=I()({},this.allCourse[this.dataIndex-1]);this.ruleForm2.courseName=e.courseName.courseName;var t=e.preCoursesName.length;this.ruleForm2.successor=new Array;for(var s=0;s<t;s++)this.ruleForm2.successor[s]=e.preCoursesName[s].courseName;console.log(this.ruleForm2,"form2")},editCourse:function(){for(var e=this,t=this.allCourse[this.dataIndex-1].courseName.courseNameID,s=this.data[this.dataIndex].name,a=this.ruleForm2.courseName,r=this.allCourse[this.dataIndex-1].preCoursesName.length,i=new Array,o=new Array,n=0;n<r;n++)i[n]=this.allCourse[this.dataIndex-1].preCoursesName[n].courseName,o[n]=this.allCourse[this.dataIndex-1].preCoursesName[n].courseNameID;var l=this.ruleForm2.successor;I()({},this.ruleForm2);if(a!=s){this.data[this.dataIndex].name=a;for(r=this.links.length,n=0;n<r;n++){if(this.links[n].target==s){this.links[n].target=a;break}if(this.links[n].source==s){this.links[n].source=a;break}}console.log(this.data,"this.data-edit");var c=new URLSearchParams;c.append("courseNameID",t),c.append("courseName",a),d.a.post("http://10.60.38.173:8765/alertCourseName",c,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){if(console.log(t.data,"editCourseName"),1!=t.message.state)return e.$message("修改失败"),-1;e.$message("修改成功")}).catch(function(e){console.log(e)})}var h=i.sort().toString()===l.sort().toString();if(console.log(h),0==h){var u=this.newLinks.length,p=this.links.filter(function(e){if(e.target!=a)return e});if(console.log(p,"array"),0==u){var m={target:a,source:"start",label:{normal:{show:!1}},lineStyle:{normal:{curveness:.2}}};p.push(m)}else if(0!=u)for(n=0;n<u;n++){m={target:a,source:this.newLinks[n],label:{normal:{show:!1}},lineStyle:{normal:{curveness:.2}}};p.push(m)}this.links=p,console.log(this.links,"links");var g=[],f=[];for(n=0;n<l.length;n++)g[l[n]]=!0;for(n=0;n<i.length;n++)g[i[n]]?o.splice(n,1):f.push(i[n]);var v=[],x=[];for(n=0;n<i.length;n++)v[i[n]]=!0;for(n=0;n<l.length;n++)v[l[n]]||x.push(l[n]);for(var b=f.length,y=x.length,w=this.allCourse.length,_=0;_<y;_++)for(var C=0;C<w;C++)if(x[_]==this.allCourse[C].courseName.courseName){x[_]=this.allCourse[C].courseName.courseNameID;break}for(var D=0;D<b;D++)d.a.get("http://10.60.38.173:8765/deleteCourseRelation",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{courseNameID:t,preCourseNameID:o[D]}}).then(function(e){console.log("links,del,success",D),0==e.data.state&&alert("关系删除失败")});for(var S=0;S<y;S++)d.a.get("http://10.60.38.173:8765/addCourseRelation",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{courseNameID:t,preCourseNameID:x[S]}}).then(function(e){0==e.data.state&&alert("关系添加失败")})}0==h||a!=s?(console.log(this.allCourse),this.isEditCourse=!1,this.isAddCourse=!0,this.test(),this.setAllCourse(),this.$message("修改成功")):alert("没有要修改的信息")},rowClick:function(e){this.dialog2=!0,console.log(e,"row"),this.rowIndex=e,console.log(this.rowIndex,"rowIndex")},addClassVisible:function(){this.isAddCourse=!1,this.isEditCourse=!1,this.isAddClass=!0,this.isEditClass=!1,this.editClassNum=!1,this.dialog1=!1},editClassVisible:function(){this.dialog1=!1,this.dialog2=!1,this.isAddCourse=!1,this.isEditCourse=!1,this.isAddClass=!1,this.isEditClass=!0,this.editClassNum=!1;var e=I()({},this.rowIndex).courseInfo;console.log(e),e.courseYear=new Date(e.courseYear),e.startTime=new Date(e.startTime),e.endTime=new Date(e.endTime),this.ruleForm4=e,console.log(this.ruleForm4)},editClassNumVisible:function(){this.dialog1=!1,this.dialog2=!1,this.isAddCourse=!1,this.isEditCourse=!1,this.isAddClass=!1,this.isEditClass=!1,this.editClassNum=!0},selsChange:function(e){this.multipleSelection=e,console.log(e),console.log(this.allCourse)},addClassNum:function(){var e=this;this.isAddClassNum=!1;var t=new URLSearchParams;t.append("courseID",this.rowIndex.courseInfo.courseID),t.append("classNum",this.rowIndex.courseClasses.length+1),d.a.post("http://10.60.38.173:8765/addClass",t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){console.log("success"),console.log(t,"addClassNumresp"),e.rowIndex.courseClasses.push(t.data.data)})},delClassNum:function(e){var t=this;console.log(this.rowIndex,"rowindex1"),this.rowIndex.courseClasses.splice(e.$index,1),console.log(this.rowIndex,"rowindex2"),console.log(e.$index),d.a.get("http://10.60.38.173:8765/deleteClass",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{courseClassID:e.row.id}}).then(function(e){console.log("success"),console.log(e,"deleteClassNumresp"),1==e.data.state&&t.$message(e.data.message)})},delClass:function(){this.dialog2=!1,this.dupCourse.splice(this.rowIndex,1),d.a.get("http://10.60.38.173:8765/deleteCourse",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{courseID:this.rowIndex.courseInfo.courseID}}).then(function(e){console.log("success"),console.log(e,"deleteClassresp"),0==e.data.state&&alert("删除失败")})},test:function(){var e={series:[{data:this.data,links:this.links}]};console.log("test"),this.initGraph().setOption(e)},draw:function(){var e=this.initGraph(),t={title:{text:"课程关系图"},tooltip:{},animationDurationUpdate:1500,animationEasingUpdate:"quinticInOut",toolbox:{feature:{saveAsImage:{show:!0}}},series:[{type:"graph",layout:"none",top:30,right:"auto",symbolSize:30,roam:!0,label:{normal:{show:!0,textStyle:{fontColor:"#000"}}},edgeSymbol:["circle","arrow"],edgeSymbolSize:[4,14],edgeSymbolColor:"#000",edgeLabel:{normal:{textStyle:{fontSize:10,fontColor:"#000"}}},data:this.data,links:this.links,itemStyle:{normal:{color:"#ec7814"}},lineStyle:{normal:{opacity:.9,width:2,curveness:0}}}]};e.setOption(t);var s=this,a=0;e.on("click",function(r){if(a++,"edge"==r.dataType){s.dataIndex=r.dataIndex;var i=s.links[s.dataIndex].label.normal.show;s.links[s.dataIndex].label.normal.show=0==i,e.setOption(t)}else"node"==r.dataType&&(a%2==1?s.myChart.dispatchAction({type:"focusNodeAdjacency",dataIndex:r.dataIndex}):a%2==0&&s.myChart.dispatchAction({type:"unfocusNodeAdjacency",seriesIndex:r.seriesIndex}))}),document.oncontextmenu=function(){return!1},e.on("contextmenu",function(e){s.dataIndex=e.dataIndex,0==s.dataIndex?alert("不可对该节点进行操作"):(s.getDupCourse(),s.courseName=s.allCourse[s.dataIndex-1].courseName.courseNameID,s.dialog1=!0)}),s.myChart=e}}},Je={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-container",{style:e.screenWidth},[s("el-main",[s("div",[s("el-col",{attrs:{span:12,offset:2}},[s("div",{ref:"graph",staticStyle:{height:"700px","margin-top":"0px","padding-right":"10px",border:"1px solid #ddd"}})]),e._v(" "),s("el-col",{attrs:{span:8,offset:1}},[s("el-card",{staticStyle:{width:"100%",height:"650px",left:"10%"},attrs:{id:"edit","body-style":"{padding:'0px'}"}},[s("el-row",{directives:[{name:"show",rawName:"v-show",value:e.isAddCourse,expression:"isAddCourse"}],staticStyle:{"padding-bottom":"10px"}},[s("p",{staticStyle:{"text-align":"center","font-size":"13px"}},[e._v("新建课程")]),e._v(" "),s("p",{staticStyle:{"text-align":"center","font-size":"12px"}},[e._v("其他操作，请点击左侧课程关系图中对应的节点")])]),e._v(" "),s("el-row",{directives:[{name:"show",rawName:"v-show",value:e.isEditCourse,expression:"isEditCourse"}],staticStyle:{"padding-bottom":"10px"}},[s("p",{staticStyle:{"text-align":"center","font-size":"13px","margin-bottom":"-3px"}},[e._v("编辑课程")]),e._v(" "),s("el-button",{attrs:{size:"mini",type:"text"},on:{click:e.addCourseVisible}},[e._v("返回添加课程")])],1),e._v(" "),s("el-row",{directives:[{name:"show",rawName:"v-show",value:e.isAddClass,expression:"isAddClass"}],staticStyle:{"padding-bottom":"10px"}},[s("p",{staticStyle:{"text-align":"center","font-size":"13px"}},[e._v("为课程添加班级")]),e._v(" "),s("el-button",{attrs:{size:"mini",type:"text"},on:{click:e.addCourseVisible}},[e._v("返回添加课程")])],1),e._v(" "),s("el-row",{directives:[{name:"show",rawName:"v-show",value:e.isEditClass,expression:"isEditClass"}],staticStyle:{"padding-bottom":"10px"}},[s("p",{staticStyle:{"text-align":"center","font-size":"13px","margin-bottom":"-3px"}},[e._v("编辑班级信息")]),e._v(" "),s("el-button",{attrs:{size:"mini",type:"text"},on:{click:e.addCourseVisible}},[e._v("返回添加课程")])],1),e._v(" "),s("el-row",{directives:[{name:"show",rawName:"v-show",value:e.editClassNum,expression:"editClassNum"}],staticStyle:{"padding-bottom":"10px"}},[s("p",{staticStyle:{"text-align":"center","font-size":"13px","margin-bottom":"-3px"}},[e._v("编辑班级数量")]),e._v(" "),s("el-button",{attrs:{size:"mini",type:"text"},on:{click:e.addCourseVisible}},[e._v("返回添加课程")])],1),e._v(" "),s("el-form",{directives:[{name:"show",rawName:"v-show",value:e.isAddCourse,expression:"isAddCourse"}],ref:"ruleForm1",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm1,rules:e.rules12,"label-width":"100px",size:"mini"}},[s("el-form-item",{attrs:{label:"课程名称",prop:"courseName"}},[s("el-input",{model:{value:e.ruleForm1.courseName,callback:function(t){e.$set(e.ruleForm1,"courseName",t)},expression:"ruleForm1.courseName"}})],1),e._v(" "),s("el-form-item",{staticStyle:{"text-align":"left"},attrs:{prop:"successor",label:"前继课程"}},[s("el-select",{attrs:{multiple:"","collapse-tags":"",placeholder:"前继课程"},model:{value:e.ruleForm1.successor,callback:function(t){e.$set(e.ruleForm1,"successor",t)},expression:"ruleForm1.successor"}},e._l(e.allCourse,function(e,t){return s("el-option",{key:t,attrs:{label:e.courseName.courseName,value:e.courseName.courseName}})}),1)],1),e._v(" "),s("el-form-item",{staticStyle:{"margin-left":"-100px","padding-top":"30px"}},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm1("ruleForm1")}}},[e._v("新 建")])],1)],1),e._v(" "),s("el-form",{directives:[{name:"show",rawName:"v-show",value:e.isEditCourse,expression:"isEditCourse"}],ref:"ruleForm2",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm2,rules:e.rules12,"label-width":"100px",size:"mini"}},[s("el-form-item",{attrs:{label:"课程名称",prop:"courseName"}},[s("el-input",{model:{value:e.ruleForm2.courseName,callback:function(t){e.$set(e.ruleForm2,"courseName",t)},expression:"ruleForm2.courseName"}})],1),e._v(" "),s("el-form-item",{staticStyle:{"text-align":"left"},attrs:{prop:"successor",label:"前继课程"}},[s("el-select",{attrs:{multiple:"","collapse-tags":"",placeholder:"前继课程"},model:{value:e.ruleForm2.successor,callback:function(t){e.$set(e.ruleForm2,"successor",t)},expression:"ruleForm2.successor"}},e._l(e.filterAllCourse,function(e,t){return s("el-option",{key:t,attrs:{label:e.courseName.courseName,value:e.courseName.courseName}})}),1)],1),e._v(" "),s("el-form-item",{staticStyle:{"margin-left":"-100px","padding-top":"30px"}},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm2("ruleForm2")}}},[e._v("提交修改")]),e._v(" "),s("el-button",{attrs:{type:"text"},on:{click:e.addCourseVisible}},[e._v("取消")])],1)],1),e._v(" "),s("el-form",{directives:[{name:"show",rawName:"v-show",value:e.isAddClass,expression:"isAddClass"}],ref:"ruleForm3",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm3,rules:e.rules34,"label-width":"100px",size:"mini"}},[s("el-form-item",{attrs:{label:"教师名称",prop:"teacherName"}},[s("el-input",{model:{value:e.ruleForm3.teacherName,callback:function(t){e.$set(e.ruleForm3,"teacherName",t)},expression:"ruleForm3.teacherName"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"教师工号",prop:"teacherID"}},[s("el-input",{model:{value:e.ruleForm3.teacherID,callback:function(t){e.$set(e.ruleForm3,"teacherID",t)},expression:"ruleForm3.teacherID"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"学年学期",required:""}},[s("el-col",{attrs:{span:11}},[s("el-form-item",{attrs:{prop:"courseYear"}},[s("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"year",placeholder:"选择学年","picker-options":e.pickerOptions2},model:{value:e.ruleForm3.courseYear,callback:function(t){e.$set(e.ruleForm3,"courseYear",t)},expression:"ruleForm3.courseYear"}})],1)],1),e._v(" "),s("el-col",{staticClass:"line",attrs:{span:2}},[e._v("-")]),e._v(" "),s("el-col",{attrs:{span:11}},[s("el-form-item",{attrs:{prop:"courseSemester"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"学期"},model:{value:e.ruleForm3.courseSemester,callback:function(t){e.$set(e.ruleForm3,"courseSemester",t)},expression:"ruleForm3.courseSemester"}},[s("el-option",{attrs:{label:"春季",value:"春季"}}),e._v(" "),s("el-option",{attrs:{label:"秋季",value:"秋季"}})],1)],1)],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"授课时间",required:""}},[s("el-col",{attrs:{span:11}},[s("el-form-item",{attrs:{prop:"startTime"}},[s("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"开始日期","picker-options":e.startTime(e.ruleForm3)},model:{value:e.ruleForm3.startTime,callback:function(t){e.$set(e.ruleForm3,"startTime",t)},expression:"ruleForm3.startTime"}})],1)],1),e._v(" "),s("el-col",{staticClass:"line",attrs:{span:2}},[e._v("-")]),e._v(" "),s("el-col",{attrs:{span:11}},[s("el-form-item",{attrs:{prop:"endTime"}},[s("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"结束日期","picker-options":e.endTime(e.ruleForm3)},model:{value:e.ruleForm3.endTime,callback:function(t){e.$set(e.ruleForm3,"endTime",t)},expression:"ruleForm3.endTime"}})],1)],1)],1),e._v(" "),s("el-form-item",{staticStyle:{width:"80%"},attrs:{label:"班级个数",prop:"classNum"}},[s("el-input",{attrs:{type:"num","auto-complete":"off"},model:{value:e.ruleForm3.classNum,callback:function(t){e.$set(e.ruleForm3,"classNum",e._n(t))},expression:"ruleForm3.classNum"}})],1),e._v(" "),s("el-form-item",{staticStyle:{"margin-left":"-100px","padding-top":"10px"}},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm3("ruleForm3")}}},[e._v("立即创建")]),e._v(" "),s("el-button",{on:{click:function(t){return e.resetForm("ruleForm3")}}},[e._v("重置")])],1)],1),e._v(" "),s("el-form",{directives:[{name:"show",rawName:"v-show",value:e.isEditClass,expression:"isEditClass"}],ref:"ruleForm4",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm4,rules:e.rules34,"label-width":"100px",size:"mini"}},[s("el-form-item",{attrs:{label:"教师名称",prop:"teacherName"}},[s("el-input",{model:{value:e.ruleForm4.teacherName,callback:function(t){e.$set(e.ruleForm4,"teacherName",t)},expression:"ruleForm4.teacherName"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"教师工号",prop:"teacherID"}},[s("el-input",{model:{value:e.ruleForm4.teacherID,callback:function(t){e.$set(e.ruleForm4,"teacherID",t)},expression:"ruleForm4.teacherID"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"学年学期",required:""}},[s("el-col",{attrs:{span:11}},[s("el-form-item",{attrs:{prop:"courseYear"}},[s("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"year",placeholder:"选择学年","picker-options":e.pickerOptions2},model:{value:e.ruleForm4.courseYear,callback:function(t){e.$set(e.ruleForm4,"courseYear",t)},expression:"ruleForm4.courseYear"}})],1)],1),e._v(" "),s("el-col",{staticClass:"line",attrs:{span:2}},[e._v("-")]),e._v(" "),s("el-col",{attrs:{span:11}},[s("el-form-item",{attrs:{prop:"courseSemester"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"学期"},model:{value:e.ruleForm4.courseSemester,callback:function(t){e.$set(e.ruleForm4,"courseSemester",t)},expression:"ruleForm4.courseSemester"}},[s("el-option",{attrs:{label:"春季",value:"春季"}}),e._v(" "),s("el-option",{attrs:{label:"秋季",value:"秋季"}})],1)],1)],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"授课时间",required:""}},[s("el-col",{attrs:{span:11}},[s("el-form-item",{attrs:{prop:"startTime"}},[s("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"开始日期","picker-options":e.startTime(e.ruleForm4)},model:{value:e.ruleForm4.startTime,callback:function(t){e.$set(e.ruleForm4,"startTime",t)},expression:"ruleForm4.startTime"}})],1)],1),e._v(" "),s("el-col",{staticClass:"line",attrs:{span:2}},[e._v("-")]),e._v(" "),s("el-col",{attrs:{span:11}},[s("el-form-item",{attrs:{prop:"endTime"}},[s("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"结束日期","picker-options":e.endTime(e.ruleForm4)},model:{value:e.ruleForm4.endTime,callback:function(t){e.$set(e.ruleForm4,"endTime",t)},expression:"ruleForm4.endTime"}})],1)],1)],1),e._v(" "),s("el-form-item",{staticStyle:{"margin-left":"-100px","padding-top":"30px"}},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm4("ruleForm4")}}},[e._v("提交修改")]),e._v(" "),s("el-button",{attrs:{type:"text"},on:{click:e.addCourseVisible}},[e._v("取消")])],1)],1),e._v(" "),s("el-row",{directives:[{name:"show",rawName:"v-show",value:e.editClassNum,expression:"editClassNum"}]},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.rowIndex.courseClasses,border:""}},[s("el-table-column",{attrs:{prop:"classNum",label:"班级",width:"100"}}),e._v(" "),s("el-table-column",{attrs:{prop:"classCode",label:"邀请码",width:"150"}}),e._v(" "),s("el-table-column",{attrs:{fixed:"right",label:"操作",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return e.delClassNum(t)}}},[e._v("删除")])]}}])})],1),e._v(" "),s("div",{staticStyle:{"padding-top":"20px"}},[s("el-button",{attrs:{size:"small"},on:{click:function(t){e.isAddClassNum=!0}}},[e._v("新增班级")])],1),e._v(" "),s("el-dialog",{attrs:{visible:e.isAddClassNum,title:"提示",center:"",width:"30%"},on:{"update:visible":function(t){e.isAddClassNum=t}}},[s("p",{staticStyle:{"text-align":"center"}},[e._v("是否确认添加班级？")]),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addClassNum}},[e._v("确 认")]),e._v(" "),s("el-button",{attrs:{size:"small"},on:{click:function(t){e.isAddClassNum=!1}}},[e._v("取 消")])],1)])],1)],1)],1),e._v(" "),s("el-dialog",{attrs:{title:"请选择要进行的操作",visible:e.dialog1,width:"30%"},on:{"update:visible":function(t){e.dialog1=t}}},[s("div",{staticStyle:{"margin-top":"-20px"}},[e._v("\n          对课程进行操作：\n          "),s("el-button",{attrs:{type:"text"},on:{click:e.editCourseVisible}},[s("span",{staticStyle:{"font-size":"12px"}},[e._v("编辑")])]),e._v(" "),s("el-button",{attrs:{type:"text"},on:{click:e.addClassVisible}},[s("span",{staticStyle:{"font-size":"12px"}},[e._v("开课")])])],1),e._v(" "),s("el-table",{attrs:{data:e.dupCourse,border:""},on:{"row-click":e.rowClick}},[s("el-table-column",{attrs:{label:"点击下表对应行，对班级进行操作"}},[s("el-table-column",{attrs:{prop:"courseInfo.teacherName",label:"教师",width:"100"}}),e._v(" "),s("el-table-column",{attrs:{prop:"courseInfo.startTime",label:"开课时间",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{prop:"courseInfo.endTime",label:"结束时间"}})],1)],1)],1),e._v(" "),s("el-dialog",{attrs:{title:"请选择要进行的操作",visible:e.dialog2,width:"30%",center:""},on:{"update:visible":function(t){e.dialog2=t}}},[s("p",{staticStyle:{"text-align":"center"}},[s("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.editClassVisible}},[e._v("编辑信息")]),e._v(" "),s("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.editClassNumVisible}},[e._v("编辑班级")]),e._v(" "),s("el-button",{attrs:{size:"small",type:"danger"},on:{click:e.delClass}},[e._v("删 除")])],1)])],1)])],1)},staticRenderFns:[]};var Ye=s("VU/8")(Me,Je,!1,function(e){s("J9Kn")},"data-v-2bd391ae",null).exports,Ue={name:"adminManage",data:function(){return{screenWidth:{width:window.screen.width}}},methods:{chart:function(){this.$router.push("/adminManage/courseAnalysis")},courseList:function(){this.$router.push("/adminManage/courseList")},teacherList:function(){this.$router.push("/adminManage/teacherList")}}},He={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{style:e.screenWidth},[s("el-row",{staticClass:"header"},[s("el-col",{staticClass:"logo logo-width",attrs:{span:10}},[s("div",[s("div",{staticStyle:{display:"inline-block","padding-top":"20px"}},[s("i",{staticClass:"fa fa-leanpub",staticStyle:{"margin-right":"0px"},attrs:{"aria-hidden":"true"}}),e._v(" "),s("span",{staticStyle:{"letter-spacing":"3px","font-weight":"bold"}},[e._v("教与学")])]),e._v(" "),s("div",{staticStyle:{color:"#fff",display:"inline-block"}},[s("div",{staticClass:"subhead",staticStyle:{top:"15px"}},[e._v("专业在线教育平台")]),e._v(" "),s("div",{staticClass:"subhead",staticStyle:{top:"33px"}},[e._v("TEACH AND LEARN")])])])]),e._v(" "),s("el-col",{staticClass:"icon-right",attrs:{span:1}},[s("i",{staticClass:"el-icon-share",on:{click:e.chart}})]),e._v(" "),s("el-col",{staticClass:"icon-right",attrs:{span:1}},[s("i",{staticClass:"el-icon-service",on:{click:e.teacherList}})]),e._v(" "),s("el-col",{staticClass:"icon-right",attrs:{span:1}},[s("i",{staticClass:"el-icon-menu",on:{click:e.courseList}})])],1),e._v(" "),s("el-row",[s("router-view",{staticClass:"router-view"})],1)],1)},staticRenderFns:[]};var Ze=s("VU/8")(Ue,He,!1,function(e){s("NGFP"),s("atjF")},"data-v-22b8b716",null).exports,We={data:function(){return{courseID:0,chapterID:0,point:{contentName:"",content:""}}},created:function(){this.getContent()},methods:{getContent:function(){var e=this,t=this.$route.query.chapterID;this.chapterID=t,this.$axios.get("http://10.60.38.173:8765/getChapterByID",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{chapterID:this.chapterID}}).then(function(t){console.log(e.chapterID,"chapterid"),console.log(t.data,"chapter content"),1==t.data.state&&(e.point=t.data.data)}).catch(function(e){console.log(e)})}},watch:{$route:function(e,t){console.log("有变化了"),this.getContent()}}},Xe={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticStyle:{}},[t("h3",[this._v(this._s(this.point.contentName))]),this._v(" "),t("div",{domProps:{innerHTML:this._s(this.point.content)}})])},staticRenderFns:[]};var Ke=s("VU/8")(We,Xe,!1,function(e){s("Gz/H")},"data-v-3bd028fd",null).exports,Qe={data:function(){return{isScored:!1,havePre:!1,before:!0,after:!1,beforeRate:!0,afterRate:!1,sid:0,type:0,rate:0,answer:{},score:{},totalPoint:0,totalScore:0,exercises:[]}},create:function(){},mounted:function(){this.getPre(),this.setAnswer()},watch:{$route:function(e,t){this.getPre(),this.setAnswer()}},methods:{setAnswerClass:function(e,t){return e.indexOf(t)>=0?"answer":""},getPre:function(){var e=this,t=this.$route.query.spreid;this.sid=t,this.$axios.get("http://10.60.38.173:8765/question/view",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{chapterId:this.sid,type:"preview"}}).then(function(t){(console.log("pre",t.data),1==t.data.state)&&(e.exercises=t.data.data,0!=e.exercises.length&&(e.havePre=!0),e.setTotalPoint())}).catch(function(e){console.log(e)})},setAnswer:function(){for(var e=this.exercises.length,t=0;t<e;t++)1==this.exercises[t].exercise.exerciseType?this.answer[t.toString()]=null:2==this.exercises[t].exercise.exerciseType&&(this.answer[t.toString()]=[]),this.score[t]=""},setTotalPoint:function(){for(var e=0,t=0;t<this.exercises.length;t++)e+=this.exercises[t].exercise.exercisePoint;this.totalPoint=e},submitForm:function(e){var t=this,s=fe()(this.answer).length;console.log(this.answer),this.$refs[e].validate(function(e){if(e){for(var a=0;a<s;a++){var r=E()(t.answer[a]);if(console.log(r,"type"),"number"==r){var i=String.fromCharCode(t.answer[a]+65),o=t.exercises[a].exercise.exerciseAnswer;t.score[a]=i==o?t.exercises[a].exercise.exercisePoint:0}else if("object"==r){var n=t.answer[a].length;t.answer[a]=t.answer[a].sort();for(var l=new Array,c=0;c<n;c++)l[c]=String.fromCharCode(t.answer[a][c]+65);var h=t.exercises[a].exercise.exerciseAnswer,u=(h.length,l.join("")===h);t.score[a]=u?t.exercises[a].exercise.exercisePoint:0}else t.score[a]=0}console.log(t.score,"score");var d=new URLSearchParams;d.append("answers",t.answer),d.append("studentId",1),d.append("chapterId",t.sid),d.append("type","preview"),d.append("comment",1),d.append("rate",1),t.$axios.post("http://10.60.38.173:8765/question/answerAll",d,{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(e){console.log(e.data),console.log("pre submit success"),1==e.data.state&&(t.before=!1,t.after=!0)}).catch(function(e){console.log(e)})}else alert("有习题未完成")});for(var a=0;a<this.exercises.length;a++)this.totalScore+=this.score[a]}}},et={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.havePre?s("div",{staticStyle:{margin:"0 auto",width:"778px"}},[s("h3",{attrs:{align:"start"}},[e._v("\n      客观题（\n      "),s("span",[e._v(e._s(e.totalPoint))]),e._v("分）\n      "),s("span",{directives:[{name:"show",rawName:"v-show",value:e.after,expression:"after"}]},[e._v("得分："+e._s(e.totalScore)+" 分")])]),e._v(" "),s("el-form",{directives:[{name:"show",rawName:"v-show",value:e.before,expression:"before"}],ref:"answer",attrs:{model:e.answer}},[e._l(e.exercises,function(t,a){return s("div",{key:a,staticStyle:{"margin-top":"15px","font-size":"14px"},attrs:{align:"start"}},[s("p",{staticStyle:{"margin-left":"5px"}},[s("pre",[e._v(e._s(a+1)+". "+e._s(t.exercise.exerciseContent)+"（"+e._s(t.exercise.exercisePoint)+"分）")]),e._v(" "),2===t.exercise.exerciseType?s("span",[e._v("（多选）")]):e._e()]),e._v(" "),1===t.exercise.exerciseType?s("el-form-item",{staticStyle:{"margin-top":"10px","margin-left":"10px","padding-bottom":"10px"},attrs:{prop:a.toString(),rules:[{required:!0,message:"请选择"},{type:"number",message:"请选择"}]}},[s("el-radio-group",{model:{value:e.answer[a],callback:function(t){e.$set(e.answer,a,t)},expression:"answer[index]"}},e._l(t.exerciseChoiceList.length,function(a){return s("el-radio",{key:a,attrs:{value:a-1,label:a-1}},[e._v(e._s(String.fromCharCode(a+64))+". "+e._s(t.exerciseChoiceList[a-1].choice))])}),1)],1):2===t.exercise.exerciseType?s("el-form-item",{staticStyle:{"margin-left":"10px"},attrs:{prop:a.toString(),rules:[{required:!0,message:"请选择"}]}},[s("el-checkbox-group",{model:{value:e.answer[a],callback:function(t){e.$set(e.answer,a,t)},expression:"answer[index]"}},e._l(t.exerciseChoiceList.length,function(a){return s("el-checkbox",{key:a,attrs:{value:a-1,label:a-1}},[e._v(e._s(String.fromCharCode(a+64))+"."+e._s(t.exerciseChoiceList[a-1].choice))])}),1)],1):e._e()],1)}),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.submitForm("answer")}}},[e._v("确认提交")])],1)],2),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.after,expression:"after"}]},e._l(e.exercises,function(t,a){return s("div",{key:a,staticStyle:{"margin-top":"15px","font-size":"14px","padding-bottom":"10px"},attrs:{align:"start"}},[s("p",{staticStyle:{"margin-left":"5px"}},[s("pre",[e._v(e._s(a+1)+". "+e._s(t.exercise.exerciseContent)+"（"+e._s(t.exercise.exercisePoint)+"分）")]),e._v(" "),1===t.exercise.exerciseType||2===t.exercise.exerciseType?s("span",[s("span",{staticStyle:{"font-size":"12px",color:"rgb(100,100,100)"}},[e._v("\n              你的选择：\n              "),1===t.exercise.exerciseType?s("span",{staticStyle:{color:"red"}},[e._v(e._s(String.fromCharCode(e.answer[a]+65))+"  ")]):2===t.exercise.exerciseType?s("span",{staticStyle:{color:"red"}},e._l(e.answer[a],function(t,a){return s("span",{key:a},[e._v(e._s(String.fromCharCode(t+65)))])}),0):e._e()]),e._v(" "),s("span",{staticStyle:{"font-size":"12px",color:"rgb(100,100,100)"}},[e._v("\n              得分：\n              "),s("span",{staticStyle:{color:"red"}},[e._v(e._s(e.score[a]))]),e._v(" 分\n            ")])]):e._e()]),e._v(" "),1===t.exercise.exerciseType||2===t.exercise.exerciseType?s("span",e._l(t.exerciseChoiceList.length,function(a){return s("span",{key:a,staticStyle:{"margin-left":"10px"},attrs:{value:a-1,label:a-1}},[s("span",{class:e.setAnswerClass(t.exercise.exerciseAnswer,String.fromCharCode(a+64))},[e._v(e._s(String.fromCharCode(a+64))+". "+e._s(t.exerciseChoiceList[a-1].choice))])])}),0):e._e(),e._v(" "),s("div",{staticStyle:{"margin-top":"10px","background-color":"rgb(240,240,240)","min-height":"80px",padding:"10px 10px 10px 10px"}},[e._v("解析："),s("pre",[e._v(e._s(t.exercise.exerciseAnalysis))])])])}),0)],1):s("div",[s("h3",[e._v("老师尚未发布习题")])])])},staticRenderFns:[]};var tt=s("VU/8")(Qe,et,!1,function(e){s("el14")},"data-v-bcb92358",null).exports,st={data:function(){return{time:null,haveRev:!1,half:!0,before:!0,after:!1,isScored:!1,isRated:!1,type:0,rate:0,comment:"",sid:0,answer:[],score:{},totalPoint:0,totalScore:0,exercises:[]}},create:function(){},mounted:function(){this.getRev(),this.setTime(),this.setAnswer()},watch:{$route:function(e,t){this.getRev(),this.setTime(),this.setAnswer()}},methods:{setAnswerClass:function(e,t){return e.indexOf(t)>=0?"answer":""},setTime:function(){var e=this.$route.query.index,t=S.state.catalog;0!=t.length&&null!=t[e].exerciseDeadline_2&&(this.time=t[e].exerciseDeadline_2)},getTime:function(){this.$axios.get("http://10.60.38.173:8765/getChapterByID",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{chapterId:this.sid}}).then(function(e){console.log("pre",e.data),1==e.data.state&&console.log(e.data.data,"time")}).catch(function(e){console.log(e)})},setTotalPoint:function(){for(var e=0;e<this.exercises.length;e++)this.totalPoint+=this.exercises[e].exercise.exercisePoint},getRev:function(){var e=this,t=this.$route.query.srevid;this.sid=t;this.$route.query.index,S.state.catalog;this.$axios.get("http://10.60.38.173:8765/question/view",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{chapterId:t,type:"review"}}).then(function(t){(console.log("rev",t.data),1==t.data.state)&&(e.exercises=t.data.data,0!=e.exercises.length&&(e.haveRev=!0),e.setTotalPoint())}).catch(function(e){console.log(e)})},setAnswer:function(){for(var e=this.exercises.length,t=0;t<e;t++)4==this.exercises[t].exercise.exerciseType?this.answer[t.toString()]=null:5==this.exercises[t].exercise.exerciseType?this.answer[t.toString()]=[]:6==this.exercises[t].exercise.exerciseType&&(this.answer[t.toString()]=""),this.score[t]=""},submitForm:function(e){var t=this,s=fe()(this.answer).length;this.$refs[e].validate(function(e){if(e){for(var a=0;a<s;a++){var r=E()(t.answer[a]);if(console.log(r,"type"),"number"==r){var i=String.fromCharCode(t.answer[a]+65),o=t.exercises[a].exercise.exerciseAnswer;t.score[a]=i==o?t.exercises[a].exercise.exercisePoint:0}else if("object"==r){var n=t.answer[a].length;t.answer[a]=t.answer[a].sort();for(var l=new Array,c=0;c<n;c++)l[c]=String.fromCharCode(t.answer[a][c]+65);var h=t.exercises[a].exercise.exerciseAnswer,u=(h.length,l.join("")===h);t.score[a]=u?t.exercises[a].exercise.exercisePoint:0}else t.score[a]=0}t.before=!1,t.after=!0}else alert("有习题未完成");console.log(t.score,"score")});for(var a=0;a<this.exercises.length;a++)this.totalScore+=this.score[a]},submit:function(){var e=this;if(1==this.before)alert("请先完成题目");else if(0==this.rate)alert("评分不可为0");else{this.isRated=!0;var t=new URLSearchParams;t.append("answers",this.answer),t.append("studentId",1),t.append("chapterId",this.sid),t.append("type","review"),t.append("comment",this.comment),t.append("rate",this.rate),this.$axios.post("http://10.60.38.173:8765/question/answerAll",t,{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer "+localStorage.getItem("token")}}).then(function(t){console.log(t.data),console.log("rev submit success"),1==t.data.state&&e.$message("提交成功")}).catch(function(e){console.log(e)})}}}},at={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.haveRev?s("div",{staticStyle:{margin:"0 auto",width:"700px"}},[s("h3",{attrs:{align:"start"}},[e._v("\n      作业题（\n      "),s("span",[e._v(e._s(e.totalPoint))]),e._v("分）\n      "),s("span",{directives:[{name:"show",rawName:"v-show",value:e.isRated,expression:"isRated"}],staticStyle:{"font-size":"14px"}},[e._v("\n        客观题得分:\n        "),s("span",{staticStyle:{color:"red"}},[e._v(e._s(e.totalScore))]),e._v(" 分\n      ")]),e._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:e.isScored,expression:"isScored"}],staticStyle:{"font-size":"14px"}},[e._v("\n        总得分:\n        "),s("span",{staticStyle:{color:"red"}},[e._v(e._s(e.totalScore))]),e._v(" 分\n      ")])]),e._v(" "),null!=e.time?s("h4",{staticStyle:{color:"rgb(150,150,150)"},attrs:{align:"start"}},[e._v("截止时间："+e._s(e.time))]):e._e(),e._v(" "),s("el-form",{directives:[{name:"show",rawName:"v-show",value:e.before,expression:"before"}],ref:"answer",attrs:{model:e.answer}},[e._l(e.exercises,function(t,a){return s("div",{key:a,staticStyle:{"margin-top":"15px","font-size":"14px"},attrs:{align:"start"}},[s("p",{staticStyle:{"margin-left":"5px"}},[s("pre",[e._v(e._s(a+1)+". "+e._s(t.exercise.exerciseContent)+"（"+e._s(t.exercise.exercisePoint)+"分）")]),e._v(" "),5===t.exercise.exerciseType?s("span",[e._v("（多选）")]):e._e()]),e._v(" "),4===t.exercise.exerciseType?s("el-form-item",{staticStyle:{"margin-top":"10px","margin-left":"10px","padding-bottom":"10px"},attrs:{prop:a.toString(),rules:[{required:!0,message:"请选择"},{type:"number",message:"请选择"}]}},[s("el-radio-group",{model:{value:e.answer[a],callback:function(t){e.$set(e.answer,a,t)},expression:"answer[index]"}},e._l(t.exerciseChoiceList.length,function(a){return s("el-radio",{key:a,attrs:{value:a-1,label:a-1}},[e._v(e._s(String.fromCharCode(a+64))+". "+e._s(t.exerciseChoiceList[a-1].choice))])}),1)],1):5===t.exercise.exerciseType?s("el-form-item",{staticStyle:{"margin-left":"10px"},attrs:{prop:a.toString(),rules:[{required:!0,message:"请选择"}]}},[s("el-checkbox-group",{model:{value:e.answer[a],callback:function(t){e.$set(e.answer,a,t)},expression:"answer[index]"}},e._l(t.exerciseChoiceList.length,function(a){return s("el-checkbox",{key:a,attrs:{value:a-1,label:a-1}},[e._v(e._s(String.fromCharCode(a+64))+"."+e._s(t.exerciseChoiceList[a-1].choice))])}),1)],1):6===t.exercise.exerciseType?s("el-form-item",{staticStyle:{"margin-left":"10px"},attrs:{prop:a.toString(),rules:[{required:!0,message:"请选择"},{type:"string",message:"请选择"}]}},[s("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入答案"},model:{value:e.answer[a],callback:function(t){e.$set(e.answer,a,t)},expression:"answer[index]"}})],1):e._e()],1)}),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.submitForm("answer")}}},[e._v("保 存")])],1)],2),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.after,expression:"after"}]},e._l(e.exercises,function(t,a){return s("div",{key:a,staticStyle:{"margin-top":"15px","font-size":"14px","padding-bottom":"10px"},attrs:{align:"start"}},[s("p",{staticStyle:{"margin-left":"5px"}},[s("pre",[e._v(e._s(a+1)+". "+e._s(t.exercise.exerciseContent)+"（"+e._s(t.exercise.exercisePoint)+"分）")]),e._v(" "),4===t.exercise.exerciseType||5===t.exercise.exerciseType?s("span",[s("span",{staticStyle:{"font-size":"12px",color:"rgb(100,100,100)"}},[e._v("\n              你的选择:\n              "),4===t.exercise.exerciseType?s("span",{staticStyle:{color:"red"}},[e._v(e._s(String.fromCharCode(e.answer[a]+65))+"  ")]):5===t.exercise.exerciseType?s("span",{staticStyle:{color:"red"}},e._l(e.answer[a],function(t,a){return s("span",{key:a},[e._v(e._s(String.fromCharCode(t+65)))])}),0):e._e()]),e._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:e.isRated,expression:"isRated"}],staticStyle:{"font-size":"12px",color:"rgb(100,100,100)"}},[e._v("\n              得分:\n              "),s("span",{staticStyle:{color:"red"}},[e._v(e._s(e.score[a]))]),e._v(" 分\n            ")])]):6===t.exercise.exerciseType&&1==e.isScored?s("span",[s("span",{staticStyle:{"font-size":"12px",color:"rgb(100,100,100)"}},[e._v("\n              得分:\n              "),s("span",{staticStyle:{color:"red"}},[e._v(e._s(e.score[a]))]),e._v(" 分\n            ")])]):e._e()]),e._v(" "),4===t.exercise.exerciseType||5===t.exercise.exerciseType?s("span",e._l(t.exerciseChoiceList.length,function(a){return s("span",{key:a,staticStyle:{"margin-left":"10px"},attrs:{value:a-1,label:a-1}},[0==e.isRated?s("span",[e._v(e._s(String.fromCharCode(a+64))+". "+e._s(t.exerciseChoiceList[a-1].choice))]):s("span",{class:e.setAnswerClass(t.exercise.exerciseAnswer,String.fromCharCode(a+64))},[e._v(e._s(String.fromCharCode(a+64))+". "+e._s(t.exerciseChoiceList[a-1].choice))])])}),0):6===t.exercise.exerciseType?s("div",{staticStyle:{padding:"10px","background-color":"#ddd",height:"50px"}},[e._v("你的答案："+e._s(e.answer[a]))]):e._e(),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isRated,expression:"isRated"}],staticStyle:{"margin-top":"10px","background-color":"rgb(240,240,240)","min-height":"80px",padding:"10px 10px 10px 10px"}},[e._v("解析："),s("pre",[e._v(e._s(t.exercise.exerciseAnalysis))])])])}),0),e._v(" "),0==e.isRated?s("div",{staticStyle:{border:"1px solid #ddd",height:"200px"}},[e._m(0),e._v(" "),s("el-rate",{staticStyle:{"margin-top":"-5px","padding-bottom":"10px"},attrs:{colors:["#99A9BF","#F7BA2A","#FF9900"],"allow-half":e.half},model:{value:e.rate,callback:function(t){e.rate=t},expression:"rate"}}),e._v(" "),s("el-input",{staticStyle:{width:"400px","padding-top":"10px"},attrs:{type:"textarea",placeholder:"输入评价",rows:"2",resize:"none"},model:{value:e.comment,callback:function(t){e.comment=t},expression:"comment"}}),e._v(" "),s("p",[s("el-button",{attrs:{size:"mini",type:"primary",round:""},on:{click:e.submit}},[e._v("提 交")])],1)],1):s("div",{staticStyle:{"background-color":"#545c64",height:"120px"}},[s("p",{staticStyle:{"padding-top":"10px",color:"#fff"}},[e._v("评分")]),e._v(" "),s("el-rate",{attrs:{disabled:"","show-score":"","text-color":"#ff9900","score-template":"{value}"},model:{value:e.rate,callback:function(t){e.rate=t},expression:"rate"}}),e._v(" "),s("p",{staticStyle:{color:"#fff"}},[e._v(e._s(e.comment))])],1)],1):s("div",[s("h3",[e._v("老师尚未发布习题")])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("p",{staticStyle:{"padding-top":"10px",color:"#000"}},[this._v("\n        评分\n        "),t("span",{staticStyle:{"font-size":"12px"}},[this._v("（评分后方可提交作业）")])])}]};var rt=s("VU/8")(st,at,!1,function(e){s("0FKq")},"data-v-17fa0045",null).exports,it={data:function(){return{courseID:0,chapterID:0,point:{contentName:"标题",content:"内容"}}},created:function(){this.getContent()},methods:{getContent:function(){var e=this,t=this.$route.query.chapterIDt;this.chapterID=t,this.$axios.get("http://10.60.38.173:8765/getChapterByID",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{chapterID:this.chapterID}}).then(function(t){console.log(e.chapterID,"chapterid"),console.log(t.data,"chapter content"),e.point=t.data.data}).catch(function(e){console.log(e)})}},watch:{$route:function(e,t){console.log("有变化了"),this.getContent()}}},ot={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticStyle:{}},[t("h3",[this._v(this._s(this.point.contentName))]),this._v(" "),t("div",{domProps:{innerHTML:this._s(this.point.content)}})])},staticRenderFns:[]};var nt=s("VU/8")(it,ot,!1,function(e){s("IsVt")},"data-v-74f39808",null).exports,lt={data:function(){return{tid:0,havePre:!1,type:0,rate:0,totalPoint:0,totalScore:0,exercises:[]}},mounted:function(){this.getPre()},methods:{getPre:function(){var e=this,t=this.$route.query.tpreid;this.tid=t,this.$axios.get("http://10.60.38.173:8765/question/view",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{chapterId:this.tid,type:"preview"}}).then(function(t){console.log("pre",t.data),e.exercises=t.data.data,0!=e.exercises.length&&(e.havePre=!0),e.setTotalPoint()}).catch(function(e){console.log(e)})},setTotalPoint:function(){for(var e=0;e<this.exercises.length;e++)this.totalPoint+=this.exercises[e].exercise.exercisePoint}}},ct={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.havePre?s("div",{staticStyle:{margin:"0 auto",width:"700px"}},[s("h4",{attrs:{align:"start"}},[e._v("\r\n      客观题（"),s("span",[e._v(e._s(e.totalPoint))]),e._v("分）\r\n    ")]),e._v(" "),s("el-form",[e._l(e.exercises,function(t,a){return s("div",{key:a,staticStyle:{"margin-top":"15px","font-size":"14px"},attrs:{align:"start"}},[s("p",{staticStyle:{"margin-left":"5px"}},[s("pre",[e._v(e._s(a+1)+". "+e._s(t.exercise.exerciseContent)+"（"+e._s(t.exercise.exercisePoint)+"分）")])]),e._v(" "),1===t.exercise.exerciseType?s("el-form-item",{staticStyle:{"margin-top":"10px","margin-left":"10px","padding-bottom":"10px"}},[s("el-radio-group",e._l(t.exerciseChoiceList.length,function(a){return s("el-radio",{key:a,attrs:{value:a-1,label:a-1}},[e._v(e._s(String.fromCharCode(a+64))+". "+e._s(t.exerciseChoiceList[a-1].choice))])}),1)],1):2===t.exercise.exerciseType?s("el-form-item",{staticStyle:{"margin-left":"10px"}},[s("el-checkbox-group",e._l(t.exerciseChoiceList.length,function(a){return s("el-checkbox",{key:a,attrs:{value:a-1,label:a-1}},[e._v(e._s(String.fromCharCode(a+64))+"."+e._s(t.exerciseChoiceList[a-1].choice))])}),1)],1):3===t.exercise.exerciseType?s("el-form-item",{staticStyle:{"margin-left":"10px"}},[s("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入答案"}})],1):e._e()],1)}),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary",size:"mini",disabled:""},on:{click:function(t){return e.submitForm("answer")}}},[e._v("确认提交")])],1)],2)],1):s("div",[s("h3",[e._v("老师尚未发布习题")])])])},staticRenderFns:[]};var ht=s("VU/8")(lt,ct,!1,function(e){s("9Qjz")},"data-v-345ee4fe",null).exports,ut={data:function(){return{time:null,haveRev:!1,tid:0,half:!0,type:0,rate:0,totalPoint:0,totalScore:0,exercises:[]}},create:function(){},mounted:function(){this.getRev(),this.setTime()},watch:{$route:function(e,t){this.getPre(),this.setTime()}},methods:{setTotalPoint:function(){for(var e=0;e<this.exercises.length;e++)this.totalPoint+=this.exercises[e].exercise.exercisePoint;console.log(this.totalPoint,"totalPoint")},setTime:function(){var e=this.$route.query.index,t=store.state.catalog;0!=t.length&&null!=t[e].exerciseDeadline_2&&(this.time=t[e].exerciseDeadline_2)},getRev:function(){var e=this,t=this.$route.query.trevid;this.tid=t,this.$axios.get("http://10.60.38.173:8765/question/view",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{chapterId:t,type:"preview"}}).then(function(t){console.log("rev",t.data),e.exercises=t.data.data,0!=e.exercises.length&&(e.haveRev=!0),e.setTotalPoint()}).catch(function(e){console.log(e)})}}},dt={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.haveRev?s("div",{staticStyle:{margin:"0 auto",width:"700px"}},[s("h3",{attrs:{align:"start"}},[e._v("\r\n      作业题（\r\n      "),s("span",[e._v(e._s(e.totalPoint))]),e._v("分）\r\n    ")]),e._v(" "),null!=e.time?s("h4",{staticStyle:{color:"rgb(150,150,150)"},attrs:{align:"start"}},[e._v("截止时间："+e._s(e.time))]):e._e(),e._v(" "),s("el-form",[e._l(e.exercises,function(t,a){return s("div",{key:a,staticStyle:{"margin-top":"15px","font-size":"14px"},attrs:{align:"start"}},[s("p",{staticStyle:{"margin-left":"5px"}},[s("pre",[e._v(e._s(a+1)+". "+e._s(t.exercise.exerciseContent)+"（"+e._s(t.exercise.exercisePoint)+"分）")]),e._v(" "),2===t.exercise.exerciseType?s("span",[e._v("（多选）")]):e._e()]),e._v(" "),1===t.exercise.exerciseType?s("el-form-item",{staticStyle:{"margin-top":"10px","margin-left":"10px","padding-bottom":"10px"}},[s("el-radio-group",e._l(t.exerciseChoiceList.length,function(a){return s("el-radio",{key:a,attrs:{value:a-1,label:a-1}},[e._v(e._s(String.fromCharCode(a+64))+". "+e._s(t.exerciseChoiceList[a-1].choice))])}),1)],1):2===t.exercise.exerciseType?s("el-form-item",{staticStyle:{"margin-left":"10px"}},[s("el-checkbox-group",e._l(t.exerciseChoiceList.length,function(a){return s("el-checkbox",{key:a,attrs:{value:a-1,label:a-1}},[e._v(e._s(String.fromCharCode(a+64))+"."+e._s(t.exerciseChoiceList[a-1].choice))])}),1)],1):3===t.exercise.exerciseType?s("el-form-item",{staticStyle:{"margin-left":"10px"}},[s("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入答案"}})],1):e._e()],1)}),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary",size:"mini",disabled:""},on:{click:function(t){return e.submitForm("answer")}}},[e._v("保 存")])],1)],2),e._v(" "),s("div",{staticStyle:{"background-color":"#545c64",height:"110px"}},[e._m(0),e._v(" "),s("el-rate",{staticStyle:{"margin-top":"-5px","padding-bottom":"10px"},attrs:{colors:["#99A9BF","#F7BA2A","#FF9900"],"allow-half":e.half},model:{value:e.rate,callback:function(t){e.rate=t},expression:"rate"}}),e._v(" "),s("el-button",{attrs:{size:"mini",type:"primary",round:"",disabled:""},on:{click:e.submit}},[e._v("提 交")])],1)],1):s("div",[s("h3",[e._v("老师尚未发布习题")])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("p",{staticStyle:{"padding-top":"10px",color:"#fff"}},[this._v("评分"),t("span",{staticStyle:{"font-size":"12px"}},[this._v("（评分后方可提交作业）")])])}]};var pt=s("VU/8")(ut,dt,!1,function(e){s("LYJy")},"data-v-ad981c62",null).exports,mt={data:function(){return{exercises:[],score:[],sid:null,totalPoint:0,totalScore:0}},created:function(){this.getPre()},watch:{$route:function(e,t){this.getPre()}},methods:{setAnswerClass:function(e,t){return e.indexOf(t)>=0?"answer":""},getPre:function(){var e=this,t=this.$route.query.spreid;this.sid=t,this.$axios.get("http://10.60.38.173:8765/question/view",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{chapterId:this.sid,studentId:localStorage.getItem("userid"),type:"preview"}}).then(function(t){console.log("pre",t.data),1==t.data.state&&(e.exercises=t.data.data,e.setScore(),e.setTotalPoint())}).catch(function(e){console.log(e)})},setTotalPoint:function(){for(var e=0,t=0;t<this.exercises.length;t++)e+=this.exercises[t].exercise.exercisePoint;this.totalPoint=e},setScore:function(){for(var e=0,t=0;t<this.exercises.length;t++)this.exercises[t].answer==this.exercises[t].exercise.exerciseAnswer?(this.score[t]=this.exercises[t].exercise.exercisePoint,e+=this.score[t]):this.score[t]=0;this.totalScore=e}}},gt={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticStyle:{margin:"0 auto",width:"778px"}},[s("h3",{attrs:{align:"start"}},[e._v("\n      客观题（\n      "),s("span",[e._v(e._s(e.totalPoint))]),e._v("分）\n      "),s("span",[e._v("得分："+e._s(e.totalScore)+" 分")])]),e._v(" "),e._l(e.exercises,function(t,a){return s("div",{key:a,staticStyle:{"margin-top":"15px","font-size":"14px","padding-bottom":"10px"},attrs:{align:"start"}},[s("p",{staticStyle:{"margin-left":"5px"}},[s("pre",[e._v(e._s(a+1)+". "+e._s(t.exercise.exerciseContent)+"（"+e._s(t.exercise.exercisePoint)+"分）")]),e._v(" "),1===t.exercise.exerciseType||2===t.exercise.exerciseType?s("span",[s("span",{staticStyle:{"font-size":"12px",color:"rgb(100,100,100)"}},[e._v("\n          你的选择：\n          "),s("span",{staticStyle:{color:"red"}},[e._v("\n              "+e._s(t.answer)+"  \n          ")])]),e._v(" "),s("span",{staticStyle:{"font-size":"12px",color:"rgb(100,100,100)"}},[e._v("\n          得分：\n          "),s("span",{staticStyle:{color:"red"}},[e._v(e._s(e.score[a]))]),e._v(" 分\n        ")])]):e._e()]),e._v(" "),e._l(t.exerciseChoiceList.length,function(a){return s("span",{key:a,staticStyle:{"margin-left":"10px"},attrs:{value:a-1,label:a-1}},[s("span",{class:e.setAnswerClass(t.exercise.exerciseAnswer,String.fromCharCode(a+64))},[e._v("\n          "+e._s(String.fromCharCode(a+64))+".\n          "+e._s(t.exerciseChoiceList[a-1].choice)+"\n        ")])])}),e._v(" "),s("div",{staticStyle:{"margin-top":"10px","background-color":"rgb(240,240,240)","min-height":"80px",padding:"10px 10px 10px 10px"}},[e._v("\n      解析："),s("pre",[e._v(e._s(t.exercise.exerciseAnalysis))])])],2)})],2)},staticRenderFns:[]};var ft=s("VU/8")(mt,gt,!1,function(e){s("Vxw8")},"data-v-e65b55a2",null).exports,vt={data:function(){return{rate:0,comment:"",sid:0,exercises:[],score:[],totalPoint:0,totalScore:0,isScored:!1,time:null}},mounted:function(){this.setTime(),this.getRev()},watch:{$route:function(e,t){this.setTime(),this.getRev()}},methods:{getScore:function(){var e=this;this.$axios.get("http://10.60.38.173:8765/question/exerciseScore",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{studentId:localStorage.getItem("userid"),chapterId:this.sid,type:"review"}}).then(function(t){if(console.log("/question/exerciseScore",t.data),1==t.data.state){e.score=t.data.data;for(var s=0,a=0;a<e.score.length;a++)s+=e.score[a];e.totalScore=s,e.score.length==e.exercises.length&&(e.isScored=!0)}}).catch(function(e){console.log(e)})},setTime:function(){var e=this.$route.query.index,t=S.state.catalog;0!=t.length&&null!=t[e].exerciseDeadline_2&&(this.time=t[e].exerciseDeadline_2)},setAnswerClass:function(e,t){return e.indexOf(t)>=0?"answer":""},getRev:function(){var e=this,t=this.$route.query.srevid;this.sid=t;var s=this.$route.query.index;this.rate=S.state.score[s].studentChapter.rate,this.comment=S.state.score[s].studentChapter.comment,this.$axios.get("http://10.60.38.173:8765/question/view",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{chapterId:this.sid,studentId:localStorage.getItem("userid"),type:"review"}}).then(function(t){console.log("rev",t.data),1==t.data.state&&(e.exercises=t.data.data,e.getScore(),e.setTotalPoint())}).catch(function(e){console.log(e)})},setTotalPoint:function(){for(var e=0,t=0;t<this.exercises.length;t++)e+=this.exercises[t].exercise.exercisePoint;this.totalPoint=e}}},xt={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("h3",{attrs:{align:"start"}},[e._v("\n    作业题（\n    "),s("span",[e._v(e._s(e.totalPoint))]),e._v("分）\n    "),0==e.isScored?s("span",{staticStyle:{"font-size":"14px"}},[e._v("\n      客观题得分:\n      "),s("span",{staticStyle:{color:"red"}},[e._v(e._s(e.totalScore))]),e._v(" 分\n    ")]):s("span",{staticStyle:{"font-size":"14px"}},[e._v("\n      总得分:\n      "),s("span",{staticStyle:{color:"red"}},[e._v(e._s(e.totalScore))]),e._v(" 分\n    ")])]),e._v(" "),null!=e.time?s("h4",{staticStyle:{color:"rgb(150,150,150)"},attrs:{align:"start"}},[e._v("截止时间："+e._s(e.time))]):e._e(),e._v(" "),s("div",e._l(e.exercises,function(t,a){return s("div",{key:a,staticStyle:{"margin-top":"15px","font-size":"14px","padding-bottom":"10px"},attrs:{align:"start"}},[s("p",{staticStyle:{"margin-left":"5px"}},[s("pre",[e._v(e._s(a+1)+". "+e._s(t.exercise.exerciseContent)+"（"+e._s(t.exercise.exercisePoint)+"分）")]),e._v(" "),4===t.exercise.exerciseType||5===t.exercise.exerciseType?s("span",[s("span",{staticStyle:{"font-size":"12px",color:"rgb(100,100,100)"}},[e._v("\n            你的选择:\n            "),s("span",{staticStyle:{color:"red"}},[e._v(e._s(t.answer)+"  ")])]),e._v(" "),s("span",{staticStyle:{"font-size":"12px",color:"rgb(100,100,100)"}},[e._v("\n            得分:\n            "),s("span",{staticStyle:{color:"red"}},[e._v(e._s(e.score[a]))]),e._v(" 分\n          ")])]):6===t.exercise.exerciseType&&1==e.isScored?s("span",[s("span",{staticStyle:{"font-size":"12px",color:"rgb(100,100,100)"}},[e._v("\n            得分:\n            "),s("span",{staticStyle:{color:"red"}},[e._v(e._s(e.score[a]))]),e._v(" 分\n          ")])]):e._e()]),e._v(" "),4===t.exercise.exerciseType||5===t.exercise.exerciseType?s("span",e._l(t.exerciseChoiceList.length,function(a){return s("span",{key:a,staticStyle:{"margin-left":"10px"},attrs:{value:a-1,label:a-1}},[s("span",{class:e.setAnswerClass(t.exercise.exerciseAnswer,String.fromCharCode(a+64))},[e._v(e._s(String.fromCharCode(a+64))+". "+e._s(t.exerciseChoiceList[a-1].choice))])])}),0):6===t.exercise.exerciseType?s("div",{staticStyle:{padding:"10px","background-color":"#ddd",height:"50px"}},[e._v("你的答案："+e._s(t.answer))]):e._e(),e._v(" "),s("div",{staticStyle:{"margin-top":"10px","background-color":"rgb(240,240,240)","min-height":"80px",padding:"10px 10px 10px 10px"}},[e._v("解析："),s("pre",[e._v(e._s(t.exercise.exerciseAnalysis))])])])}),0),e._v(" "),s("div",{staticStyle:{"background-color":"#545c64",height:"120px"}},[s("p",{staticStyle:{"padding-top":"10px",color:"#fff"}},[e._v("评分")]),e._v(" "),s("el-rate",{attrs:{disabled:"","show-score":"","text-color":"#ff9900","score-template":"{value}"},model:{value:e.rate,callback:function(t){e.rate=t},expression:"rate"}}),e._v(" "),s("p",{staticStyle:{color:"#fff"}},[e._v(e._s(e.comment))])],1)])},staticRenderFns:[]};var bt=s("VU/8")(vt,xt,!1,function(e){s("4QX0")},"data-v-e735162a",null).exports;a.default.use(o.a),a.default.prototype.$axios=d.a;var yt=new o.a({routes:[{path:"/",redirect:"/home"},{path:"/",component:g,name:"教与学",iconCls:"el-icon-message",children:[{path:"/home",name:"Home",component:h}]},{path:"/student",component:g,redirect:"/student/courseManagement",children:[{path:"courseManagement",name:"sCourseManagement",component:x,meta:{keepAlive:!0}},{path:"studentAnalysis",name:"sStudentAnalysis",component:q},{path:"chapterDetail",name:"sChapterDetail",component:T,children:[{path:"point",name:"point",component:Ke},{path:"preExercise",name:"preExercise",component:tt},{path:"revExercise",name:"revExercise",component:rt},{path:"scoredPre",name:"scoredPre",component:ft},{path:"scoredRev",name:"scoredRev",component:bt}],meta:{keepAlive:!0}}]},{path:"/student/feedback",name:"feedback",component:ze},{path:"/student/courseDetail",name:"sCourseDetail",component:$},{path:"/teacher/courseDetail",name:"tCourseDetail",component:X},{path:"/teacher",component:g,redirect:"/teacher/courseManagement",children:[{path:"courseManagement",name:"tCourseManagement",component:Y,meta:{keepAlive:!0}},{path:"chapterEdit",name:"tChapterCatalog",component:ee,children:[{path:"pointEdit",name:"pointEdit",component:ie},{path:"preEdit",name:"preExerciseEdit",component:le},{path:"revEdit",name:"revExerciseEdit",component:ue}]},{path:"chapterDetail",name:"tChapterDetail",component:j,meta:{keepAlive:!0},children:[{path:"point",name:"tpoint",component:nt},{path:"preExercise",name:"tpreExercise",component:ht},{path:"revExercise",name:"trevExercise",component:pt}]},{path:"mark",name:"exerciseMark",component:Ie},{path:"studentList",name:"tStudentList",component:me},{path:"studentAnalysis",name:"tStudentAnalysis",component:be},{path:"courseAnalysis",name:"tCourseAnalysis",component:Oe}]},{path:"/adminManage",component:Ze,redirect:"/adminManage/courseList",name:"adminManage",meta:{keepAlive:!0},children:[{path:"courseList",name:"courseList",component:Le},{path:"teacherList",name:"teacherList",component:Ee},{path:"courseAnalysis",name:"aCourseAnalysis",component:Ge},{path:"courseGraph",name:"aCourseGraph",component:Ye}]}]}),wt=s("zL8q"),It=s.n(wt),_t=s("8+8L");s("tvR6"),s("e0XP");a.default.use(It.a),a.default.use(_t.a),a.default.prototype.$axios=d.a,a.default.prototype.$echarts=Ce.a,a.default.config.productionTip=!1,a.default.http.options.emulateJSON=!0,new a.default({el:"#app",router:yt,components:{App:i},template:"<App/>"}),Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var s in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+s+")").test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?t[s]:("00"+t[s]).substr((""+t[s]).length)));return e}},O0U6:function(e,t){},Pi71:function(e,t){},SAtU:function(e,t){},UfQ2:function(e,t){},Vxw8:function(e,t){},WMCM:function(e,t){},XU3J:function(e,t){},"Y+q6":function(e,t){},atjF:function(e,t){},d4A7:function(e,t){},e0XP:function(e,t){},e76U:function(e,t){},el14:function(e,t){},hvyg:function(e,t){},j796:function(e,t){},"jV+u":function(e,t){},kByn:function(e,t){},ndgP:function(e,t){},nfQf:function(e,t){},nyz3:function(e,t){},qlxr:function(e,t){},sMsM:function(e,t){},tvR6:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.c375a15ae51aff7eef18.js.map